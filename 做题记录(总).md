# åšé¢˜è®°å½•

## æ¨¡æ¿è®°å½•

```md
### Tx é¢˜ç›®åç§°

#### é¢˜ç›®æè¿°

#### é¢˜ç›®åˆ†æ

#### å‚è€ƒä»£ç 
```

## Content

- [COCI2020-2021 #1](#COCI2020-2021 #1)
	- [T1 Patkice](#T1 Patkice)
	- [T2 Bajka](#T2 Bajka)
	- [T3 Histogram](#T3 Histogram)
	- [T4 Papricice](#T4 Papricice)
	- [T5 Tenis](#T5 Tenis)
- [COCI2020-2021 #2](#COCI2020-2021 #2)
	- [T1 Crtanje](#T1 Crtanje)
	- [T2 Odasiljaci](#T2 Odasiljaci)
	- [T3 Euklid](#T3 Euklid)
	- [T4 Sjekira](#T4 Sjekira)
	- [T5 Svjetlo](#T5 Svjetlo)
- [COCI2020-2021 #3](#COCI2020-2021 #3)
	- [T1 Knjige](#T1 Knjige)
	- [T2 Vlak](#T2 Vlak)
	- [T3 Sateliti](#T3 Sateliti)
	- [T4 Selotejp](#T4 Selotejp)
	- [T5 Specijacija](#T5 Specijacija)
- [COCI2020-2021 #4](#COCI2020-2021 #4)
	- [T1 Pizza](#T1 Pizza)
	- [T2 Vepar](#T2 Vepar)
	- [T3 Hop](#T3 Hop)
	- [T4 Janjetina](#T4 Janjetina)
	- [T5 Patkice II](#T5 Patkice II)
- [COCI2020-2021 #5](#COCI2020-2021 #5)
	- [T1 Sifra](#T1 Sifra)
	- [T2 Po](#T2 Po)
	- [T3 Megenta](#T3 Megenta)
	- [T4 Planine](#T4 Planine)
	- [T5 Sjeckanje](#T5 Sjeckanje)
- [20220207 é‡åº†è‚²æ‰2022å¯’å‡é›†è®­ é€‰æ‹”æµ‹è¯•è¯•é¢˜](#20220207)
	- [T1 ç¤¾äº¤è·ç¦»(socdist)](#T1 ç¤¾äº¤è·ç¦»)
	- [T2 è·¯å¾„(path)](#T2 è·¯å¾„)
	- [T3 å€¾æ–œçš„çº¿(slope)](#T3 å€¾æ–œçš„çº¿)
	- [T4 ç¬¦æ–‡(runes)](#T4 ç¬¦æ–‡)
	- [T5 è´­ç¥¨(tickets)](#T5 è´­ç¥¨)
- [20220210 é‡åº†å¸‚è‚²æ‰ä¸­å­¦2022å¹´ å¯’å‡è”åˆæ¨¡æ‹Ÿ Round 3](#20220210)
	- [T1 å•†è´¸(trade)](#T1 å•†è´¸)
	- [T2 éƒ¨é˜Ÿé›†ç»“(gather)](#T2 éƒ¨é˜Ÿé›†ç»“)
	- [T3 è™«ç¾¤æ‰©å¼ (proliferate)](#T3 è™«ç¾¤æ‰©å¼ )
	- [T4 æ¨æ¼”(calc)](#T4 æ¨æ¼”)
- [20220212 é‡åº†å¸‚è‚²æ‰ä¸­å­¦2022å¹´ å¯’å‡è”åˆæ¨¡æ‹Ÿ Round 4](#20220212)
	- [T1 é­”æ³•é˜µ(magic)](#T1 é­”æ³•é˜µ)
	- [T2 åŒºåŸŸä¾¦æµ‹(detect)](#T2 åŒºåŸŸä¾¦æµ‹)
	- [T3 åŠ å›º(reinforce)](#T3 åŠ å›º)
	- [T4 æ–©é¦–è¡ŒåŠ¨(assassinate)](#T4 æ–©é¦–è¡ŒåŠ¨)
- [20220219 é‡åº†å¸‚è‚²æ‰ä¸­å­¦2022å¹´ è”åˆæ¨¡æ‹Ÿ](#20220219)
	- [T1 photo](#T1 photo)
	- [T2 swap](#T2 swap)
	- [T3 tree](#T3 tree)
	- [T4 rabbit](#T4 rabbit)
	- [T5 ball](#T5 ball)
- [20220226 é‡åº†å¸‚è‚²æ‰ä¸­å­¦2022å¹´ è”åˆæ¨¡æ‹Ÿ](#20220226)
	- [T1 è¾“å‡ºç»ƒä¹ (output)](#T1 è¾“å‡ºç»ƒä¹ )
	- [T2 æœ€è¿‘è·ç¦»(dis)](#T2 æœ€è¿‘è·ç¦»)
	- [T3 å­—å…¸åºé¢˜(sort)](#T3 å­—å…¸åºé¢˜)
	- [T4 åŒºé—´æ±‚å’Œ(sum)](#T4 åŒºé—´æ±‚å’Œ)
	- [T5 æ™ºæ…§åšå¼ˆ(game)](#T5 æ™ºæ…§åšå¼ˆ)
- [20220227 é‡åº†å¸‚è‚²æ‰ä¸­å­¦2022å¹´ å¯’å‡è”åˆæ¨¡æ‹Ÿ Round 5](#20220227)
	- [T1 çƒ½ç«çŸ³(tower)](#T1 çƒ½ç«çŸ³)
	- [T2 åšå¼ˆ(game)](#T2 åšå¼ˆ)
	- [T3 æŸ“è‰²(draw)](#T3 æŸ“è‰²)
	- [T4 æ’åˆ—è®¡æ•°(permutation)](#T4 æ’åˆ—è®¡æ•°)
	
## COCI2020-2021 #1

### T1 Patkice

#### é¢˜ç›®æè¿°

ä¸æ˜¯å¾ˆä¹…ä¹‹å‰ï¼Œåœ¨ä¸€ä¸ªé¥è¿œçš„å¤§é™†ä¸Šï¼Œä½ç€ä¸‰åªæ©¡çš®é¸­ã€‚åœ¨ä¸€ä¸ªç‚çƒ­çš„å¤æ—¥ï¼Œèººåœ¨æ²™æ»©ä¸Šçš„é¸­å­ä»¬å†³å®šæ—…è¡Œåˆ°ä¸€åº§ç›¸é‚»çš„å°å²›(ç”¨ä¸€æŠŠè€æ—§çš„é»‘è‰²é›¨ä¼)ã€‚

é¸­å­ä»¬æ˜¯ç»éªŒä¸°å¯Œçš„æµ·æ´‹æ¢é™©å®¶ï¼Œåœ¨æ—…è¡Œä¹‹å‰ï¼Œä»–ä»¬ä¼šæ£€æŸ¥å½“å‰æµ·æ´‹çš„æµ·å›¾ã€‚åœ¨æµ·å›¾ä¸Šï¼Œé¸­å­ä»¬ç›®å‰å±…ä½çš„å²›å±¿è¢«å­—ç¬¦ `o` æ ‡è®°ï¼Œé¸­å­ä»¬å¯ä»¥æœä¸œ(E)å—(S)è¥¿(W)åŒ—(N)ä¸­çš„ä»»æ„æ–¹å‘å¼€å§‹ä»–ä»¬çš„æ—…é€”ã€‚

æµ·æ´‹ä¸­çš„æ´‹æµä¼šåƒå››ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œåœ¨æµ·å›¾ä¸Šï¼Œå‘ä¸œçš„æ´‹æµè¢«æ ‡è®°ä¸º `>`ï¼Œå‘è¥¿çš„æ´‹æµè¢«æ ‡è®°ä¸º `<`ï¼Œå‘åŒ—çš„æ´‹æµè¢«æ ‡è®°ä¸º `^`ï¼Œå‘å—çš„æ´‹æµè¢«æ ‡è®°ä¸º `v`ã€‚å½“é¸­å­ä»¬ä½äºæ´‹æµä¸­çš„æŸä¸€ä¸ªä½ç½®æ—¶ï¼Œä»–ä»¬ä¼šç§»åŠ¨åˆ°æ´‹æµæ‰€æŒ‡å‘çš„ä¸‹ä¸€ä¸ªä½ç½®ã€‚è¿™ç‰‡æµ·æ´‹ä¸­çš„æ´‹æµæ¯”è¾ƒç‰¹æ®Šï¼Œå®ƒä¸ä¼šè®©é¸­å­ä»¬ç§»åŠ¨åˆ°æµ·å›¾ä¹‹å¤–çš„åœ°æ–¹ï¼ŒåŒæ—¶ï¼Œæ´‹æµä¹Ÿæ²¡æœ‰å½¢æˆç¯è·¯ã€‚

å¹³é™çš„æµ·æ´‹åœ¨æµ·å›¾ä¸­è¢«æ ‡è®°ä¸º `.`ã€‚å¦‚æœæ´‹æµå¸¦é¸­å­ä»¬åˆ°è¾¾äº†å¹³é™æµ·åŸŸï¼Œæˆ–è€…æ—¶å¼€å§‹çš„å²›å±¿ï¼Œé‚£ä¹ˆä»–ä»¬å°±æ— æ³•ç»§ç»­ä»–ä»¬çš„æ—…é€”äº†ã€‚ä»–ä»¬æƒ³è¦åˆ°è¾¾çš„å²›åœ¨å›¾ä¸Šè¢«æ ‡è®°ä¸º `x`ã€‚

ä½ çš„ä»»åŠ¡æ˜¯å¸®é¸­å­ä»¬åˆ¤æ–­å®ƒä»¬èƒ½å¦åˆ°è¾¾ç›®çš„åœ°ã€‚å¦‚æœå¯ä»¥çš„è¯ï¼Œä»–ä»¬éœ€è¦é€‰æ‹©å“ªä¸€ä¸ªæ–¹å‘ã€‚

é‰´äºé¸­å­ä»¬å¹¶ä¸å–œæ¬¢æµ·ä¸Šæ¼‚æ³Šçš„æ„Ÿè§‰ï¼Œå¦‚æœå­˜åœ¨å¤šä¸ªå¯ä»¥åˆ°è¾¾ç›®çš„åœ°çš„æ–¹å‘ï¼Œä½ éœ€è¦æ‰¾åˆ°è¡ŒåŠ¨è·ç¦»æœ€çŸ­çš„æ–¹å‘ã€‚å¦‚æœå­˜åœ¨è¡ŒåŠ¨è·ç¦»ç›¸åŒçš„æ–¹å‘ï¼Œè¯·æŒ‰ç…§æ–¹å‘çš„å­—å…¸åºè¾“å‡ºå­—å…¸åºæœ€å°çš„æ–¹å‘ã€‚

#### è¾“å…¥æè¿°

ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ•´æ•° $r$ å’Œ $s(3\leq r,s\leq 100)$ï¼Œè¡¨ç¤ºæµ·å›¾çš„è¡Œæ•°å’Œåˆ—æ•°ã€‚

æ¥ä¸‹æ¥çš„ $r$ è¡Œï¼Œæ¯ä¸€è¡ŒåŒ…å« $s$ ä¸ªå­—ç¬¦ï¼Œå­—ç¬¦é›†ä¸º `o<>v^.x`ï¼Œä»£è¡¨æµ·æ´‹çš„æƒ…å†µã€‚å›¾ä¸­ä¿è¯åªå­˜åœ¨å”¯ä¸€çš„ `o` å’Œ `x`ã€‚ä¿è¯å­—ç¬¦ `o` ä¸ä¼šå‡ºç°åœ¨ç¬¬ä¸€è¡Œï¼Œç¬¬ä¸€åˆ—ï¼Œæœ€åä¸€è¡Œï¼Œæœ€åä¸€åˆ—ã€‚

#### è¾“å‡ºæè¿°

å¦‚æœé¸­å­ä»¬æ— æ³•åˆ°è¾¾ç›®çš„å°å²›ï¼Œè¾“å‡º `:(`ã€‚

å¦åˆ™ï¼Œè¯·åœ¨ç¬¬ä¸€è¡Œè¾“å‡º `:)`ã€‚åœ¨ç¬¬äºŒè¡Œï¼Œè¾“å‡ºå®ƒä»¬å‡ºå‘çš„æ–¹å‘(Nè¡¨ç¤ºå‘åŒ—ï¼ŒEè¡¨ç¤ºå‘ä¸œï¼ŒWè¡¨ç¤ºå‘è¥¿ï¼ŒSè¡¨ç¤ºå‘å—)ã€‚

#### é¢˜ç›®åˆ†æ

åŠ å¼ºç‰ˆ:[Patkice II](#T5 Patkice II)ã€‚

æ°´é¢˜ä¸€é“ï¼Œåªä¸è¿‡ç»†èŠ‚æœ‰ä¸€ç‚¹å°å¤šã€‚é¦–å…ˆï¼Œç°å°†å°é¸­å­ä»¬ç§»åŠ¨åˆ°ä¸Šä¸‹å·¦å³å››ä¸ªæ ¼å­ï¼Œç„¶åå†æš´åŠ›æ¨¡æ‹Ÿä¸‹é¸­å­æœ€ç»ˆä¼šç§»åŠ¨åˆ°å“ªä¸ªç‚¹ï¼Œå¹¶åˆ¤æ–­å…¶æ˜¯å¦ä¸ºç»ˆç‚¹ã€‚æ³¨æ„ï¼šä¸‰åªå°é¸­å¯èƒ½ä¼šèµ°å›èµ·ç‚¹ï¼Œå¦‚æœå¿½ç•¥äº†èµ·ç‚¹å¯èƒ½ä¼šæ­»å¾ªç¯ç„¶åè¶…æ—¶ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
#define van long long
#define N 1010
#define ywhin cin
#define ywhout cout
using namespace std;
van n,m;
char cha[N][N];
van len;char ans;
van DFS(van x,van y)
{
	switch(cha[x][y])
	{
		case '.':return -1e18;break;
		case 'o':return -1e18;break;//æ³¨æ„åˆ¤æ–­æ˜¯å¦ä¼šå›åˆ°èµ·ç‚¹
		case 'x':return 0;break;
		case '>':return DFS(x,y+1)+1;break;
		case '<':return DFS(x,y-1)+1;break;
		case 'v':return DFS(x+1,y)+1;break;
		case '^':return DFS(x-1,y)+1;break;
	}
}
int main()
{
//	ifstream ywhin("patkice.in");
//	ofstream ywhout("patkice.out");
	ywhin>>n>>m;ans='z',len=1e18;
	for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) ywhin>>cha[i][j];
	van sx,sy;
	for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) if (cha[i][j]=='o') sx=i,sy=j;
	van res=DFS(sx,sy+1);
	if (res>=0&&res<=len) ans=(len==res)?min(ans,'E'):'E',len=res;
	res=DFS(sx-1,sy);
	if (res>=0&&res<=len) ans=(len==res)?min(ans,'N'):'N',len=res;
	res=DFS(sx+1,sy);
	if (res>=0&&res<=len) ans=(len==res)?min(ans,'S'):'S',len=res;
	res=DFS(sx,sy-1);//æ³¨æ„ç§»åŠ¨æ–¹å‘ä¸è¦å†™é”™äº†
	if (res>=0&&res<=len) ans=(len==res)?min(ans,'W'):'W',len=res;
	if (ans!='z') 
	{
		ywhout<<":)"<<endl;
		ywhout<<ans;
		return 0;
	}
	ywhout<<":(";
	return 0;
}
```

### T2 Bajka

#### é¢˜ç›®æè¿°

å° $ğ¹ğ‘ğ‘ğ‘–ğ‘—ğ‘–ğ‘ğ‘›$ å·²ç»å¯¹å›¾ç”»ä¹¦æ„Ÿåˆ°åŒå€¦äº†ï¼Œäºæ˜¯ä»–å†³å®šå¼€å§‹é˜…è¯»ä»–çš„ç¬¬ä¸€æœ¬ç«¥è¯ä¹¦ã€‚ä¸å¹¸çš„æ˜¯ï¼Œ$ğ¹ğ‘ğ‘ğ‘–ğ‘—ğ‘–ğ‘ğ‘›$ ç»å¸¸ä¼šé‡è§ä¸€äº›è®©ä»–æ„Ÿåˆ°å®³æ€•çš„è¯è¯­ã€‚ä¸ºäº†æˆ˜èƒœææƒ§ï¼Œä»–ä¼šç©ä¸€ä¸ªä»–è‡ªå·±å‘æ˜çš„æ¸¸æˆã€‚

ä»¤æˆ‘ä»¬çš„å°ä¸»äººå…¬æ„Ÿåˆ°ææƒ§çš„è¯è¯­æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º $ğ‘›$ çš„å°å†™å­—æ¯åºåˆ—ã€‚å¼€å§‹è¿™ä¸ªæ¸¸æˆæ—¶ï¼Œ$ğ¹ğ‘ğ‘ğ‘–ğ‘—ğ‘–ğ‘ğ‘›$ ä¼šæŠŠä»–çš„æ‰‹æŒ‡æ”¾åœ¨è¿™ä¸ªå­—ç¬¦åºåˆ—çš„ä¸€ä¸ªä½ç½®ä¸Šï¼ŒéšåæŠŠè¿™ä¸ªä½ç½®ä¸Šçš„å­—ç¬¦å†™åˆ°ä¸€å¼ çº¸ä¸Šã€‚æ¥ä¸‹æ¥ï¼Œä»–ä¼šæ‰§è¡Œä¸‹é¢çš„ä¸¤ä¸ªæ“ä½œä¸­çš„æŸä¸€ä¸ªï¼Œä»–ä¼šè¿›è¡Œä»»æ„æ¬¡è¿™æ ·çš„æ“ä½œæ‰§è¡Œã€‚

1.å°†æ‰‹æŒ‡ç§»åŠ¨åˆ°ç°åœ¨æŒ‡å‘çš„å­—ç¬¦çš„å·¦è¾¹ä¸€ä¸ªå­—ç¬¦æˆ–è€…å³è¾¹ä¸€ä¸ªå­—ç¬¦(å¦‚æœå­˜åœ¨çš„è¯)ã€‚åŒæ—¶ï¼Œ$ğ¹ğ‘ğ‘ğ‘–ğ‘—ğ‘–ğ‘ğ‘›$ ä¹Ÿä¼šæŠŠè¿™ä¸ªæ–°çš„å­—ç¬¦å†™åœ¨åŸæ¥çš„æœ€åä¸€ä¸ªå­—ç¬¦åé¢ã€‚

2.å°†æ‰‹æŒ‡ç§»åŠ¨åˆ°ä»»æ„ä¸€ä¸ªä¸ç°åœ¨æŒ‡å‘å­—ç¬¦ç›¸åŒçš„å­—ç¬¦å¤„ã€‚è¿™ä¸€è¡ŒåŠ¨ä¸ä¼šå¯¼è‡´ä»»ä½•å­—æ¯ä¹¦å†™ã€‚

ç§»åŠ¨æ‰‹æŒ‡ä»ä½ç½® $ğ‘¥$ åˆ°ä½ç½® $ğ‘¦$ éœ€è¦èŠ±è´¹çš„æ—¶é—´ä¸º $|ğ‘¥âˆ’ğ‘¦|$ã€‚

å¦‚æœåœ¨æ¸¸æˆçš„æœ€åï¼Œ$ğ¹ğ‘ğ‘ğ‘–ğ‘—ğ‘–ğ‘ğ‘›$ æœ€å–œæ¬¢çš„è¯è¯­ä¼šå‡ºç°åœ¨çº¸ä¸Šï¼Œé‚£ä¹ˆä»–å°±ä¼šå…‹æœä»–çš„ææƒ§ã€‚ä»–æƒ³è¦å°½å¿«çœ‹å®Œè¿™æœ¬ç«¥è¯ä¹¦ï¼Œå› æ­¤ä»–å¸Œæœ›ä½ å¯ä»¥å‘Šè¯‰ä»–ï¼Œæœ€çŸ­éœ€è¦å¤šå°‘æ—¶é—´ï¼Œä»–æ‰èƒ½å¤Ÿå…‹æœææƒ§ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬æ­£æ•´æ•° $ğ‘›$ å’Œ $ğ‘š(1\leq ğ‘›,ğ‘š\leq 3000)$ï¼ˆåŸé¢˜ $1\leq n,m\leq 300$ï¼Œåœ¨æ­¤å¤„åªèƒ½è·å¾—70Ptsï¼‰ã€‚

è¾“å…¥çš„ç¬¬äºŒè¡ŒåŒ…æ‹¬ $ğ‘›$ ä¸ªå°å†™å­—æ¯ï¼Œè¡¨ç¤º $ğ¹ğ‘ğ‘ğ‘–ğ‘—ğ‘–ğ‘ğ‘›$ å®³æ€•çš„å•è¯ã€‚

è¾“å…¥çš„ç¬¬ä¸‰è¡ŒåŒ…æ‹¬ $ğ‘š$ ä¸ªå°å†™å­—æ¯ï¼Œè¡¨ç¤º $ğ¹ğ‘ğ‘ğ‘–ğ‘—ğ‘–ğ‘ğ‘›$ æœ€å–œæ¬¢çš„å•è¯ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡º $ğ¹ğ‘ğ‘ğ‘–ğ‘—ğ‘–ğ‘ğ‘›$ ç”Ÿæˆæœ€å–œæ¬¢çš„å•è¯éœ€è¦çš„æœ€çŸ­æ—¶é—´ï¼Œå¦‚æœæ— æ³•ç”Ÿæˆè¿™ä¸ªå•è¯ï¼Œé‚£ä¹ˆè¾“å‡º `âˆ’1`ã€‚

#### é¢˜ç›®åˆ†æ

##### 30Pts

ç¡¬æš´åŠ›ã€‚ç›´æ¥æŒ¨ä¸ªå»æœç´¢å°±è¡Œäº†ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(m)$ã€‚

##### 70Pts

è®¾ $dp[i][j]$ ä¸ºå·²ç»æ‰¾åˆ° $i$ ä¸ªå­—ç¬¦ä¸”å½“å‰æ‰€åœ¨çš„ä½ç½®ä¸º $j$ æ‰€éœ€è¦çš„æœ€å°æ­¥æ•°ã€‚

é¢„å¤„ç†æŸä¸€ä¸ªå­—æ¯ç©¶ç«Ÿåœ¨å“ªäº›åœ°æ–¹å‡ºç°è¿‡ï¼Œç„¶åå† DP çš„è¿‡ç¨‹ä¸­å¯ä»¥å¿«é€ŸæŸ¥æ‰¾å‡ºä¸‹ä¸€æ­¥ç©¶ç«Ÿå¯ä»¥åˆ°è¾¾å“ªä¸€äº›ä½ç½®ï¼Œå¹¶ä¸”åŠ ä¸ŠäºŒè€…çš„ä½ç½®ä¹‹å·®å°±å¯ä»¥è½¬ç§»åˆ°ä¸‹ä¸€ä¸ªä½ç½®äº†ã€‚

ç”±äºå­—ç¬¦ä¸²æœ‰å¯èƒ½å…¨éƒ¨éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤å¯èƒ½ä¼šå¯¼è‡´å•ä¸ªçŠ¶æ€è½¬ç§»çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n)$ï¼Œå› æ­¤ï¼Œ

æ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(n^3)$ï¼Œè¿‡ COCI æ•°æ®æ˜¯æ²¡æœ‰é—®é¢˜äº†ã€‚

##### 100Pts

è€ƒè™‘å¦‚ä½•é™ä½æ—¶é—´å¤æ‚åº¦ã€‚

æˆ‘ä»¬å¯ä»¥æ¯æ¬¡è®°å½•åˆ°æŸä¸€ä¸ªçŠ¶æ€æ—¶æ¯ä¸ªç¬¦åˆæ¡ä»¶çš„ç‚¹çš„æœ€å°æ­¥æ•°ï¼Œç„¶åä»å·¦æ‰«ä¸€éï¼Œè®°å½•åˆ°æŸä¸€ä¸ªç‚¹æ—¶çš„æœ€å°æ­¥æ•° $step$ï¼Œå¹¶å°†ç¬¦åˆæ¡ä»¶çš„ä¸‹ä¸€ä¸ªç‚¹çš„æ­¥æ•°èµ‹å€¼ä¸º $step$ï¼Œå†ä»å³å‘å·¦æ‰«ä¸€éï¼Œä¸ä»å·¦å¾€å³æ‰«ä¸€éè·å¾—çš„ç­”æ¡ˆæ¯”è¾ƒï¼Œä¿ç•™å°çš„ï¼Œå†å»å¯»æ‰¾ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 3010
#define ywhin cin
#define ywhout cout
using namespace std;
van f[N];
vector<van> where['z'+1];
char hate[N],like[N];
int main()
{
	memset(f,(1<<8)-1,sizeof f);
	van n,m;
	ywhin>>n>>m;
	for (int i=1;i<=n;i++) ywhin>>hate[i];
	for (int i=1;i<=m;i++) ywhin>>like[i];
	queue<pair<van,van> > q;
	for (int i=1;i<=n;i++) if (hate[i]==like[1]) q.push(make_pair(i,0));
	for (int i=2;i<=m;i++)
	{
		memset(f,(1<<6)-1,sizeof f);
		while (!q.empty())
		{
			pair<van,van> p=q.front();q.pop();
			van place=p.first,step=p.second;
			if (hate[place-1]==like[i]&&place>1) f[place-1]=min(f[place-1],step+1);
			if (hate[place+1]==like[i]&&place<n) f[place+1]=min(f[place+1],step+1);
		}//å°†ä¸Šä¸€è½®çš„ç»“æœå¤åˆ¶åˆ°fæ•°ç»„é‡Œ
		van minans=1e18,pos=0;
		for (int j=1;j<=n;j++) if (hate[j]==like[i])
		{
			van dis=minans+j-pos;
			if (dis>f[j]) minans=f[j],pos=j;
			else if (dis<f[j]) f[j]=dis;
		}//ä»å·¦å¾€å³æ‰«ä¸€é
		minans=1e18,pos=n+1;
		for (int j=n;j>=1;j--) if (hate[j]==like[i])
		{
			van dis=minans+pos-j;
			if (dis>f[j]) minans=f[j],pos=j;
			else if (dis<f[j]) f[j]=dis;
			if (f[j]<1e18) q.push(make_pair(j,f[j]));
		}//ä»å³å¾€å·¦æ‰«ä¸€é
		if (q.empty())
		{
			ywhout<<-1<<endl;
			return 0;
		}//å¦‚æœæ²¡æœ‰ç¬¦åˆæ¡ä»¶çš„ç‚¹å°±å¯ä»¥è¾“å‡º-1äº†
	}
	van ans=1e18;
	while (!q.empty())
	{
		pair<van,van> p=q.front();q.pop();
		ans=min(ans,p.second);
	}
	ywhout<<ans;
	return 0;
}
```

### T3 Histogram

#### é¢˜ç›®æè¿°

æœ‰ä¸€ä¸ªé•¿åº¦ä¸º $N$ çš„3Dç›´æ–¹å›¾ã€‚ç¬¬ $i$ ä¸ªæ£±æŸ±çš„å®½åº¦ä¸º 1 ç±³ï¼Œé«˜åº¦ä¸º $a_i$ï¼Œé•¿åº¦ä¸º $b_i$ã€‚æ¢å¥è¯è¯´ï¼Œå…¶ä¸»è§†å›¾(ä»æ­£é¢çœ‹)æ˜¯ä¸€ä¸ªé•¿æ–¹å½¢åºåˆ—ï¼Œç¬¬ $i$ ä¸ªé•¿æ–¹å½¢é«˜ä¸º $a_i$ï¼Œå®½ä¸º 1ã€‚å…¶ä¿¯è§†å›¾(ä»ä¸Šæ–¹çœ‹)æ˜¯ä¸€ä¸ªé•¿æ–¹å½¢åºåˆ—ï¼Œç¬¬ $i$ ä¸ªé•¿æ–¹å½¢é«˜ä¸º $b_i$ï¼Œå®½ä¸º 1ã€‚

ä½ çš„ä»»åŠ¡æ˜¯æ‰¾å‡ºè¿™ä¸ªç›´æ–¹å›¾å†…å¯ä»¥æ”¾ä¸‹çš„å®¹ç§¯æœ€å¤§çš„æ£±æŸ±ã€‚è¦æ±‚æ£±æŸ±çš„æ£±ä¸ç›´æ–¹å›¾çš„æ£±å¹³è¡Œã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•° $N(1\leq N\leq 2\times10^5)$ã€‚è¡¨ç¤ºè¿™ä¸ªç›´æ–¹å›¾çš„é•¿åº¦ã€‚ 

æ¥ä¸‹æ¥çš„ $n$ è¡Œï¼Œç¬¬ $i$ è¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ­£æ•´æ•° $a_i$ å’Œ $b_i(1\leq a_i,b_i\leq 10^6)$ï¼Œå«ä¹‰è§é¢˜é¢æè¿°ã€‚

#### è¾“å‡ºæè¿°

è¾“å…¥æœ€å¤§å†…æ¥æ£±æŸ±çš„å®¹ç§¯ã€‚

#### é¢˜ç›®åˆ†æ

##### 20Pts

çˆ†è‚ä¸€éå°±å®Œäº‹äº†ã€‚æšä¸¾åŒºé—´çš„ $l$ èŠ‚ç‚¹ä¸åŒºé—´é•¿åº¦ï¼Œç„¶åè®¡ç®—ç­”æ¡ˆå¹¶ä¸”ä¸  $ans$ æ¯”è¾ƒå³å¯ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$ ã€‚

##### 100Pts

è€ƒè™‘ä½¿ç”¨åˆ†æ²»è§£å†³æ­¤é¢˜ã€‚

å°†åŒºé—´ $[l,r]$ åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚ä¸éš¾å‘ç°ï¼Œ$a$ çš„æœ€å°å€¼ä¸ $b$ çš„æœ€å°å€¼çš„åˆ†å¸ƒåªä¼šæœ‰ä¸¤ç§æƒ…å†µã€‚å³ $a$ çš„æœ€å°å€¼åœ¨å·¦è¾¹/å³è¾¹ä¸ $b$ çš„æœ€å°å€¼åœ¨å·¦è¾¹/å³è¾¹ã€‚

åˆ†å¼€è®¨è®ºï¼Œå½“ $a,b$ çš„æœ€å°å€¼åœ¨åŒä¸€è¾¹æ—¶ï¼Œæšä¸¾ $a,b$ çš„æœ€å°å€¼å¹¶åœ¨å¦ä¸€è¾¹æŸ¥æ‰¾èƒ½èµ°åˆ°çš„æœ€è¿œçš„åœ°æ–¹å°±è¡Œäº†ã€‚

å½“ $a,b$ çš„æœ€å°å€¼ä¸åœ¨åŒä¸€è¾¹æ—¶ï¼Œè®¾ $c_i=\min(a_{mid},a_{mid-1},...,a_{mid-i}),d_i=\min(b_{mid+1},b_{mid+2},...,b_{mid+i})$ï¼Œä»¥åŠ $f_j(i)=-i\times d_j+j\times d_j,i\leq j$ã€‚çº¿æ®µæ ‘ç»´æŠ¤ $[l,r]$ è¿™ä¸ªåŒºé—´é‡Œæ‰€æœ‰å‡½æ•°çš„å‡¸åŒ…ï¼Œæœ€åæŸ¥è¯¢è¿™ä¸ªçº¿æ®µæ ‘çš„å€¼å†ä¹˜ä¸Š $c_i$ çš„å€¼å°±è¡Œäº†ã€‚

å¦ä¸€ç§åŒç†ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n\log_2^2n)$ã€‚

#### å‚è€ƒä»£ç 

ä»£ç é“¾æ¥:[[DSè®°å½•\]P7164 [COCI2020-2021#1] 3D Histogram - command_block çš„åšå®¢ - æ´›è°·åšå®¢ (luogu.com.cn)](https://www.luogu.com.cn/blog/command-block/ds-ji-lu-p7164-coci2020-20211-3d-histogram)

```C++
#include<algorithm>
#include<cstdio>
#include<vector>
#define pb push_back
#define ll long long
#define MaxN 200500
using namespace std;
const int INF=1000000000;
struct Line{
  ll k,b;
  ll get(int x)
  {return k*x+b;}
  bool operator < (const Line &B) const
  {return k<B.k;}
};
bool chk(const Line &A,const Line &B,const Line &C){
  ll x1=A.k-B.k,y1=A.b-B.b
    ,x2=C.k-B.k,y2=C.b-B.b;
  return x1*y2-y1*x2>0; 
}
#define Hull vector<Line>
Line st[MaxN];
void max(const Hull &A,const Hull &B,Hull &C)
{
  merge(A.begin(),A.end(),B.begin(),B.end(),st);
  int n=A.size()+B.size();
  C.clear();
  for (int i=0;i<n;i++){
    while(C.size()>=2&&!chk(C[C.size()-2],C.back(),st[i]))C.pop_back();
    C.pb(st[i]);
  }
}
struct Node{Hull s;int p;};
ll get(Hull &s,int &p,int x){
  while(p+1<s.size()&&s[p+1].get(x)>s[p].get(x))p++;
  return s[p].get(x);
}
struct HullDS
{
  Node a[1<<18|500];
  Line sl[MaxN];
  int tl,tr;
  void build(int l,int r,int u)
  {
    a[u].s.clear();a[u].p=0;
    if (l==r){a[u].s.pb(sl[l]);return ;}
    int mid=(l+r)>>1;
    build(l,mid,u<<1);
    build(mid+1,r,u<<1|1);
    max(a[u<<1].s,a[u<<1|1].s,a[u].s);
  }
  int wfl,wfr,wfx;ll ret;
  void _qry(int l,int r,int u)
  {
    if (wfl<=l&&r<=wfr){
      ret=max(ret,get(a[u].s,a[u].p,wfx));
      return ;
    }int mid=(l+r)>>1;
    if (wfl<=mid)_qry(l,mid,u<<1);
    if (mid<wfr)_qry(mid+1,r,u<<1|1);
  }
  ll qry(int l,int r,int x){
    wfl=l;wfr=r;wfx=x;
    ret=0;_qry(tl,tr,1);
    return ret;
  }
}T0,T1,T01;
struct Data{int x0,x1;}s[MaxN];
int h0[MaxN],h1[MaxN];ll ans;
void solve(int l,int r)
{
  if (l==r)return ;
  int mid=(l+r)>>1;
  solve(l,mid);solve(mid+1,r);
  h1[mid]=h0[mid]=INF;
  T0.tl=T1.tl=T01.tl=mid+1;
  T0.tr=T1.tr=T01.tr=r;
  // (c0+c1)*min(t0,h0)*min(t1,h1)
  for (int i=mid+1;i<=r;i++){
    h0[i]=min(s[i].x0,h0[i-1]);
    h1[i]=min(s[i].x1,h1[i-1]);
    T0.sl[i]=(Line){h0[i],1ll*h0[i]*(i-mid)};
    //(c0+c1)*h0*t1 = t1*(c0*h0+c1*h0)
    T1.sl[i]=(Line){h1[i],1ll*h1[i]*(i-mid)};
    //(c0+c1)*t0*h1 = t0*(c0*h1+c1*h1)
    T01.sl[i]=(Line){1ll*h0[i]*h1[i],1ll*h0[i]*h1[i]*(i-mid)};
    //(c0+c1)*h0*h1 = c0*h0*h1+c1*h0*h1
  }
  T0.build(mid+1,r,1);
  T1.build(mid+1,r,1);
  T01.build(mid+1,r,1);
  for (int i=mid,t0=INF,t1=INF,p0=mid,p1=mid;i>=l;i--){
    t0=min(t0,s[i].x0);
    t1=min(t1,s[i].x1);
    while(p0<r&&h0[p0+1]>=t0)p0++;
    while(p1<r&&h1[p1+1]>=t1)p1++;
    ans=max(ans,1ll*(min(p0,p1)-i+1)*t0*t1);
    if (p0<p1)ans=max(ans,t1*T0.qry(p0+1,p1,mid-i+1));
    if (p1<p0)ans=max(ans,t0*T1.qry(p1+1,p0,mid-i+1));
    if (max(p0,p1)<r)ans=max(ans,T01.qry(max(p0,p1)+1,r,mid-i+1));
  }
}
int n;
int main()
{
  scanf("%d",&n);
  for (int i=1;i<=n;i++){
    scanf("%d%d",&s[i].x0,&s[i].x1);
    ans=max(ans,1ll*s[i].x0*s[i].x1);
  }solve(1,n);
  printf("%lld",ans);
  return 0;
}
```

### T4 Papricice

#### é¢˜ç›®æè¿°

åœ¨èŠ±å›­å¿™ç¢Œäº†ä¸€ä¸ªæ—©ä¸Šä¹‹åã€‚M å…ˆç”Ÿå†³å®šç”¨è‡ªå·±ç§çš„å¹²è¾£æ¤’å¥–åŠ±ä¸€ä¸‹è‡ªå·±ã€‚ 

M å…ˆç”Ÿæœ‰ $n$ é¢—è¾£æ¤’ï¼Œè¿™äº›è¾£æ¤’ç”± $n-1$ æ¡çº¿é“¾æ¥è€Œæˆã€‚ä»»æ„ä¸¤é¢—è¾£æ¤’éƒ½å¯ä»¥é€šè¿‡è‹¥å¹²æ¡çº¿è¿æ¥èµ·æ¥ã€‚ç®€å•æ¥è¯´ï¼Œè¿™ $n$ é¢—è¾£æ¤’å’Œè¿™ $n-1$ æ¡çº¿è¿æ¥æˆäº†ä¸€æ£µæ ‘ã€‚ 

M å…ˆç”Ÿä»Šå¤©è¦åƒä¸‰é¡¿é¥­ï¼Œå› æ­¤ä»–éœ€è¦å‰ªæ–­ä¸¤æ¡çº¿ã€‚è·å¾—ä¸‰ä¸²å°çš„è¾£æ¤’ã€‚æ¯ä¸€é¡¿é¥­éœ€è¦ä½¿ç”¨ä¸€ä¸²è¾£æ¤’ã€‚

æ˜¾ç„¶ï¼Œä¸€é¡¿é¥­ä¸èƒ½å¤ªè¾£ï¼Œå› æ­¤ä»–ä¼šé€‰æ‹©ä¸€ç§åˆ†å‰²æ–¹æ³•ï¼Œä½¿å¾—**è¾£æ¤’æœ€å¤šçš„è¾£æ¤’ä¸²å’Œè¾£æ¤’æœ€å°‘çš„è¾£æ¤’ä¸²çš„æ•°é‡å·®è·æœ€å°ã€‚**ä½ çš„ä»»åŠ¡å°±æ˜¯æ±‚å‡ºè¿™ä¸ªæœ€å°çš„å·®è·ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° $n(1\leq n\leq 2\times10^5)$ï¼Œè¡¨ç¤ºè¾£æ¤’çš„æ•°é‡ã€‚è¾£æ¤’ä»1åˆ° $n$ ç¼–å·ã€‚ 

æ¥ä¸‹æ¥çš„ $n-1$ è¡Œï¼Œæ¯è¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ•´æ•° $x$ å’Œ $y(1\leq x,y\leq n)$ã€‚è¡¨ç¤ºç”±ä¸€æ¡è¿æ¥ç¼–å·ä¸º $x$ çš„è¾£æ¤’å’Œç¼–å·ä¸º $y$ çš„è¾£æ¤’çš„çº¿ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºä¸€è¡Œï¼Œä¸€ä¸ªæ•´æ•°ï¼Œå³æœ€å°çš„æœ€å¤§è¾£æ¤’ä¸²å’Œæœ€å°è¾£æ¤’ä¸²çš„æ•°é‡å·®è·ã€‚

#### é¢˜ç›®åˆ†æ

##### 50Pts

æš´åŠ›æšä¸¾è¦åˆ é™¤çš„é‚£ä¸¤ä¸ªç‚¹ï¼Œç„¶åè®¡ç®—è¿™ä¸‰ä¸ªéƒ¨åˆ†çš„ç‚¹çš„æ•°é‡å¹¶æ›´æ–° $ans$ çš„å€¼å°±è¡Œäº†ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$ã€‚

##### 100Pts

å‡è®¾æˆ‘ä»¬å·²ç»åˆ‡æ‰äº†ç‚¹ $x$ ä¸å…¶çˆ¶äº²èŠ‚ç‚¹æ‰€å½¢æˆçš„çš„è¾¹ï¼Œç°åœ¨æˆ‘ä»¬éœ€è¦æŸ¥æ‰¾ä¸‹ä¸€ä¸ªéœ€è¦åˆ é™¤çš„è¾¹ç©¶ç«Ÿæ˜¯å“ªä¸€æ¡ã€‚

åˆ†æˆä¸¤ç§æƒ…å†µè€ƒè™‘ï¼š

1. å½“å¦ä¸€æ¡è¾¹åœ¨å…¶ç¥–å…ˆèŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦åˆ†å‡ºçš„å¦ä¸€ä¸ªéƒ¨åˆ†çš„èŠ‚ç‚¹æ•°é‡æœ€å¥½ä¸º $\frac{n-size[x]}{2}$ã€‚ç”±äºå…¶ç¥–å…ˆèŠ‚ç‚¹ $y$ çš„ $size_y$ åŒ…å«äº† $x$ çš„å­æ ‘ä¸‹æ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ° $x$ çš„ç¥–å…ˆèŠ‚ç‚¹ä¸­å­æ ‘çš„èŠ‚ç‚¹æ•°æœ€é è¿‘ $\frac{n+size[x]}{2}$ çš„ä¸€ä¸ªç‚¹å¹¶è®¡ç®—å½“å‰æƒ…å†µä¸‹çš„æœ€ç»ˆç»“æœå¹¶å°†å…¶ä¸ $ans$ æ¯”è¾ƒå³å¯ã€‚

2. å½“å¦ä¸€æ¡è¾¹åœ¨å·²ç»è¢«è®¿é—®è¿‡çš„å­æ ‘ä¸Šæ—¶ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°å·²ç»è®¿é—®è¿‡çš„èŠ‚ç‚¹ä¸­å­æ ‘çš„èŠ‚ç‚¹æ•°æœ€æ¥è¿‘ $\frac{n-size[x]}{2}$ çš„ä¸€ä¸ªç‚¹å¹¶è®¡ç®—å½“å‰æƒ…å†µä¸‹çš„æœ€ç»ˆç»“æœå¹¶å°†å…¶ä¸ $ans$ æ¯”è¾ƒã€‚

è‡³äºå¦‚ä½•æŸ¥æ‰¾ï¼Œä½¿ç”¨ multiset è‡ªå¸¦çš„ lower_bound å‡½æ•°å³å¯ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n\log_2n )$ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
#define van long long
#define N 200010
#define ywhin cin
#define ywhout cout
using namespace std;
van n;vector<van> g[N];
bool used[N];van siz[N],ans=1e18;
multiset<van> father,son;
void init(van now)
{
//	cout<<now<<endl;
	used[now]=1,siz[now]=1;van v;
	for (int i=0;i<g[now].size();i++) if (!used[v=g[now][i]]) init(v),siz[now]+=siz[v];
}//è®¡ç®—å­æ ‘ä¸­çš„èŠ‚ç‚¹æ•°
void DFS(van now)
{
	used[now]=1;van v;
	multiset<van>::iterator it;van siz2,last,tmpans;
	if (!father.empty())
	{
		it=father.lower_bound((n-siz[now])/2+siz[now]);
		if (it!=father.end())
		{
			siz2=*it-siz[now];
			last=n-siz2-siz[now];
			tmpans=max(siz[now],max(siz2,last))-min(siz[now],min(siz2,last));
			ans=min(ans,tmpans);	
		}
		if (it!=father.begin())
		{
			it--;
			siz2=*it-siz[now];
			last=n-siz2-siz[now];
			tmpans=max(siz[now],max(siz2,last))-min(siz[now],min(siz2,last));
			ans=min(ans,tmpans);	
		}
	}//ç¬¬ä¸€ç§æƒ…å†µ
	if (!son.empty())
	{
		it=son.lower_bound((n-siz[now])/2);
		if (it!=son.end())
		{
			siz2=*it;
			last=n-siz2-siz[now];
			tmpans=max(siz[now],max(siz2,last))-min(siz[now],min(siz2,last));
			ans=min(ans,tmpans);	
		}
		if (it!=son.begin())
		{
			it--;
			siz2=*it;
			last=n-siz2-siz[now];
			tmpans=max(siz[now],max(siz2,last))-min(siz[now],min(siz2,last));
			ans=min(ans,tmpans);	
		}
	}//ç¬¬äºŒç§æƒ…å†µ
	if (now!=1) father.insert(siz[now]);//å°†è‡ªå·±åŠ åˆ°ç¥–å…ˆé›†åˆä¸­
	for (int i=0;i<g[now].size();i++) if (!used[v=g[now][i]]) DFS(v);
	if (now!=1) father.erase(father.find(siz[now]));//å°†è‡ªå·±ç§»é™¤ç¥–å…ˆé›†åˆ
	if (now!=1) son.insert(siz[now]);//å°†è‡ªå·±ç§»å…¥å·²è®¿é—®çš„èŠ‚ç‚¹çš„é›†åˆ
}
int main()
{
	ywhin>>n;
	for (int i=1;i<n;i++)
	{
		van f,s;
		scanf("%lld %lld",&f,&s);
		g[f].push_back(s);
		g[s].push_back(f);
	}//å»ºå›¾
	init(1);
	memset(used,0,sizeof used);
	DFS(1);
	ywhout<<ans<<endl;
	return 0;
}
```

### T5 Tenis

#### é¢˜ç›®æè¿°

ç±³å°”ç§‘å…ˆç”Ÿæ˜¯ä¸€ä¸ªç½‘çƒçš„ç‹‚çƒ­ç²‰ä¸ã€‚ä¸ä¹…ä¹‹åï¼Œä¸€ä¸ªé‡è¦çš„é”¦æ ‡èµ›å°±è¦å¼€å§‹äº†ï¼Œè¿™åœºé”¦æ ‡èµ›ä¸€å…±æœ‰ $n$ ä½å‚èµ›é€‰æ‰‹ã€‚ç±³å°”ç§‘å…ˆç”ŸèŠ±è´¹äº†å¤šå¹´æ—¶é—´ç ”ç©¶å‚èµ›è€…ä»¬å¹¶æ”¶é›†äº†å¤§é‡çš„æ•°æ®ã€‚å®ƒå°†ä»–ä»¬åœ¨ä¸‰ç§ä¸åŒåœºåœ°ä¸Šçš„å®åŠ›è°ƒæŸ¥æ¸…æ¥šã€‚å¹¶æŒ‰ç…§æ¯ä¸€ä¸ªä¸åŒçš„åœºåœ°ç»™è¿åŠ¨å‘˜ä»¬è¿›è¡Œäº†ä¸€ä¸ªæ’åºï¼Œæ’åºä¸ºä¸€çš„è¡¨ç¤ºåœ¨è¿™ä¸€åœºåœ°ä¸Šï¼Œè¿™ä¸€è¿åŠ¨å‘˜æ˜¯æœ€å¼ºçš„ã€‚æ’åºæœ€åçš„æœ€å¼±ã€‚

åœ¨è¿™æ¬¡çš„é”¦æ ‡èµ›ä¸­ï¼Œæ¯ä¸¤ä½é€‰æ‰‹éƒ½ä¼šæ­£å¥½äº¤æ‰‹ä¸€æ¬¡ã€‚å› æ­¤ä¸€å…±ä¼šæœ‰ $\frac{n(n-1)}{2}$ åœºæ¯”èµ›ã€‚ä¸€åœºç½‘çƒèµ›æ˜¯ä¸ä¼šæœ‰å¹³å±€çš„ï¼Œ**åœ¨è¿™ä¸ªåœºåœ°ä¸Šå®åŠ›æ’åºæ›´å¼ºçš„é€‰æ‰‹ä¼šè·å¾—èƒœåˆ©ã€‚**ä¸»åŠæ–¹å¯¹æ­¤å¿ƒçŸ¥è‚šæ˜ï¼Œå› æ­¤ä»–ä»¬å†³å®šå°†æ¯åœºæ¯”èµ›å®‰æ’åœ¨èƒœè€…æ°´å¹³æœ€é«˜çš„åœºåœ°ï¼Œä¹Ÿå°±æ˜¯è¯´æ’åæœ€é å‰çš„åœºåœ°ä¸Šã€‚å¦‚æœå­˜åœ¨ä¸¤ä¸ªåœºåœ°èƒœè€…æ’åç›¸åŒ(ä¾‹å¦‚ï¼šè¿åŠ¨å‘˜ A å’Œ B è¿›è¡Œæ¯”èµ›ï¼ŒA åœ¨åœºåœ° 1 ä¸Šä¼šè·èƒœï¼ŒB åœ¨åœºåœ° 2 ä¸Šä¼šè·èƒœï¼Œä½†æ˜¯äºŒè€…åœ¨å¯¹åº”çš„åœºåœ°ä¸Šæ‹¥æœ‰ç›¸åŒçš„æ’å)ï¼Œä»–ä»¬å°±ä¼šé€‰æ‹©è´¥æ–¹æ’åæœ€å¥½çš„åœºåœ°ï¼Œå¦‚æœè´¥æ–¹æ’åç›¸åŒï¼Œé‚£ä¹ˆä»–ä»¬å°±ä¼šé€‰æ‹©ç¼–å·æœ€å°çš„åœºåœ°ã€‚ 

ä½ çš„ä»»åŠ¡æ˜¯ç®—å‡ºé”¦æ ‡èµ›çš„ç»“æœï¼ŒåŒ…æ‹¬ï¼šä¸åŒåœºåœ°ä¸Šçš„æ¯”èµ›åœºæ•°ï¼Œæ¯ä¸€ä½è¿åŠ¨å‘˜çš„è·èƒœæ¬¡æ•°ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ•´æ•° $n(1\leq n\leq 10^5)$ï¼Œè¡¨ç¤ºè¿åŠ¨å‘˜çš„æ•°é‡ï¼Œè¿åŠ¨å‘˜ä»¬ä» 1 åˆ° $n$ ç¼–å·ã€‚ 

æ¥ä¸‹æ¥çš„ 3 è¡Œè¾“å…¥ï¼Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ—ï¼Œè¿™ä¸ªåºåˆ—æ˜¯ $1$ ~ $n$ çš„ä¸€ä¸ªæ’åˆ—ï¼Œè¡¨ç¤ºåœ¨è¿™ä¸ªåœºåœ°ä¸Šé€‰æ‰‹çš„å®åŠ›æ’åºï¼Œç¬¬ä¸€ä¸ªè¾“å…¥çš„ç¼–å·å°±æ˜¯è¿™ä¸ªåœºåœ°ä¸Šå®åŠ›æœ€å¼ºçš„é€‰æ‰‹ç¼–å·ï¼Œä»¥æ­¤ç±»æ¨ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºçš„ç¬¬ä¸€è¡Œï¼ŒåŒ…æ‹¬ä¸‰ä¸ªæ•´æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºåœ¨åœºåœ° 1,2,3 ä¸Šä¸¾åŠçš„æ¯”èµ›çš„æ•°é‡ã€‚ 

è¾“å‡ºçš„ç¬¬äºŒè¡ŒåŒ…æ‹¬ $n$ ä¸ªæ•´æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºç¼–å·ä» 1 åˆ° $n$ çš„æ¯ä¸€ä½é€‰æ‰‹çš„è·èƒœåœºæ¬¡ã€‚

#### é¢˜ç›®åˆ†æ

æˆ‘ä»¬å°†æ¯”èµ›åˆ†æˆä¸¤ç±»ï¼šç¬¬ä¸€ç§æ˜¯ä¸¥æ ¼çš„èƒœåˆ©ï¼Œå³èµ¢å®¶çš„è·èƒœä½ç½®ä¸¥æ ¼å°äºè¾“å®¶çš„è·èƒœä½ç½®ã€‚ç¬¬äºŒç§æ˜¯éä¸¥æ ¼çš„èƒœåˆ©ï¼Œè¿™æ„å‘³ç€çƒå‘˜åœ¨çƒåœºä¸Šçš„è·èƒœä½ç½®æ˜¯ç›¸ç­‰çš„ã€‚

ç°åœ¨é—®é¢˜è½¬åŒ–ä¸ºåœ¨ä¸€ä¸ª 3 åˆ—çš„ç½‘æ ¼ä¸Šç»Ÿè®¡ã€‚ä»å·¦å¾€å³æ‰«ä¸€éï¼Œå¯¹äºè¿™ä¸€åˆ—çš„æ¯ä¸ªçƒå‘˜æ˜¯ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç»Ÿè®¡ $(i+1,n)$ çš„ç­”æ¡ˆï¼›å¦åˆ™ç›´æ¥è·³è¿‡ã€‚å…·ä½“æˆ‘ä»¬è¦ç»´æŠ¤ $cnt[8][3]$ è¡¨ç¤ºåœ¨çŠ¶æ€ $mask$ çš„ç¬¬ $i$ è¡Œæ’çš„æœ€å°ä¸”çƒåœºç¼–å·æœ€å°çš„çƒå‘˜çš„ä½ç½®ã€‚

ç°åœ¨æˆ‘ä»¬è®¡ç®—éä¸¥æ ¼èƒœåˆ©ã€‚æšä¸¾ $i$ , $j$ è¡Œ $(i<j)$, å¦‚æœ $x$, $y$ éƒ½ä¸ç­‰äº 0 $(x\not=y)$, æˆ‘ä»¬å¯ä»¥æšä¸¾ $k\in [0,2]$ , ä½¿å¾—åœ¨è¾“å®¶ä½ç½®æœ€é å‰çš„æƒ…å†µä¸‹åœºåœ°ç¼–å·æœ€å°ï¼Œå°±å¯ä»¥æ¯”è¾ƒå‡º $x$ , $y$ çš„ç»“æœã€‚

å¸¸æ•°å¤§æ¦‚æœ‰ $2^3\times 3^2=72$ã€‚æ—¶é—´å¤æ‚åº¦ä¸º $O(72\times n)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 100010
#define ywhin cin
#define ywhout cout
using namespace std;
van garbage[3][N],n;
van que[N][3],cnt[8][3];
van ans1[N],ans2[N];
van in[N];
void add(van w,van d)
{
	for(int i=1;i<=7;i++) 
	{
		van min_=-1;
		for (int j=0;j<3;j++) if ((i>>j&1)&&(min_==-1||que[w][j]<que[w][min_])) min_=j;
		cnt[i][min_]+=d;
	}
}//ç»´æŠ¤cnt
int main()
{
	ywhin>>n;
	for (int i=0;i<3;i++) for (int j=1;j<=n;j++) ywhin>>garbage[i][j];
	for (int i=0;i<3;i++) for (int j=1;j<=n;j++) que[garbage[i][j]][i]=j;
	for (int i=1;i<=n;i++) add(i,1);
	for (int i=1;i<=n;i++) 
	{
		for (int j=0;j<3;j++) 
			if (in[garbage[j][i]]) garbage[j][i]=0;
			else
			{
				add(garbage[j][i],-1);
				for (int k=j;k<3;k++) if (garbage[k][i]==garbage[j][i]) in[garbage[j][i]]|=1<<k;
			}
		for (int j=0;j<3;j++) if (garbage[j][i])
		{
			van haha=garbage[j][i];
			for (int k=0;k<3;k++)
			{
				ans1[k]+=cnt[in[haha]][k];
				ans2[haha]+=cnt[in[haha]][k];
			}
			for (int k=j+1;k<3;k++) if (garbage[k][i])
			{
				van ha=garbage[k][i];
				pair<van,van> min_=make_pair(n+1,n+1);
				for (int l=0;l<3;l++) 
				{
					if (que[haha][l]==i) min_=min(min_,make_pair(que[ha][l],(van)l));
					if (que[ha][l]==i) min_=min(min_,make_pair(que[haha][l],(van)l));
				}
				ans1[min_.second]++;
				ans2[que[haha][min_.second]==i?haha:ha]++;
			}
		}
	}
	ywhout<<ans1[0]<<" "<<ans1[1]<<" "<<ans1[2]<<endl;
	for (int i=1;i<=n;i++) ywhout<<ans2[i]<<" ";
	ywhout<<endl;
	return 0;
}
```

## COCI2020-2021 #2

### T1 Crtanje

#### é¢˜ç›®æè¿° 

J å…ˆç”Ÿè¿‡å»åœ¨ Logo å…¬å¸å·¥ä½œï¼Œä»–çƒ­çˆ±ç”»å›¾ï¼Œä¸è¿‡è¿™äº›å¤©ä»–éå¸¸æ²®ä¸§ï¼Œå› ä¸ºä»–è¢«è¾é€€äº†ã€‚ä¸ºäº†è¡¨ç¤ºæ€€å¿µï¼Œä»–å†³å®šç»˜åˆ¶ä¸€æ¡æ›²çº¿æ¥è¡¨ç¤ºä»–æ›¾ç»çš„å…¬å¸åœ¨è¿‡å» $n$ å¤©çš„ä¸šç»©ã€‚

å¯¹äºè¿™ $n$ å¤©ä¸­çš„æ¯ä¸€å¤©ï¼Œå…¬å¸çš„ä¸šç»©è¦ä¹ˆå¢é•¿ä¸€ä¸ªå•ä½(ç”¨ç¬¦å· `+`)æ¥è¡¨ç¤ºï¼Œè¦ä¹ˆå‡å°‘ä¸€ä¸ªå•ä½(ç”¨ç¬¦å· `-` æ¥è¡¨ç¤º)ï¼Œæˆ–è€…ä¿æŒä¸å˜(ç”¨ç¬¦å· `=` æ¥è¡¨ç¤º)ã€‚æˆ‘ä»¬æŠŠç¬¬ä¸€å¤©å…¬å¸çš„ä¸šç»©å®šä¹‰ä¸ºæ ‡å‡† 0ã€‚

J å…ˆç”Ÿä¼šåœ¨ä¸€ä¸ªå·¨å¤§çš„æ— é™å­—ç¬¦çŸ©é˜µä¸­ç»˜åˆ¶è¿™è¿™ä¸€æ¡æ›²çº¿ã€‚çŸ©é˜µçš„è¡Œè¡¨ç¤ºå…¬å¸çš„ä¸šç»©ï¼Œæ ‡å‡† 0 ä¸Šçš„ç¬¬ $i$ è¡Œï¼Œè¡¨ç¤ºå…¬å¸çš„æ”¶ç›Šä¸º $i$ ä¸ªå•ä½ã€‚å¯¹äºç¬¬ $i$ å¤©çš„ä¸šåŠ¡å˜åŒ–ï¼ŒJ å…ˆç”Ÿä¼šåœ¨ç¬¬ $i$ åˆ—ä¸Šç»˜åˆ¶ä¸€äº›å­—ç¬¦ã€‚è¿™ä¸€åˆ—ä¸Šæ¯ä¸€è¡Œçš„å­—ç¬¦éµå¾ªå¦‚ä¸‹åŸåˆ™ï¼š

å¦‚æœç¬¬ $i$ å¤©å…¬å¸çš„ä¸šåŠ¡å¢é•¿äº†ï¼Œé‚£ä¹ˆä»–å°±ä¼šåœ¨ä»£è¡¨å½“å¤©å¼€å§‹çš„æ—¶å€™å…¬å¸ä¸šç»©çš„å¯¹åº”è¡Œ $x$ çš„ç¬¬ $i$ åˆ—è®¾ç½®ä¸ºå­—ç¬¦ `/`ã€‚

å¦‚æœç¬¬ $i$ å¤©å…¬å¸çš„ä¸šåŠ¡ä¸å˜ï¼Œåˆ™ä¼šåœ¨å­—ç¬¦çŸ©é˜µä¸­æŠŠå¯¹åº”çš„ä½ç½®è®¾ç½®ä¸º `_`ã€‚å¦‚æœç¬¬ $i$ å¤©çš„å…¬å¸ä¸šåŠ¡é™ä½äº†ï¼Œåˆ™ä¼šæŠŠå­—ç¬¦çŸ©é˜µçš„å¯¹åº”ä½ç½®è®¾ç½®ä¸º `\`ã€‚çŸ©é˜µä¸­çš„æ‰€æœ‰å…¶ä»–ä½ç½®éƒ½æ˜¯å­—ç¬¦ `.`ã€‚

ä½ çš„ä»»åŠ¡æ˜¯è¾“å‡ºæœ€å°çš„ï¼Œå¯ä»¥åŒ…å«æ•´ä¸ªæ›²çº¿çš„å­çŸ©é˜µã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•° $n(1\leq n\leq 100)$ï¼Œè¡¨ç¤ºè®°å½•çš„å¤©æ•°ã€‚

è¾“å…¥çš„ç¬¬äºŒè¡Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„ç”±å­—ç¬¦ `+` , `-` å’Œ `=` ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºåœ¨ç»™å®šçš„æ—¶é—´ä¸­ï¼Œå…±è‰²çš„ä¸šç»©å˜åŒ–æƒ…å†µã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºåŒ…å«äº†ä¸šç»©æ›²çº¿çš„æœ€å°å­çŸ©é˜µã€‚

#### é¢˜ç›®åˆ†æ

æ°´é¢˜ä¸€é“ï¼Œåªéœ€è¦æŒ¨ç€ä¸€ä¸ªä¸€ä¸ªåœ°å»æ‰¾è¿™ä¸ªå­—ç¬¦åº”è¯¥ç”»åœ¨å“ªå„¿å°±å¯ä»¥äº†ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$(ä¸»è¦æ˜¯è¾“å‡ºå¤æ‚åº¦)ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 1010
#define ywhin cin
#define ywhout cout
using namespace std;
char ans[N][N],cha[N];van n,max_,min_=1e18;
int main()
{
//	ifstream ywhin("crtanje.in");
//	ofstream ywhout("crtanje.out");
	van n;ywhin>>n;
	for (int i=1;i<=n;i++) ywhin>>cha[i];
	for (van i=1,now=500;i<=n;i++)
	{
		if (cha[i]=='=')
		{
			if (cha[i-1]=='-') now--;
			ans[now][i]='_';
			max_=max(max_,now);
			min_=min(min_,now);
		}
		else if (cha[i]=='-')
		{
			if (cha[i-1]!='-') now++;
			max_=max(max_,now);
			min_=min(min_,now);
			ans[now++][i]='\\';
		}
		else if (cha[i]=='+')
		{
			if (cha[i-1]=='-') now--;
			max_=max(max_,now);
			min_=min(min_,now);
			ans[now--][i]='/';
		}
	}//ä»¥y=500ä¸ºåŸºå‡†çº¿æ¥æŸ¥æ‰¾è¿™ä¸ªæ›²çº¿ç©¶ç«Ÿé•¿å•¥æ ·
	for (int i=min_;i<=max_;i++)
	{
		for (int j=1;j<=n;j++) ywhout<<(ans[i][j]==0?'.':ans[i][j]);
		ywhout<<endl;
	}//è¾“å‡ºçŸ©é˜µ
	return 0;
}
```

### T2 Odasiljaci

#### é¢˜ç›®æè¿°

è¿™æ˜¯ Sean æœ€åä¸€æ¬¡åœ¨é“¶å¹•ä¸Šå‡ºæ¼” James Bond(007)ã€‚

ä»–çš„ä»»åŠ¡æ˜¯è®© $n$ åº§åè½åœ¨å¹¿é˜”æ²™æ¼ ä¸­çš„åŸºç«™è¿æ¥æˆä¸€ä¸ªç½‘ç»œã€‚è¿™ä¸ªæ²™æ¼ å¯ä»¥ç”¨ä¸€ä¸ªäºŒç»´åæ ‡ç³»æ¥è¡¨ç¤ºã€‚007å¯ä»¥å†³å®šæ‰€æœ‰åŸºç«™(åŸºç«™çš„ä¿¡å·å¼ºåº¦å¿…é¡»æ˜¯ç»Ÿä¸€çš„)çš„ä¿¡å·å¼ºåº¦ï¼Œä¿¡å·å¼ºåº¦å¯ä»¥ç”¨ä¸€ä¸ªéè´Ÿæ•´æ•° $r$ æ¥è¡¨ç¤ºã€‚ä¸€ä¸ªåŸºç«™çš„è¦†ç›–èŒƒå›´åŒ…æ‹¬ä»¥åŸºç«™åæ ‡ä¸ºåœ†å¿ƒçš„åŠå¾„ä¸º $r$ å†…çš„æ‰€æœ‰åŒºåŸŸã€‚å¦‚æœä¸¤ä¸ªåŸºç«™å­˜åœ¨å…¬å…±è¦†ç›–ç‚¹ $c$ã€‚æˆ‘ä»¬å°±ç§°è¿™ä¸¤ä¸ªåŸºç«™ä¹‹é—´æ˜¯å¯ä»¥é€šä¿¡çš„ã€‚å¦‚æœåŸºç«™ A å’ŒåŸºç«™ Bï¼ŒåŸºç«™ B å’ŒåŸºç«™ C å¯ä»¥é€šä¿¡ã€‚é‚£ä¹ˆæˆ‘ä»¬ç§°åŸºç«™ A å’ŒåŸºç«™ C ä¹‹é—´ä¹Ÿå¯ä»¥å»ºç«‹é€šä¿¡ã€‚

007éœ€è¦è®©ä»»æ„ä¸¤ä¸ªåŸºç«™ä¹‹é—´éƒ½å¯ä»¥é€šä¿¡ã€‚é‰´äºå†›æƒ…6å¤„ç»è´¹æœ‰é™ï¼Œè€Œè¶Šå¼ºçš„ä¿¡å·éœ€è¦çš„ç»è´¹ä¹Ÿå°±è¶Šé«˜ã€‚ä½ éœ€è¦å¸®007æ±‚å‡ºæœ€å°çš„å¯ä»¥è®©æ‰€æœ‰åŸºç«™äº’ç›¸é€šä¿¡çš„ä¿¡å·å¼ºåº¦ $r$ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ­£æ•´æ•° $n(1\leq n\leq 1000)$ï¼Œè¡¨ç¤ºåŸºç«™çš„æ•°ç›®ã€‚

æ¥ä¸‹æ¥çš„ $n$ è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ­£æ•´æ•° $x,y(1\leq x,y\leq 10^9)$ï¼Œè¡¨ç¤ºç¬¬ $i$ ä¸ªåŸºç«™çš„åæ ‡ã€‚ 

#### è¾“å‡ºæè¿°

è¾“å‡ºæœ€å°çš„ä¿¡å·å¼ºåº¦ $r$ã€‚é‡‡ç”¨å®æ•°æ¯”è¾ƒæ¨¡å¼ï¼Œä¸æ ‡å‡†ç­”æ¡ˆçš„å·®è·å°äº $10^{-6}$ å³ä¸ºæ­£ç¡®ã€‚

#### é¢˜ç›®åˆ†æ

é¦–å…ˆè®¡ç®—æ¯ä¸¤ä¸ªç‚¹ä¹‹é—´æ‰€éœ€è¦çš„ $r_{min}$ï¼Œæ’åºä¹‹åæŒ¨ä¸ªåˆ¤æ–­ç»§ç»­åŠ ä¸Šè¿™æ¡è¾¹åèƒ½å¦ä½¿å¾—ä»»æ„ä¸¤ä¸ªåŸºç«™ä¹‹é—´éƒ½å¯ä»¥é€šä¿¡ï¼Œå¹¶ä¸”è®°å½•èƒ½ä½¿å¾—ä¸Šè¿°æ¡ä»¶æˆç«‹çš„ $r$ çš„æœ€å°å€¼ã€‚è‡³äºåˆ¤æ–­ä¸Šè¿°æ¡ä»¶å¦‚ä½•æˆç«‹ï¼Œåªéœ€è¦ç”¨ä¸€ä¸ªå¹¶æŸ¥é›†æ¥ç»´æŠ¤å³å¯ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(2n^2\log_2n)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 1010
#define ywhin cin
#define ywhout cout
using namespace std;
struct node
{
	double num;
	van a,b;
}line[N*N];
van n;double x[N],y[N],ans;van cnt;
van f[N];
van FindFather(van x)
{
	if (x==f[x]) return x;
	return f[x]=FindFather(f[x]);
}//å¹¶æŸ¥é›†
bool cmp(node a,node b)
{
	return a.num<b.num;
}
int main()
{
//	ifstream ywhin("odasiljaci.in");
//	ofstream ywhout("odasiljaci.out");
	ywhin>>n;
	for (int i=1;i<=n;i++) ywhin>>x[i]>>y[i];
	for (int i=1;i<=n;i++)
	{
		for (int j=1;j<i;j++)
		{
			double dis=(x[i]-x[j])*(x[i]-x[j])+(y[i]-y[j])*(y[i]-y[j]);
			dis=sqrt(dis);
			dis/=2;
			line[++cnt].num=dis;
			line[cnt].a=i,line[cnt].b=j;
		}
	}//è®¡ç®—ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„rçš„æœ€å°å€¼
	for (int i=1;i<=n;i++) f[i]=i;
	sort(line+1,line+cnt+1,cmp);//æŒ‰ç…§æ¯ä¸¤ä¸ªç‚¹ä¹‹é—´çš„rçš„æœ€å°å€¼æ’åº
	for (int i=1;i<=cnt;i++)
	{
		if (FindFather(line[i].a)!=FindFather(line[i].b))
		{
			f[FindFather(line[i].a)]=f[FindFather(line[i].b)];
			ans=line[i].num;
		}
	}//å¹¶æŸ¥é›†æŸ¥æ‰¾ç­”æ¡ˆ
	ywhout<<fixed<<setprecision(7)<<ans<<endl;
	return 0;
}
```

### T3 Euklid 

#### é¢˜ç›®æè¿°

å° E æ˜¯ä¸€ä¸ªå¯¹æ•°å­¦éå¸¸æ„Ÿå…´è¶£çš„å­©å­ï¼Œä¸€å¤©ï¼Œä»–çªå‘å¥‡æƒ³å‘æ˜äº†ä¸€ä¸ªå‡½æ•° Rã€‚
$$
R(a,b)=
\begin{cases}
R(b,a), a<b\\\\
R(\frac{a}{b},b), a\geq b>1\\\\
a, a\geq b=1
\end{cases}
$$
ä½ çš„ä»»åŠ¡æ˜¯ï¼Œå¯¹äºç»™å®šçš„æ­£æ•´æ•° **$g$** å’Œ **$h$**ã€‚æ‰¾åˆ°ä¸€å¯¹æ­£æ•´æ•°(a,b)ï¼Œä½¿å¾— **$a$ å’Œ $b$ çš„æœ€å¤§å…¬çº¦æ•°ä¸º $g$ï¼ŒåŒæ—¶ $R(a,b)=h$**ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ­£æ•´æ•° $t(1\leq t\leq 40)$ã€‚è¡¨ç¤ºæµ‹è¯•æ•°æ®çš„æ•°ç›®ã€‚

æ¥ä¸‹æ¥çš„ $t$ è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ­£æ•´æ•° $g$ å’Œ $h(h\geq 2)$ï¼Œå«ä¹‰è§é¢˜ç›®æè¿°ã€‚ 

#### è¾“å‡ºæè¿°

æ€»å…±è¾“å‡º $t$ è¡Œï¼Œå¯¹äºç¬¬ $i$ è¡Œï¼Œè¾“å‡ºä¸¤ä¸ªæ­£æ•´æ•° $a_i,b_i$ã€‚æ»¡è¶³ $\gcd(a_i,b_i)=g_i$ ä¸” $R(a_i,b_i)=h_i$ã€‚

è¾“å‡ºçš„æ•°å­—å¤§å°ä¸èƒ½è¶…è¿‡ $10^{18}$ï¼Œä¿è¯è¿™æ ·çš„è§£æ€»æ˜¯å­˜åœ¨çš„ã€‚å¦‚æœç”±å¤šç»„è§£ï¼Œè¾“å‡ºä»»æ„ä¸€ç»„ã€‚

#### é¢˜ç›®åˆ†æ

##### 4Pts

å½“ $g=h$ æ—¶ï¼Œç‰¹è§£ $a=b=g$ èƒ½æ°å¥½ä½¿å¾— $\gcd(a,b)=g$ ä¸” $R(a,b)=g=h$ã€‚

##### 12Pts

åœ¨å®ŒæˆSubtask1çš„åŸºç¡€ä¸Šè€ƒè™‘å¦‚ä½•è§£å†³Subtask2ã€‚

ä¸éš¾å‘ç°ï¼Œå½“ $h=2$ æ—¶ï¼Œç‰¹è§£ $a=5\times g,b=2\times g$ èƒ½æ°å¥½ä½¿å¾— $\gcd(a,b)=g$ ä¸” $R(a,b)=2$ã€‚

æ³¨æ„ï¼š$a=5\times g,b=2\times g$ å¹¶ä¸æ˜¯è¯¥Subtaskçš„å”¯ä¸€è§£ã€‚

##### 20Pts

åœ¨å®ŒæˆSubtask1å’ŒSubtask2çš„åŸºç¡€ä¸Šè€ƒè™‘å¦‚ä½•è§£å†³Subtask3ã€‚

ä¸éš¾å‘ç°ï¼Œå½“ $g=h^2$ æ—¶ï¼Œç‰¹è§£ $a=h^3,b=h^2$ èƒ½æ°å¥½ä½¿å¾— $\gcd(a,b)=h^2=g$ ä¸” $R(a,b)=h$ã€‚

æ³¨æ„ï¼š$a=h^3,b=h^2$ å¹¶ä¸æ˜¯è¯¥Subtaskçš„å”¯ä¸€è§£

##### 100Pts

åœ¨å®Œæˆå‰3ä¸ªSubtaskçš„åŸºç¡€ä¸Šè€ƒè™‘å¦‚ä½•è§£å†³æ­¤é¢˜ã€‚

ç”±äº $h=R(h,1)=R(1,h)=R(b,h)$ï¼Œåˆ™è®¡ç®— $k$ æ¬¡ $\lfloor\frac{b}{h}\rfloor$ çš„æœ€ç»ˆç»“æœä¸€å®šä¸º1ã€‚

è€ƒè™‘æš´åŠ› $b$ çš„å€¼ï¼Œç”±äº $\gcd(a,b)=g$ï¼Œåˆ™ $b=yg$ï¼Œæš´åŠ›æšä¸¾ $yg$ æ˜¯å¦ç¬¦åˆä¸Šè¿°æ¡ä»¶å³å¯ã€‚

å¯¹äºè®¡ç®— $a$ çš„å€¼ï¼Œç”±äº $\gcd(a,b)=g$ï¼Œåˆ™å¯ä»¥ä»¤ $a=xg$ï¼Œç”±äº $R(a,b)=R(xg,yg)=R(yg,h)=R(h,1)$ï¼Œå³ $\lfloor\frac{x}{y}\rfloor=h$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä»¤ $x=hy+1$ï¼Œè¿™æ ·æ—¢æ»¡è¶³ $R(a,b)=h$ï¼Œä¹Ÿèƒ½ä½¿å¾— $\gcd(a,b)=g$ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(\sum_{i=1}^t x_i)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 100010
#define ywhin cin
#define ywhout cout
using namespace std;
van t;
int main()
{
//	ifstream ywhin("euklid.in");
//	ofstream ywhout("euklid.out");
	ywhin>>t;
	while(t--)
	{
		van g,h;
		ywhin>>g>>h;
		if (g==h) ywhout<<g<<" "<<g<<endl;//Subtask1
		else if (g==h*h) ywhout<<h*h*h<<" "<<h*h<<endl;//Subtask3
		else if (h==2) ywhout<<5*g<<" "<<2*g<<endl;//Subtask2
		else
		{
			van now=2*g;bool ok=false;
			while (!ok)
			{
				van tmp=now;
				while(tmp>1) tmp/=h;
				if (tmp==1)
				{
					ywhout<<now*h+g<<" "<<now<<endl;
					ok=true;
				}
				now+=g;
			}//æš´åŠ›æšä¸¾bçš„å€¼æ˜¯å¦ç¬¦åˆæ¡ä»¶
		}
	}
	return 0;
}
```

### T4 Sjekira

#### é¢˜ç›®æè¿°

M å…ˆç”Ÿæ˜¯ä¸€ä¸ªç¨‹åºå‘˜ï¼Œä¸è¿‡ï¼Œä»–èµšå¤Ÿäº†é’±ï¼Œæ¥åˆ°äº†ä¸€ä¸ªå°æ‘å­å®šå±…ã€‚ç°åœ¨ï¼Œå‡›å†¬å°†è‡³ï¼ŒM å…ˆç”Ÿä¸å¾—ä¸ç ä¼æœ¨æç”Ÿç«è¿‡å†¬ã€‚

M å…ˆç”Ÿé¢å‰æœ‰ä¸€æ£µå·¨å¤§çš„æ ‘ã€‚M å…ˆç”Ÿå°†è¿™æ£µç‰©ç†æ„ä¹‰ä¸Šçš„æ ‘æŠ½è±¡æˆäº†æ•°æ®ç»“æ„ä¸­çš„ä¸€æ£µæ ‘ã€‚æ ‘ä¸Šçš„æ¯ä¸€ä¸ªèŠ‚ç‚¹å­˜åœ¨ä¸€ä¸ªåšç¡¬ç¨‹åº¦ $t_i$ã€‚å½“ M å…ˆç”Ÿæƒ³è¦ç æ‰æ ‘ä¸Šçš„ä¸€æ¡è¾¹æ—¶ï¼Œä»–çš„æ–§å¤´çš„å—æŸç¨‹åº¦ä¼šå¢åŠ  $t_x+t_y$ã€‚$x$ å’Œ $y$ åˆ†åˆ«æ˜¯ç å»è¿™æ¡è¾¹åå½¢æˆçš„ä¸¤ä¸ªå­æ ‘å†… $t_i$ æœ€å¤§çš„èŠ‚ç‚¹ã€‚

ä½ çš„ä»»åŠ¡æ˜¯æ±‚å‡ºä¸€ä¸ªç ä¼æ–¹æ¡ˆï¼Œå°†è¿™æ£µæ ‘çš„æ‰€æœ‰è¾¹å…¨éƒ¨ç æ‰ï¼Œä½¿å¾— M å…ˆç”Ÿçš„æ–§å¤´å—åˆ°çš„æŸä¼¤ç¨‹åº¦æœ€å°ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•° $n$ï¼Œè¡¨ç¤ºæ ‘çš„å¤§å°ï¼Œæ ‘çš„èŠ‚ç‚¹ç¼–å·ä» 1 åˆ° $n$ã€‚

ç¬¬äºŒè¡ŒåŒ…å«ä¸€ä¸ª $n$ ä¸ªæ•´æ•°ï¼Œç¬¬ $i$ ä¸ªæ•´æ•°å³ä¸º $t_i(1\leq t_i\leq 10^9)$ã€‚å«ä¹‰è§é¢˜é¢ã€‚

æ¥ä¸‹æ¥çš„ $n-1$ è¡Œï¼Œæ¯ä¸€è¡Œç”±ä¸¤ä¸ªæ•´æ•° $x$ å’Œ $y(1\leq x,y\leq n)$ã€‚è¡¨ç¤ºè¿™æ£µæ ‘ä¸Šçš„è¾¹ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºä¸€è¡Œï¼Œä¸€ä¸ªæ•´æ•°ï¼Œå³æœ€å°çš„æ–§å¤´ç£¨æŸç¨‹åº¦ã€‚

#### é¢˜ç›®åˆ†æ

##### 40Pts

æ­¤æ¡£æ•°æ®èŒƒå›´ $n\leq 1000$ï¼Œåœ¨ $O(n^2)$ çš„æ—¶é—´å¤æ‚åº¦ä¸‹å®Œå…¨èƒ½å¤Ÿé€šè¿‡æ­¤é¢˜ã€‚ä¸éš¾å‘ç°ï¼Œå½“ä»æƒå€¼æœ€å¤§çš„èŠ‚ç‚¹å¼€å§‹ç ç›´åˆ°æƒå€¼æœ€å°çš„èŠ‚ç‚¹çš„æœ€ç»ˆçš„æŸä¼¤ç¨‹åº¦ä¸€å®šä¸åŠ£äºéšä¾¿ç åæœ€ç»ˆçš„æŸä¼¤ç¨‹åº¦ã€‚

æœ€åä»æ ¹èŠ‚ç‚¹å¼€å§‹æ‰«å°±è¡Œäº†ï¼Œæ‰¾åˆ°ä»¥å½“å‰èŠ‚ç‚¹ä¸ºæ ¹çš„å­æ ‘ä¸­æƒå€¼æœ€å¤§çš„èŠ‚ç‚¹å¹¶å°†å…¶ç æ‰ï¼Œå†ä»è¿™ä¸ªæƒå€¼æœ€å¤§çš„ç‚¹çš„å­æ ‘å¼€å§‹æ‰«ï¼Œç›´åˆ°æ‰€æœ‰èŠ‚ç‚¹éƒ½è¢«ç æ‰å³å¯ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$ã€‚

##### 100Pts

æŒ‰ç…§ä¸Šè¿°æ€è·¯è¿›è¡Œè§‚å¯Ÿã€‚è‹¥æŸä¸€ä¸ªèŠ‚ç‚¹è¢«æ‰¾åˆ°äº†çš„è¯ï¼Œé‚£ä¹ˆå…¶æ‰€åœ¨çš„å­æ ‘åœ¨ä¸Šä¸€è½®è¢«åˆ†å‰²æ—¶çš„æœ€å¤§å€¼ä¸€å®šæ˜¯å®ƒã€‚ç„¶ååœ¨åˆ†å‰²æ—¶å…¶åˆä¼šå¯¹æœ€ç»ˆç»“æœäº§ç”Ÿ $t_i\times g_i$ çš„è´¡çŒ®(è®¾ $g_i$ ä¸º $i$ èŠ‚ç‚¹çš„æ²¡è¢«ç æ‰çš„è¾¹çš„æ•°é‡)ã€‚å› æ­¤ï¼Œé™¤æƒå€¼æœ€å¤§çš„èŠ‚ç‚¹å¤–ï¼Œå…¶ä»–èŠ‚ç‚¹å¯¹æœ€ç»ˆç»“æœçš„è´¡çŒ®å€¼ä¸º $t_i\times (g_i+1)$ã€‚ç”±äºæƒå€¼æœ€å¤§çš„èŠ‚ç‚¹æ˜¯ç¬¬ä¸€ä¸ªè¢«åˆ†å‰²çš„ï¼Œå› æ­¤åœ¨æ­¤ä¹‹å‰æ²¡æœ‰è¿›è¡Œåˆ†å‰²æ“ä½œï¼Œå…¶å¯¹æœ€ç»ˆç»“æœçš„è´¡çŒ®åº”ä¸º $t_i\times g_i$ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¯¹èŠ‚ç‚¹çš„æƒå€¼æ’åºå†å»è®¡ç®—æ¯ä¸ªç»“ç‚¹å¯¹æœ€ç»ˆç»“æœçš„è´¡çŒ®ã€‚æœ€ç»ˆè®¡ç®—æ—¶çš„æ—¶é—´å¤æ‚åº¦ä»…ä¸º $O(n)$ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n\log_2 n)$(ä¸»è¦æ˜¯æ’åºæ—¶é—´å¤æ‚åº¦)ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 100010
using namespace std;
van n,line[N],sum;vector<van> g[N];
struct node{van num,id;}ans[N];
bool cmp(node a,node b){return a.num>b.num;}
int main(){
	cin>>n;
	for (int i=1;i<=n;i++) cin>>ans[i].num,ans[i].id=i;
	for (int i=1;i<n;i++){
		van f,s;
		cin>>f>>s;
		g[f].push_back(s);
		g[s].push_back(f);//å»ºè¾¹
		line[s]++,line[f]++;//è®¡ç®—æŸä¸ªç‚¹æ‰€è¿æ¥çš„è¾¹çš„æ•°é‡
	}
    sort(ans+1,ans+n+1,cmp);
	sum+=line[ans[1].id]*ans[1].num;
	for (int i=0;i<g[ans[1].id].size();i++) line[g[ans[1].id][i]]--;//ç‰¹æ®Šå¤„ç†æƒå€¼æœ€å¤§çš„ç‚¹
	for (int i=2;i<=n;i++){
		sum+=(line[ans[i].id]+1)*ans[i].num;
		for (int j=0;j<g[ans[i].id].size();j++) line[g[ans[i].id][j]]--;
	}//å¤„ç†å…¶ä»–çš„ç‚¹
	cout<<sum<<endl;
	return 0;
}
```

### T5 Svjetlo

åŸæ–‡é“¾æ¥: [COCI 2020/2021 Svjetloï¼ˆæ ‘å½¢DPï¼‰_ZSJZ_liuziançš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/qq_39565901/article/details/110502442)

#### é¢˜ç›®æè¿°

å° F å®¶çš„ä¸€äº›ç¯å…³ä¸Šäº†ã€‚ç°åœ¨ï¼Œå° F å¾—å»æŠŠæ‰€æœ‰çš„ç¯æ‰“å¼€ã€‚å° F å®¶çš„ç¯ç»“æ„æ¯”è¾ƒç‰¹æ®Šï¼Œç¯æ³¡å’Œç”µçº¿ç»„æˆäº†ä¸€ä¸ª**æ ‘ç»“æ„**ã€‚

å¯¹äºä¸€ä¸ªç¯æ³¡ï¼Œæœ‰ä¸€ä¸ªå”¯ä¸€å¯¹åº”çš„å¼€å…³ã€‚å¦‚æœç¯æ˜¯å…³ç€çš„ï¼Œé‚£ä¹ˆæŒ‰ä¸€ä¸‹å¼€å…³ä¹‹åï¼Œç¯å°±ä¼šæ‰“å¼€ï¼Œå¦‚æœç¯æ˜¯æ‰“å¼€çš„ï¼Œé‚£ä¹ˆæŒ‰ä¸€ä¸‹å¼€å…³ä¹‹åç¯å°±ä¼šç­æ‰ã€‚

å° F æŒ‰ç¯æ³¡æœ‰ä¸€ä¸ªå¥‡æ€ªçš„ç™–å¥½ï¼Œä»–ä¼šæ²¿ç€ä¸€æ¡**æ ‘ä¸Šçš„è·¯å¾„**ä¾æ¬¡æ‰¾åˆ°æ‰€æœ‰èŠ‚ç‚¹å¯¹åº”çš„å¼€å…³ç„¶åæŒ‰ä¸‹å¼€å…³ã€‚ä½ çš„ä»»åŠ¡æ˜¯å¯»æ‰¾ä¸€æ¡æœ€çŸ­çš„è·¯å¾„ï¼Œæ²¿ç€è¿™æ¡è·¯å¾„æŒ‰å¼€å…³ï¼Œä¼šä½¿å¾—**æ‰€æœ‰çš„ç¯æ³¡éƒ½è¢«æ‰“å¼€**ã€‚

è¾“å…¥æ•°æ®ä¿è¯è‡³å°‘ç”±ä¸€ä¸ªç¯æ³¡åœ¨æœ€åˆçš„æ—¶å€™æ˜¯ç†„ç­çš„ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•° $n$ã€‚è¡¨ç¤ºç¯æ³¡çš„æ•°é‡ï¼Œç¯æ³¡çš„ç¼–å·ä» 1 åˆ° $n$ã€‚

è¾“å…¥çš„ç¬¬äºŒè¡Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„ç”±`0`å’Œ`1`ç»„æˆçš„å­—ç¬¦ä¸²ã€‚å¦‚æœå­—ç¬¦ä¸²çš„ç¬¬ $i$ ä½ä¸º`0`ï¼Œé‚£å°±è¡¨ç¤ºç¼–å·ä¸º $i$ çš„ç¯æ³¡æœ€å¼€å§‹æ˜¯ç†„ç­çš„ã€‚å¦‚æœå­—ç¬¦ä¸²çš„ç¬¬ $i$ ä½ä¸º`1`ï¼Œå°±è¡¨ç¤ºç¼–å·ä¸º $i$ çš„ç¯æ³¡æœ€å¼€å§‹æ˜¯æ‰“å¼€çš„ã€‚

æ¥ä¸‹æ¥çš„ $n-1$ è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ•´æ•° $x$ å’Œ $y(1\leq x,y\leq n)$ï¼Œè¡¨ç¤ºæ ‘ä¸Šçš„ä¸€æ¡è¿æ¥ $x$ å’Œ $y$ çš„è¾¹ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºæœ€å°çš„ä½¿å¾—æ‰€æœ‰ç¯æ³¡æ‰“å¼€çš„æŒ‰å¼€å…³è·¯å¾„ï¼Œä¿è¯å­˜åœ¨è§£ï¼Œè·¯å¾„çš„é•¿åº¦å®šä¹‰ä¸ºè·¯å¾„ä¸Šç‚¹çš„æ•°ç›®ã€‚

#### é¢˜ç›®åˆ†æ

è·¯å¾„æ˜¯å¯ä»¥é‡å¤çš„ï¼Œç®€å•çš„æ ‘å½¢DPå¯èƒ½éš¾ä»¥å¤„ç†ï¼Œè€ƒè™‘è·¯å¾„çš„æ‹¼æ¥ã€‚

è®¾ $f_{i,j,k}$ è¡¨ç¤ºç¬¬ $i$ ä¸ªç‚¹çš„å­æ ‘å†…ï¼ˆé™¤äº†è‡ªå·±ï¼‰çš„å¥‡å¶æ€§å·²ç»æ»¡è¶³ï¼Œä¸”å­æ ‘å†…ï¼ˆåŒ…æ‹¬è‡ªå·±ï¼‰çš„è·¯å¾„ç«¯ç‚¹æ•°æœ‰ $j$ ä¸ªï¼Œç¬¬ $i$ ä¸ªç‚¹çš„å¥‡å¶æ€§ä¸º $k$ çš„æœ€çŸ­è·¯å¾„é•¿åº¦ï¼Œå…¶ä¸­ $j\in \{0,1,2\},k\in\{0,1\}$ã€‚

è½¬ç§»çš„æ—¶å€™æœ‰å¾ˆå¤šç§æƒ…å†µï¼Œä½†å®ƒä»¬éƒ½æ˜¯ç±»ä¼¼çš„ï¼Œç«¯ç‚¹ä¸ªæ•°ï¼ˆçŠ¶æ€ç¬¬äºŒç»´ï¼‰çš„è½¬ç§»æœ‰ï¼š

1ã€å„¿å­å­æ ‘å†…å‡ä¸º 0 ä¸ªç«¯ç‚¹ â€“> è‡ªå·±å­æ ‘ 0 ä¸ªç«¯ç‚¹

2ã€å„¿å­å­æ ‘å†…å‡ä¸º 0 ä¸ªç«¯ç‚¹ + è‡ªå·±ä½œä¸ºæŸä¸€ä¸ªç«¯ç‚¹ â€“> è‡ªå·±å­æ ‘å†… 1 ä¸ªç«¯ç‚¹

3ã€å„¿å­å­æ ‘å†…å‡ä¸º 0 ä¸ªç«¯ç‚¹ + è‡ªå·±ä½œä¸ºä¸¤ä¸ªç«¯ç‚¹ â€“> è‡ªå·±å­æ ‘å†… 2 ä¸ªç«¯ç‚¹

4ã€ä¸€ä¸ªå„¿å­å­æ ‘å†… 1 ä¸ªç«¯ç‚¹ + å…¶ä»–å„¿å­å­æ ‘å†…å‡ä¸º 0 ä¸ªç«¯ç‚¹ â€“> è‡ªå·±å­æ ‘å†… 1 ä¸ªç«¯ç‚¹	

5ã€ä¸€ä¸ªå„¿å­å­æ ‘å†… 1 ä¸ªç«¯ç‚¹ + å…¶ä»–å„¿å­å­æ ‘å†…å‡ä¸º 0 ä¸ªç«¯ç‚¹ + è‡ªå·±ä½œä¸ºæŸä¸ªç«¯ç‚¹ â€“> è‡ªå·±å­æ ‘å†… 2 ä¸ªç«¯ç‚¹

6ã€ä¸€ä¸ªå„¿å­å­æ ‘å†… 2 ä¸ªç«¯ç‚¹ + å…¶ä»–å„¿å­å­æ ‘å†…å‡ä¸º 0 ä¸ªç«¯ç‚¹ â€“> è‡ªå·±å­æ ‘å†… 2 ä¸ªç«¯ç‚¹

7ã€ä¸¤ä¸ªå„¿å­å­æ ‘å†…å„ 1 ä¸ªç«¯ç‚¹ + å…¶ä»–å„¿å­å­æ ‘å†…å‡ä¸º 0 ä¸ªç«¯ç‚¹ â€“> è‡ªå·±å­æ ‘å†… 2 ä¸ªç«¯ç‚¹

ç¬¬äºŒç»´çš„ $j$ å¯ä»¥ç†è§£ä¸ºæ˜¯ä¼¸å‡ºäº†å¤šå°‘ä¸ªâ€œå¤´â€ï¼Œç„¶åæ¯ä¸ªå­æ ‘ç›¸è¿æ‹¼æ¥ä¸Šï¼Œå†ç”¨å‰©ä¸‹çš„â€œå¤´â€ç»§ç»­å¾€ä¸Šè½¬ç§»ã€‚0 å’Œ 2 éƒ½æ˜¯ä¸¤ä¸ªâ€œå¤´â€ï¼Œ 1 æ˜¯ä¸€ä¸ªâ€œå¤´â€ã€‚

å„¿å­ä¹‹é—´åˆå¹¶çš„æ—¶å€™è¦æ³¨æ„ç­”æ¡ˆæ‰€æ±‚çš„æ˜¯è·¯å¾„ç‚¹çš„ä¸ªæ•°ï¼Œæ‰€ä»¥ä¸èƒ½æŠŠæ¯ä¸ªå„¿å­æ‰€æœ‰â€œ2â€éƒ½å»¶é•¿ 2 çš„é•¿åº¦åˆ°çˆ¶äº²ï¼Œä¸ç„¶å„¿å­ä¹‹é—´ç›¸æ¥æ—¶ä¼šç®—é‡ï¼Œè€Œåº”è¯¥å°‘å»¶é•¿ä¸€ä¸ªâ€å¤´â€œï¼Œæœ€åæ›´æ–°ç­”æ¡ˆæ—¶å†åªåŠ å¤š 1ã€‚

å¦‚ä½•ä¿è¯å„¿å­å­æ ‘å†…çš„å¥‡å¶æ€§éƒ½æ»¡è¶³æ¡ä»¶ï¼Ÿå¦‚æœä»å„¿å­èŠ‚ç‚¹å°šä¸æ»¡è¶³å¥‡å¶æ€§çš„ç‚¹è½¬ç§»æ—¶ï¼Œéœ€è¦å¤šåŠ ä¸Š 2 çš„é•¿åº¦ï¼Œè¡¨ç¤ºåˆ°äº†çˆ¶äº²å†å¾€ä¸‹åˆ°å„¿å­èµ°ä¸€ä¸ªæ¥å›ã€‚

è‡³äºç¬¬ä¸‰ç»´æ˜¯è½¬ç§»åˆ°å½“å‰èŠ‚ç‚¹çš„ 0 è¿˜æ˜¯ 1ï¼Œéœ€è¦çœ‹è½¬ç§»ä¸Šæ¥çš„å¶å„¿å­ï¼ˆæŒ‡ $j$ ä¸ºå¶æ•°çš„å„¿å­ï¼‰ä¸ªæ•°çš„å¥‡å¶æ€§ã€‚

è¿˜è¦æ³¨æ„ï¼Œæ ¹èŠ‚ç‚¹å‰©ä¸‹çš„ä¸¤ä¸ªâ€œå¤´â€ä¼šç›¸è¿ï¼Œä¸ä»…ç­”æ¡ˆä¼šå‡ 1 ï¼Œè€Œä¸”å¯¹ä»–è€Œè¨€å¥‡å¶æ€§è¿˜ä¼šå†å¤šå˜ä¸€æ¬¡ã€‚

è¿™æ ·å°±åšå®Œäº†å—ï¼Ÿ

å†™åˆ°åé¢å¯èƒ½ä¼šå¾ˆå®¹æ˜“å¿½ç•¥çš„æ˜¯ï¼Œè¿™æ ·å†™ä¼šé»˜è®¤æ¯ä¸ªèŠ‚ç‚¹éƒ½è‡³å°‘è¢«ç»è¿‡ä¸€æ¬¡ï¼Œè€Œå…¶å®å¹¶ä¸ç„¶ï¼Œæ‰€ä»¥æ ¹èŠ‚ç‚¹è®¾ä¸ºä»»æ„ä¸€ä¸ªå¥‡å¶æ€§æ¡ä»¶ä¸º 1 ç‚¹ï¼ŒåŒæ—¶åœ¨æšä¸¾å„¿å­è½¬ç§»æ—¶ï¼Œè‹¥æ•´ä¸ªå­æ ‘éƒ½å·²ç»æ»¡è¶³äº†å°±ç›´æ¥è·³è¿‡ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<cstdio>
#include<cstring>
#include<algorithm>
using namespace std;
#define N 500010
int last[N], nxt[N * 2], to[N * 2], len = 0;
int f[N][3][2], a[N], s[N];
void add(int x, int y) {
	to[++len] = y;
	nxt[len] = last[x];
	last[x] = len;
}//åŠ è¾¹
void dfs(int k, int fa) {
	int s0 = 0, s1 = 1e9, s2 = 1e9, s3 = 1e9, s4 = 1e9, s5 = 1e9, s6 = 1e9, s7 = 1e9; 
	int t0, t1;
	if(!a[k]) s[k]++;
	for(int i = last[k]; i; i = nxt[i]) if(to[i] != fa) {
		int x = to[i];
		dfs(x, k);
		if(!s[to[i]]) continue;
		s[k] += s[to[i]];
		t0 = min(s7 + f[x][0][1] + 1, s6 + f[x][0][0] + 3), t1 = min(s6 + f[x][0][1] + 1, s7 + f[x][0][0] + 3);
		s6 = t0, s7 = t1;
		t0 = min(s2 + f[x][1][1], s3 + f[x][1][0] + 2), t1 = min(s3 + f[x][1][1], s2 + f[x][1][0] + 2);
		s6 = min(s6, t0), s7 = min(s7, t1);
		
		t0 = min(s5 + f[x][0][1] + 1, s4 + f[x][0][0] + 3), t1 = min(s4 + f[x][0][1] + 1, s5 + f[x][0][0] + 3);
		s4 = t0, s5 = t1;
		t0 = min(s1 + f[x][2][1] + 1, s0 + f[x][2][0] + 3), t1 = min(s0 + f[x][2][1] + 1, s1 + f[x][2][0] + 3);
		s4 = min(s4, t0), s5 = min(s5, t1);
		
		t0 = min(s3 + f[x][0][1] + 1, s2 + f[x][0][0] + 3), t1 = min(s2 + f[x][0][1] + 1, s3 + f[x][0][0] + 3);
		s2 = t0, s3 = t1;
		t0 = min(s0 + f[x][1][1], s1 + f[x][1][0] + 2), t1 = min(s1 + f[x][1][1], s0 + f[x][1][0] + 2);
		s2 = min(s2, t0), s3 = min(s3, t1);
		
		t0 = min(s1 + f[x][0][1] + 1, s0 + f[x][0][0] + 3), t1 = min(s0 + f[x][0][1] + 1, s1 + f[x][0][0] + 3);
		s0 = t0, s1 = t1;
	
	}//å¿«ä¹çŠ¶æ€è½¬ç§»æ–¹ç¨‹
	f[k][0][a[k]] = s1 + 1;
	f[k][0][a[k] ^ 1] = s0 + 1;
	f[k][1][a[k]] = min(s3, s1) + 1;
	f[k][1][a[k] ^ 1] = min(s2, s0) + 1;
	f[k][2][a[k]] = min(min(s0 + 2, s5 + 1), min(s6 + 2, s2 + 2));
	f[k][2][a[k] ^ 1] = min(min(s1 + 2, s4 + 1), min(s7 + 2, s3 + 2));//èµ‹å€¼
}
int main() {
	int n, i, x, y;
	scanf("%d\n", &n);
	for(i = 1; i <= n; i++) {
		a[i] = getchar() - '0';
	}
	for(i = 1; i < n; i++) {
		scanf("%d%d", &x, &y);
		add(x, y), add(y, x);
	}//è¾“å…¥
	for(i = 1; i <= n; i++) if(!a[i]) break;//æŸ¥æ‰¾ç¬¬ä¸€ä¸ªæ²¡æœ‰æ‰“å¼€çš„ç¯
	dfs(i, 0);
	printf("%d\n", f[i][2][0] - 1);
	fclose(stdin);
	fclose(stdout);
	return 0;
}
```

## COCI2020-2021 #3

### T1 Knjige

#### é¢˜ç›®æè¿°

å° A åŒå­¦çš„å®¶é‡Œæœ‰ä¸¤ä¸ªä¹¦æ¡Œï¼Œå…¶ä¸­çš„ä¸€ä¸ªæ¡Œå­ä¸Šæ‘†ç€ä¸€æ‘ä¹¦ï¼Œå¦ä¸€ä¸ªä¹¦æ¡Œåˆ™æ˜¯ç©ºçš„ã€‚å° A åŒå­¦æ˜¯ä¸€ä¸ªå¼ºè¿«ç—‡ï¼Œä»–æ€»æ˜¯å¸Œæœ›ä¹¦ç±æŒ‰ç…§è‡ªå·±çš„åšåº¦å †æ”¾ã€‚å…·ä½“çš„è¯´ï¼Œæœ€åšçš„ä¹¦åº”è¯¥æ”¾åœ¨æœ€ä¸‹é¢ï¼Œ æ¬¡åšçš„ä¹¦åº”è¯¥æ”¾åœ¨å€’æ•°ç¬¬äºŒæœ¬çš„ä½ç½®ï¼Œä»¥æ­¤ç±»æ¨ã€‚å¯æƒœï¼Œç°åœ¨å †æ”¾ç€ä¹¦çš„ä¹¦æ¡Œå¹¶æ²¡æœ‰æŒ‰ç…§è¿™ä¸ªè§„åˆ™æ¥æ‘†æ”¾ã€‚å° A åŒå­¦å†³å®šè¿›è¡Œæ•´ç†ã€‚æ¯ä¸€æ¬¡ï¼Œå° A åŒå­¦ä¼šæ‰§è¡Œå¦‚ä¸‹ä¸¤ä¸ªæ“ä½œä¸­çš„ä¸€ä¸ªï¼š

1.å°†ä¸€æœ¬ä¹¦ä»ä¸€æ‘ä¹¦çš„é¡¶éƒ¨æ‹¿åˆ°è‡ªå·±çš„æŸä¸€åªæ‰‹ä¸Šï¼Œå‰ææ˜¯è¿™åªæ‰‹ä¸Šä¹‹å‰æ²¡æœ‰åˆ«çš„ä¹¦ã€‚ 

2.å°†è‡ªå·±æŸä¸€åªæ‰‹ä¸Šçš„ä¹¦æ”¾åˆ°æŸä¸ªä¹¦æ¡Œä¸Šé‚£ä¸€æ‘ä¹¦çš„é¡¶éƒ¨ã€‚

å° A è™½ç„¶çƒ­çˆ±è¿åŠ¨ï¼Œèº«ä½“å¼ºå¥ï¼Œä½†æ˜¯å¹¶ä¸æ“…é•¿äºæ•´ç†ä¹¦ç±ï¼Œå› æ­¤ï¼Œä»–å¸Œæœ›ä½ èƒ½å¤Ÿç»™ä»–ä¸€ä¸ªæ“ä½œåºåˆ—ï¼Œæ ¹æ®è¿™ä¸ªæ“ä½œåºåˆ—çš„é¡ºåºæ‰§è¡Œï¼Œå°±å¯ä»¥å°†æ‰€æœ‰çš„ä¹¦ç±æ•´ç†åˆ°**å·¦ä¾§ä¹¦æ¡Œ**ä¸Šï¼Œä¸”ä¹¦ç±æŒ‰ç…§**ä»åšåˆ°è–„çš„é¡ºåºä»ä¸‹å¾€ä¸Šå †å ã€‚**

#### è¾“å‡ºæè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•° $n(1\leq n\leq 100)$ï¼Œè¡¨ç¤ºä¹¦ç±çš„æ•°é‡ã€‚ 

è¾“å…¥çš„ç¬¬äºŒè¡Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°ç»„ $d$ï¼Œ$d_i(1\leq d_i\leq 1000)$ è¡¨ç¤ºæœ€å¼€å§‹å·¦ä¾§ä¹¦æ¡Œä¸Šçš„é‚£ä¸€æ‘ä¹¦ä»ä¸Šå¾€ä¸‹æ•°ç¬¬ $i$ æœ¬ä¹¦çš„åšåº¦ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºçš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•° $k(0\leq k\leq 10^5)$ï¼Œè¡¨ç¤ºä½ ç»™å‡ºçš„ç­”æ¡ˆæ“ä½œåºåˆ—çš„é•¿åº¦ã€‚ 

æ¥ä¸‹æ¥çš„ $k$ è¡Œæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªæ ¼å¼ä¸º: `INSTRUCTION HAND SHELF` çš„æŒ‡ä»¤ï¼Œå„ä¸ªå‚æ•°æ„ä¹‰å¦‚ä¸‹: 

1.`INSTRUCTION` æ˜¯ä¸‹åˆ—å•è¯ä¸­çš„ä¸€ä¸ª: `UZMI` (è¡¨ç¤ºä»æŸä¸€ä¸ªä¹¦æ¶é¡¶æ‹¿ä¹¦)ï¼Œ`STAVI`(å°†ä¸€æœ¬ ä¹¦æ”¾åœ¨æŸä¸€ä¸ªä¹¦æ¶ä¸Š) 

2.`HAND` åªèƒ½æ˜¯å­—ç¬¦ `L` å’Œ `D` ä¸­çš„ä¸€ä¸ªï¼Œ`L `è¡¨ç¤ºå·¦æ‰‹ï¼Œ`D` è¡¨ç¤ºå³æ‰‹ã€‚

3.`SHELF` ä¹Ÿåªèƒ½æ˜¯å­—ç¬¦ `L` å’Œ `D` ä¸­çš„ä¸€ä¸ªï¼Œ`L` è¡¨ç¤ºå·¦ä¾§ä¹¦æ¶ï¼Œ`D` è¡¨ç¤ºå³ä¾§ä¹¦æ¶ã€‚

ä¾‹å¦‚:`UZMI L L` è¡¨ç¤ºçš„æ„æ€å°±æ˜¯ä»å·¦ä¾§ä¹¦æ¶é¡¶ä¸Šå–å‡ºä¸€æœ¬ä¹¦æ‹¿åœ¨å·¦æ‰‹ä¸Šã€‚ä½ ä¸éœ€è¦æœ€å°åŒ–ä½ çš„æ“ä½œåºåˆ—é•¿åº¦ $k$ã€‚ä¸è¿‡æ“ä½œåºåˆ—çš„é•¿åº¦ä¸èƒ½è¶…è¿‡ $10^5$ã€‚å¯ä»¥ä¿è¯å­˜åœ¨æ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„æ“ä½œåºåˆ—ã€‚

#### é¢˜ç›®åˆ†æ

ç”±äºæ­¤é¢˜æ²¡è¦æ±‚æœ€å°åŒ–æ“ä½œåºåˆ—é•¿åº¦ $k$ï¼Œå› æ­¤åªéœ€è¦éšä¾¿è¾“å‡ºå¯è¡Œæ–¹æ¡ˆå³å¯ã€‚

æœ€ç®€å•çš„ä¸€ä¸ªæ€è·¯å°±æ˜¯ç°å°†æ‰€æœ‰çš„ä¹¦ç±å…¨éƒ¨è½¬ç§»åˆ°å³ä¹¦æ¡Œä¸Šï¼Œå†åœ¨å³ä¹¦æ¡Œä¸­ä¾æ¬¡å¯»æ‰¾å‰©ä¸‹çš„ä¹¦æœ¬ä¸­æœ€å¤§çš„ä¸€ä¸ªå¹¶å°†å…¶æ”¾ç½®å·¦ä¹¦æ¡Œä¸Šã€‚

è‡³äºå¦‚ä½•æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†æŸä¸€æœ¬å½“å‰çŠ¶æ€ä¸‹æœ€åšçš„ä¹¦ä»¥ä¸Šçš„æ‰€æœ‰ä¹¦ç±å…¨éƒ¨é€šè¿‡æŸä¸€åªæ‰‹æ”¾åˆ°å¦ä¸€ä¸ªä¹¦æ¶ä¸Šï¼Œå†å°†å½“å‰è¿™æœ¬ä¹¦æ‹¿èµ·æ¥ï¼Œå¹¶ç”¨å¦å¤–ä¸€åªæ‰‹å°†åˆšåˆšæˆ‘ä»¬æ‰€æ‹¿åˆ°å¦å¤–ä¸€ä¸ªä¹¦æ¶ä¸Šçš„ä¹¦å…¨éƒ¨æ‹¿å›æ¥ï¼Œå†å°†æ‰‹ä¸Šçš„è¿™æœ¬ä¹¦æ”¾åˆ°å¦å¤–ä¸€ä¸ªä¹¦æ¶ä¸Šã€‚

å¯¹äº $k\leq 10^5$ çš„é™åˆ¶ï¼Œç”±äºæ¯æ¬¡è½¬ç§»æ—¶æ”¾åˆ°å¦å¤–ä¸€ä¸ªä¹¦æ¶ä¸Šçš„ä¹¦çš„æœ¬æ•°ä¸ä¼šè¶…è¿‡ $n$ï¼Œå› æ­¤æ¯æ¬¡æ”¾ä¹¦æ‰€è¦æ‰§è¡Œçš„æ“ä½œæ¬¡æ•°ä¸ä¼šè¶…è¿‡ $4n$ã€‚æ€»æ“ä½œæ¬¡æ•°ä¸ä¼šè¶…è¿‡ $4n^2\leq 4\times 10^4$ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 1010
#define ywhin cin
#define ywhout cout
using namespace std;
van n,d[N],tmp[N],cnt;bool used[N];
struct res 
{
	string op;
	char hand,shelf;
}ans[N*N];
void Output(bool get,bool left_hand,bool left_shelf) {
	cnt++;
	if (get) ans[cnt].op="UZMI";
	else ans[cnt].op="STAVI";
	if (left_hand) ans[cnt].hand='L';
	else ans[cnt].hand='D';
	if (left_shelf) ans[cnt].shelf='L';
	else ans[cnt].shelf='D';
}//æ·»åŠ è¾“å‡º
int main() {
	ywhin>>n;
	for (int i=1;i<=n;i++) {
		ywhin>>d[i];
	}
	memcpy(tmp,d,sizeof tmp);
	sort(tmp+1,tmp+n+1);
	for (int i=1;i<=n;i++) {
		Output(1,1,1);
		Output(0,1,0);
	}//å°†æ‰€æœ‰ä¹¦æ”¾åˆ°å³ä¹¦æ¶ä¸Š
    for (int i=n;i>=1;i--) {
		van ct=n;
		while(ct>=1) {
			if (!used[ct]&&d[ct]==tmp[i]) break;
			ct--;
		}//æŸ¥æ‰¾æœ€åšçš„ä¹¦çš„ä¸Šé¢æœ‰å¤šå°‘æœ¬ä¹¦
		used[ct]=1;
		for (int j=n;j>ct;j--) if (!used[j]) {
			Output(1,1,0);
			Output(0,1,1);
		}//å°†å…¶ä¸Šé¢çš„ä¹¦å…¨éƒ¨æ”¾åˆ°å¦ä¸€ä¸ªä¹¦æ¶ä¸Š
		Output(1,1,0);//æ‹¿èµ·è¿™æœ¬ä¹¦
		for (int j=n;j>ct;j--) if (!used[j]) {
			Output(1,0,1);
			Output(0,0,0);
		}//å°†åˆšåˆšæ‹¿èµ°çš„ä¹¦é€šè¿‡å¦ä¸€åªæ‰‹æ‹¿å›æ¥
		Output(0,1,1);//å°†è¿™æœ¬ä¹¦æ”¾ä¸‹å»
	}
	ywhout<<cnt<<endl;
	for (int i=1;i<=cnt;i++) {
		ywhout<<ans[i].op<<" "<<ans[i].hand<<" "<<ans[i].shelf<<endl;
	}
	return 0;
}
```

### T2 Vlak

#### é¢˜ç›®æè¿°

Nina å’Œ Emilija æ­£åœ¨ç©ä¸€ä¸ªç‰¹æ®Šçš„æ¸¸æˆã€‚è¿™ä¸ªæ¸¸æˆæ˜¯åœ¨ä¸€å¼ æœ€å¼€å§‹ä¸ºç©ºç™½çš„çº¸ä¸Šè¿›è¡Œçš„ã€‚åœ¨æ¯ä¸€ä¸ªäººçš„è¡ŒåŠ¨å›åˆå†…ï¼Œè¿™ä¸ªäººä¼šåœ¨è¿™å¼ çº¸ä¸Šå½“å‰çš„å•è¯åé¢åŠ å…¥ä¸€ä¸ªå­—æ¯ã€‚å¥¹ä»¬ä¼šè½®æµè¡ŒåŠ¨ï¼Œ è€Œ Nina å…ˆæ‰‹è¡ŒåŠ¨ã€‚ 

æ“ä½œè€…å¿…é¡»ä¿è¯è¿™æ ·ä¸€ä¸ªæ¡ä»¶ï¼šåœ¨æ·»åŠ å®Œä¸€ä¸ªå­—ç¬¦åï¼Œæ•´å¼ çº¸ä¸Šçš„å•è¯å¿…é¡»æ˜¯æ“ä½œäººæœ€å–œæ¬¢çš„æ­Œæ›²çš„ä¸€ä¸ªå•è¯çš„å‰ç¼€ã€‚å¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œè¿›è¡Œè¿™ä¸ªæ“ä½œçš„äººå°±è¾“äº†ã€‚

ä½ çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœä¸¤ä¸ªäººéƒ½é‡‡å–æœ€ä¼˜ç­–ç•¥ï¼Œé‚£ä¹ˆè°ä¼šè·å¾—æœ€åçš„èƒœåˆ©ã€‚

#### è¾“å‡ºæè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ­£æ•´æ•° $n$ï¼Œè¡¨ç¤º Nina æœ€å–œæ¬¢çš„æ­Œæ›²å†…çš„å•è¯æ•°ç›®ã€‚

æ¥ä¸‹æ¥çš„ $n$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå³ Nina æœ€å–œæ¬¢çš„æ­Œæ›²å†…çš„ä¸€ä¸ªå•è¯ã€‚

æ¥ä¸‹æ¥çš„ä¸€è¡Œæ˜¯ä¸€ä¸ªæ­£æ•´æ•° $n$ï¼Œè¡¨ç¤º Emilija æœ€å–œæ¬¢çš„æ­Œæ›²çš„å•è¯æ•°ç›®ã€‚ 

æ¥ä¸‹æ¥çš„ $m$ è¡Œï¼Œæ¯è¡ŒåŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå³ Emilija æœ€å–œæ¬¢çš„æ­Œæ›²å†…çš„ä¸€ä¸ªå•è¯ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºè·èƒœè€…çš„åå­—ï¼Œå³ Nina æˆ– Emilijaã€‚

#### é¢˜ç›®åˆ†æ

å¾ˆæ˜æ˜¾çš„ä¸€ä¸ª Trie åŠ åšå¼ˆè®ºã€‚

ç”±äºæ‰€æœ‰å­—æ¯çš„æ€»é•¿åº¦å°äºç­‰äº $2\times 10^5$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰çš„å­—æ¯å…¨éƒ¨æ‰”è¿› Trie æ ‘é‡Œï¼Œå¹¶æ ‡è®°æŸä¸ªå•è¯ç©¶ç«Ÿæ˜¯è°çš„ã€‚

æœ€åä¸€é DFS æ‰«æ Trie æ ‘æ¥åˆ¤æ–­æœ€åç©¶ç«Ÿæ˜¯è°è·èƒœå³å¯ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(\sum_{i=1}^n s_i.size()+\sum_{i=1}^ms_i.size())$ (å®é™…ä¸Šå°±æ˜¯å­—ç¬¦ä¸²çš„æ€»é•¿åº¦)ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
using namespace std;
int n,m,cnt;
struct Trie {
	int son[26];
	bool w[2];
} a[200009];
string s;
void add(string t,bool p) {
	int id=0;
	for(int i=0; i<t.size(); i++) {
		if(a[id].son[t[i]-'a']==0)
			a[id].son[t[i]-'a']=++cnt;
		id=a[id].son[t[i]-'a'];
		a[id].w[p]=1;
	}
}
bool dfs(int x,bool r) {
	Trie now=a[x];
	for(int i=0; i<26; i++) {
		int v=now.son[i];
		if(v==0) continue;
		if(a[v].w[r]&&dfs(v,!r)==r) return r;
	}
	return (!r);
}
int main() {
	scanf("%d",&n);
	for(int i=1; i<=n; i++) {
		cin>>s;
		add(s,1);
	}
	scanf("%d",&m);
	for(int i=1; i<=m; i++) {
		cin>>s;
		add(s,0);
	}
	if(dfs(0,1)) cout<<"Nina";
	else cout<<"Emilija";
	return 0;
}
```

### T3 Sateliti

#### é¢˜ç›®æè¿°

ä¸€ä¸ªç§‘å­¦å›¢é˜Ÿæ­£åœ¨ä½¿ç”¨ç§‘å­¦æœ›è¿œé•œè§‚æµ‹åœŸæ˜Ÿçš„å«æ˜Ÿã€‚ä¸ºæ­¤ï¼Œç§‘å­¦å®¶ä»¬å¿…é¡»å¯¹ä¸åŒå«æ˜Ÿçš„ç…§ç‰‡è¿›è¡Œåˆ†ç±»ã€‚è¿™ä¸ªä»»åŠ¡ç›¸å½“å›°éš¾ï¼Œå› ä¸ºä»ä¸åŒè§’åº¦ä¸Šçœ‹è¿‡å»ï¼Œå«æ˜Ÿçš„é¢è²Œæ˜¯ä¸ä¸€æ ·çš„ã€‚ 

å«æ˜Ÿå›¾ç‰‡å¯ä»¥è¢«çœ‹æˆæ˜¯ä¸€ä¸ª $n\times m$ çš„å­—ç¬¦çŸ©é˜µï¼ŒçŸ©é˜µä¸Šç”±ä¸¤ç§å­—ç¬¦ `*` å’Œ `.` æ„æˆã€‚æˆ‘ä»¬è¯´ä¸¤ä¸ªå›¾ç‰‡è¡¨ç¤ºçš„æ˜¯åŒä¸€ä¸ªå«æ˜Ÿï¼Œè¡¨ç¤ºé€šè¿‡ä¸€äº›**è¡Œåˆ—å¹³ç§»**ï¼Œä¸¤å¼ å›¾ç‰‡ä¼šå˜å¾—å®Œå…¨ç›¸åŒã€‚ 

ä¸ºäº†åŒºåˆ†ä¸åŒçš„å«æ˜Ÿï¼Œç§‘å­¦å®¶æ¯éœ€è¦æ‰¾åˆ°æ¯ä¸€ä¸ªå«æ˜Ÿçš„**å­—å…¸åºæœ€å°**çš„å­—ç¬¦çŸ©é˜µã€‚æ³¨æ„ï¼Œå½“æˆ‘ä»¬æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦çŸ©é˜µçš„å­—å…¸åºçš„æ—¶å€™ï¼Œä½ å¯ä»¥ç†è§£ä¸ºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦çŸ©é˜µ**æŒ‰è¡Œæ‹¼æ¥**èµ·æ¥çš„å­—ç¬¦ä¸²çš„å­—å…¸åºã€‚ä½ çš„ä»»åŠ¡æ˜¯å¯¹äºä¸€ä¸ªç»™å®šçš„å­—ç¬¦çŸ©é˜µï¼Œæ‰¾å‡ºå®ƒç»è¿‡è¡Œåˆ—å¹³ç§»åå­—å…¸åºæœ€å°çš„å½¢å¼ã€‚

#### è¾“å‡ºæè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ­£æ•´æ•° $n,m(q\leq n,m\leq 1000)$ã€‚è¡¨ç¤ºå­—ç¬¦çŸ©é˜µçš„å¤§å°ã€‚

æ¥ä¸‹æ¥çš„ $n$ è¡Œï¼Œæ¯è¡Œä¸€ä¸ªé•¿åº¦ä¸º $m$ çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²ä»…ç”± `*` å’Œ `.`æ„æˆã€‚

#### è¾“å‡ºæè¿°

è¾“å‡º $n$ è¡Œï¼Œæ¯è¡Œ $m$ ä¸ªå­—ç¬¦ï¼Œè¡¨ç¤ºæˆ‘ä»¬éœ€è¦æ‰¾åˆ°çš„å­—å…¸åºæœ€å°çš„å­—ç¬¦çŸ©é˜µã€‚

#### é¢˜ç›®åˆ†æ

ç”±äºæ¶‰åŠåˆ°æ¯”è¾ƒå­—å…¸åºï¼Œè€ƒè™‘ä½¿ç”¨äºŒç»´å“ˆå¸Œç®—æ³•ã€‚

è®¾ $hash(c_{i,j})=p^i\times q^j\times c_{i,j}$ï¼Œåˆ™ä¸€ä¸ªäºŒç»´çŸ©é˜µçš„å“ˆå¸Œå€¼å¯ä»¥ç”¨è¿™ä¸ªçŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦çš„å“ˆå¸Œå€¼ä¹‹å’Œæ¥è¡¨ç¤ºã€‚è‡³äºå¦‚ä½•æ±‚å‡ºæŸä¸€çŸ©é˜µä¸­æ¯ä¸€ä¸ªå­—ç¬¦çš„å“ˆå¸Œå€¼ä¹‹å’Œï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨äºŒç»´å‰ç¼€å’Œã€‚è®¾ $sum_{i,j}$ ä¸ºä»¥ $(1,1)$ ä¸ºèµ·å§‹ç‚¹çš„é•¿ä¸º $i$ï¼Œå®½ä¸º $j$ çš„çŸ©é˜µä¸­æ‰€æœ‰å­—ç¬¦çš„å“ˆå¸Œå€¼ä¹‹å’Œã€‚åˆ™ä¸€ä¸ªèµ·ç‚¹ä¸º $(x,y)$ ä¸”é•¿ä¸º $l$ï¼Œå®½ä¸º $w$ çš„çŸ©é˜µå“ˆå¸Œä¸º $sum_{x+l-1,y+j-1}-sum_{x-1,y+j-1}-sum_{x+i-1,y-1}+sum_{x-1,y-1}$ã€‚

æ¥ä¸‹æ¥ä¸¤ä¸ªäºŒåˆ†æŸ¥æ‰¾å°±å¯ä»¥ç¡®å®šä¸¤ä¸ªçŸ©é˜µçš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚å…ˆå°†ä¸¤ä¸ªçŸ©é˜µç§»åŠ¨åˆ°ç›¸åŒçš„ä½ç½®ï¼Œå°†æ•´ä¸ªçŸ©é˜µä¹˜ä¸Š $p^i\times q^j$ å³å¯ã€‚å†æ¯”è¾ƒä¸¤ä¸ªçŸ©é˜µæœ€å¤šæœ‰å¤šå°‘è¡Œæ˜¯ç›¸ç­‰çš„ï¼Œæœ€åæ¯”è¾ƒä¸¤ä¸ªçŸ©é˜µçš„ä¸‹ä¸€è¡Œæœ‰å¤šä¸Šä¸ªå­—ç¬¦æ˜¯ç›¸ç­‰çš„ã€‚

æ‰§è¡Œå®Œä»¥ä¸Šæ“ä½œä¹‹åï¼Œæ¯”è¾ƒä¸‹ä¸€ä½çš„å­—ç¬¦ï¼Œæ›´å°çš„ä»£è¡¨è¯¥çŸ©é˜µçš„å­—å…¸åºæœ€å°ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2\log_2 n)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 3010
#define ywhin cin
#define ywhout cout
using namespace std;
const van p=131,q=133;
char ch[N][N];
van n,m,sx=1,sy=1;
unsigned van hash[N][N],sum[N][N];
unsigned van power(van a,van b) {
	unsigned van ans=1,base=a;
	while (b>0){
		if (b%2==1) ans*=base;
		base*=base,b>>=1; 
	}
	return ans;
}//è®¡ç®—ä¹˜æ–¹
unsigned van HashCalc(van i,van j) {
	return power(p,i)*power(q,j)*ch[i][j];
}//è®¡ç®—å•ç‚¹å“ˆå¸Œ
void init() {
	for (int i=1;i<=n*2;i++) {
		for (int j=1;j<=m*2;j++) {
			sum[i][j]=sum[i][j-1]+sum[i-1][j]-sum[i-1][j-1]+hash[i][j];
		}
	}
}//è®¡ç®—äºŒç»´å‰ç¼€å’Œ
unsigned van Calc_Matrix(van sx,van sy,van height,van width) {
	van ex=sx+height-1,ey=sy+width-1;sx--,sy--;
	return sum[ex][ey]-sum[sx][ey]-sum[ex][sy]+sum[sx][sy];
}//æŸ¥è¯¢çŸ©é˜µå“ˆå¸Œ
//ifstream ywhin("sateliti.in");
//ofstream ywhout("sateliti.out");
int main() {
	ywhin>>n>>m;
	for (int i=1;i<=n;i++) {
		for (int j=1;j<=m;j++) {
			ywhin>>ch[i][j];
			ch[i][j+m]=ch[i+n][j]=ch[i+n][j+m]=ch[i][j];
		}
	}//å¼€ä¸ªå››å€æ•°ç»„
	for (int i=1;i<=n*2;i++) {
		for (int j=1;j<=m*2;j++) {
//			cout<<power(2,2)<<endl;
			hash[i][j]=HashCalc(i,j);
		}
	}//è®¡ç®—å•ç‚¹å“ˆå¸Œ
	init();
	for (int i=1;i<=n;i++) {
		for (int j=1;j<=m;j++) {
			if (i!=1||j!=1) {
				unsigned van base1=power(p,sx-i)*power(q,sy-j),
							 base2=power(p,i-sx)*power(q,j-sy);//ç§»ä½
				van l=1,r=n,tmp=0;
				while(l<=r) {
					van mid=l+r>>1;
					unsigned van matrix1=Calc_Matrix(i,j,mid,m)*base1,
								 matrix2=Calc_Matrix(sx,sy,mid,m)*base2;
					if (matrix1==matrix2) {
						tmp=mid;l=mid+1;
					}
					else r=mid-1;
				}//è®¡ç®—æœ€å¤šæœ‰å¤šå°‘è¡Œæ˜¯ç›¸ç­‰çš„
//				cout<<i<<" "<<j<<" "<<sx<<" "<<sy<<" "<<tmp<<endl;
				l=1,r=m;van tmp2=0;
				while (l<=r) {
					van mid=l+r>>1;
					unsigned van matrix1=Calc_Matrix(i+tmp,j,1,mid)*base1,
								 matrix2=Calc_Matrix(sx+tmp,sy,1,mid)*base2;
					if (matrix1==matrix2) {
						tmp2=mid,l=mid+1;
					}
					else r=mid-1;
				}//è®¡ç®—ä¸‹ä¸€è¡Œæœ‰å¤šå°‘ä¸ªç›¸ç­‰çš„è¿ç»­çš„å­—ç¬¦
				if (ch[i+tmp][j+tmp2]<ch[sx+tmp][sy+tmp2]) sx=i,sy=j;//æ¯”è¾ƒä¸Šè¿°ç»“æœçš„ä¸‹ä¸€ä½çš„å­—ç¬¦
//				cout<<i<<" "<<j<<" "<<sx<<" "<<sy<<endl;
			}
		}
	}
	for (int i=1;i<=n;i++) {
		for (int j=1;j<=m;j++) {
			ywhout<<ch[i+sx-1][j+sy-1];
		}
		ywhout<<endl;
	}
	return 0;
}
```

### T4 Selotejp

#### é¢˜ç›®æè¿°

M å…ˆç”Ÿçš„æ‰‹ä¸­æœ‰ä¸€ä¸ªå¤§å°ä¸º $n\times m$ çš„æ£‹ç›˜ï¼Œæ¯ä¸€ä¸ªæ£‹ç›˜çš„æ ¼å­å¤§å°éƒ½æ˜¯ $1\times 1$ã€‚ä¸å¹¸çš„æ˜¯ï¼Œæœ‰ä¸€äº›æ ¼å­å·²ç»å¼„è„äº†ï¼Œéœ€è¦é‡æ–°ç²‰åˆ·ã€‚

ä¸€æ¬¡ç²‰åˆ·å¯ä»¥ç²‰åˆ·åŒä¸€è¡Œæˆ–è€…åŒä¸€åˆ—çš„æŸä¸€äº›æ ¼å­ã€‚ä½†æ˜¯ M å…ˆç”Ÿä¸å…è®¸ç²‰åˆ·åˆ°ä¸éœ€è¦ç²‰åˆ·çš„æ ¼å­ã€‚ä½ çš„ä»»åŠ¡æ˜¯ï¼Œæ±‚å‡ºæœ€å°‘éœ€è¦ç²‰åˆ·å¤šå°‘æ¬¡ï¼Œæ‰èƒ½å¤ŸæŠŠæ£‹ç›˜ä¸Šçš„è„æ ¼å­å…¨éƒ¨ç²‰åˆ·ä¸€éã€‚

#### è¾“å‡ºæè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ•´æ•° $n,m(1\leq n\leq 1000,1\leq m\leq 10)$ï¼Œè¡¨ç¤ºæ£‹ç›˜çš„å¤§å°ã€‚ 

æ¥ä¸‹æ¥çš„ $n$ è¡Œï¼Œæ¯è¡Œä¸€ä¸ªé•¿åº¦ä¸º $m$ çš„å­—ç¬¦ä¸²ã€‚åªç”±å­—ç¬¦ `.` å’Œ `#` ç»„æˆã€‚å­—ç¬¦ `.` è¡¨ç¤ºè¿™ä¸ªæ ¼å­æ˜¯å¹²å‡€çš„ï¼Œå­—ç¬¦ `#` è¡¨ç¤ºè¿™ä¸ªæ ¼å­æ˜¯è„çš„ï¼Œéœ€è¦ç²‰åˆ·ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºä¸€è¡Œï¼Œä¸€ä¸ªæ•´æ•°ï¼Œæœ€å°‘ç²‰åˆ·æ¬¡æ•°ã€‚

#### é¢˜ç›®åˆ†æ

##### 50Pts

ç”±äº $m\leq 10$ï¼Œå¾ˆè‡ªç„¶è€Œç„¶åœ°å°±ä¼šæƒ³åˆ°æ—¶é—´å¤æ‚åº¦ä¼šå‡ºç°ä¸€ä¸ª $2^m$ã€‚

è€ƒè™‘ä½¿ç”¨çŠ¶å‹ DPï¼Œè®¾ $f[x][k]$ ä¸ºæœç´¢åˆ° $x$ è¡Œä¸”å½“å‰è¡Œçš„çŠ¶æ€ä¸º $k$ æ—¶éœ€è¦çš„æœ€å°ç²‰åˆ·æ­¥æ•°ã€‚

æšä¸¾ä¸Šä¸€æ¬¡çš„çŠ¶æ€ä¸å½“å‰è¡Œçš„çŠ¶æ€ï¼Œåˆ¤æ–­å¯è¡Œæ€§åå†è¿›è¡Œæ­¥æ•°çš„è½¬ç§»ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n\times 2^{2m})$ (æ®è¯´ä¼˜åŒ–ä¸€ä¸‹è¿˜å¯ä»¥æ‹¿åˆ°æ»¡åˆ†)ã€‚

##### 100Pts

åœ¨å®Œæˆ Subtask1 çš„åŸºç¡€ä¸Šç»§ç»­å®Œæˆæ­¤é¢˜ã€‚è€ƒè™‘ä½¿ç”¨è½®å»“çº¿ DPï¼Œè®°å½• $f[i][j][k]$ ä¸ºæšä¸¾åˆ°ç¬¬ $i$ è¡Œ $j$ åˆ—ä¸”å‰ $m$ ä¸ªæ ¼å­çŠ¶æ€ä¸º $k$ æ—¶éœ€è¦ç”¨åˆ°çš„æœ€å°æ­¥æ•°ã€‚

è®¾ $ch[i][j]$ ä¸ºè¾“å…¥æ•°ç»„ï¼Œ$(ii,jj)$ ä¸ºæ‰€è¦è½¬ç§»åˆ°çš„ä¸‹ä¸€ä¸ªç‚¹çš„å·¦è¾¹ã€‚åˆ†ä¸¤ç§æƒ…å†µè¿›è¡ŒçŠ¶æ€è½¬ç§»ï¼š

1.å½“ `ch[i][j]='.'` æ—¶ï¼Œ`f[i][j][k]` å¯ä»¥ç›´æ¥è½¬ç§»åˆ° `f[ii][jj][k>>1]`ã€‚

2.å½“ `ch[i][j]='#'` æ—¶ï¼Œ`f[i][j][k]` å¯ä»¥è½¬ç§»åˆ° `f[ii][jj][(k>>1)+(1<<m-1)]`ï¼Œä¸”å½“ `k&(1<<(m-1))&&j>1` ä¸æˆç«‹æ—¶æ­¥æ•°éœ€è¦åŠ ä¸€ã€‚åœ¨æ­¤çŠ¶æ€ä¸‹ï¼Œ`f[i][j][k]` è¿˜å¯ä»¥è½¬ç§»åˆ° `f[ii][jj][k>>1]`ï¼Œä¸”å½“ `((k&1)==0&&i>1&&ch[i-1][j]=='#')` ä¸æˆç«‹æ—¶æ­¥æ•°éœ€è¦åŠ ä¸€ã€‚

æœ€åè¾“å‡º `f[n+1][1]` çŠ¶æ€ä¸‹çš„æœ€å¤§å€¼å³å¯ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(nm\times 2^m)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 1010
#define ywhin cin
#define ywhout cout
using namespace std;
van f[N][11][1<<11];
char ch[N][11];
van n,m;
int main(){
	memset(f,(1<<6)-1,sizeof f);
	ywhin>>n>>m;
	for (int i=1;i<=n;i++) {
		for (int j=1;j<=m;j++) {
			ywhin>>ch[i][j];
		}
	}
	f[1][1][0]=0;
	for (int i=1;i<=n;i++) {
		for (int j=1;j<=m;j++) {
			for (int k=0;k<(1<<m);k++) {
				van ii=i,jj=j+1;
				if (jj>m) jj-=m,ii++;//ä¸‹ä¸€ä¸ªç‚¹çš„åæ ‡
				if (ch[i][j]=='.') {
					f[ii][jj][k>>1]=min(f[ii][jj][k>>1],f[i][j][k]);
				}//ç¬¬ä¸€ç§æƒ…å†µ
				else {
					f[ii][jj][(k>>1)+(1<<(m-1))]=min(f[ii][jj][(k>>1)+(1<<(m-1))],f[i][j][k]+!(k&(1<<(m-1))&&j>1));
					f[ii][jj][k>>1]=min(f[ii][jj][k>>1],f[i][j][k]+!((k&1)==0&&i>1&&ch[i-1][j]=='#'));
				}//ç¬¬äºŒç§æƒ…å†µ
			}
		}
	}
	van ans=1e18;
	for (int i=0;i<(1<<m);i++) ans=min(ans,f[n+1][1][i]);//æŸ¥æ‰¾æœ€ç»ˆçŠ¶æ€ä¸‹çš„æœ€å¤§å€¼
	ywhout<<ans<<endl;
	return 0;
}
```

### T5 Specijacija

#### é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ­£æ•´æ•°åºåˆ— $a_1,a_1,...,a_n$ã€‚å…¶ä¸­ $\frac{i(i-1)}{2}<a_i\leq \frac{i(i+1)}{2}$ ã€‚ 

è¿™ä¸ªåºåˆ—ä¼šç”Ÿæˆä¸€ä¸ªåŒ…å« $\frac{(n+1)(n+2)}{2}$ ä¸ªèŠ‚ç‚¹çš„æ ‘ã€‚æ ‘é«˜ä¸º $n+1$ã€‚æ¯”å¦‚ï¼Œåºåˆ— (1,2,6) å°±ä¼šç”Ÿæˆ ä¸‹é¢è¿™æ£µæ ‘ï¼š 

![image-20210827145513885](./T5-é¢˜ç›®æè¿°-1.jpg)

æ ‘çš„ç¬¬ $i$ å±‚åŒ…å«äº†èŠ‚ç‚¹ $\frac{i(i-1)}{2}+1,...,\frac{i(i+1)}{2}$ ã€‚åœ¨è¿™ä¸€å±‚ä¸­ï¼Œåªæœ‰èŠ‚ç‚¹ $a_i$ ç”±ä¸¤ä¸ªå­©å­ï¼Œå…¶ä»–çš„èŠ‚ç‚¹éƒ½åªæœ‰ä¸€ä¸ªå­©å­ã€‚

ä½ çš„é—®é¢˜æ˜¯å›ç­” $q$ ä¸ªè¯¢é—®ï¼Œæ¯ä¸€ä¸ªè¯¢é—®ä¼šè¯¢é—®ä½ èŠ‚ç‚¹ $x,y$ çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸‰ä¸ªæ­£æ•´æ•° $n,q,t(1\leq n,q\leq 2\times 10^5,t\in {0,1})$ã€‚åˆ†åˆ«è¡¨ç¤ºç”Ÿæˆæ ‘çš„åºåˆ—çš„é•¿åº¦ï¼ŒæŸ¥è¯¢çš„æ•°ç›®ä»¥åŠæ˜¯å¦å¼ºåˆ¶åœ¨çº¿ã€‚ 

è¾“å…¥çš„ç¬¬äºŒè¡Œæ˜¯ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°ç»„ $a_i(\frac{i(i-1)}{2}<a_i\frac{i(i+1)}{2})$ã€‚è¿™å°±æ˜¯ç”Ÿæˆæ ‘çš„æ•°ç»„ã€‚æ¥ä¸‹æ¥çš„ $n$ è¡Œï¼Œæ¯è¡Œä¸¤ä¸ªæ­£æ•´æ•° $\tilde{x},\tilde{y}(1\leq \tilde{x_i},\tilde{y_i}\leq \frac{i(i+1)}{2})$ã€‚è¿™ä¸¤ä¸ªæ•°ä¼šå†³å®šæœ€ç»ˆè¯¢é—®çš„ $x,y$ã€‚ æˆ‘ä»¬ä»¤ $z_i$ è¡¨ç¤ºç¬¬ $i$ ä¸ªè¯¢é—®æ“ä½œçš„ç­”æ¡ˆï¼Œå¹¶ä»¤ $z_0=0$ã€‚$x_i$ å’Œ $y_i$ å¯ä»¥ç”¨å¦‚ä¸‹æ–¹æ³•æ±‚å‡º:
$$
x_i=((\tilde{x_i}-1+t\times z_{i-1})\ mod\ \frac{(n+1)
(n+2)}{2})+1\\
y_i=((\tilde{y_i}-1+t\times z_{i-1})\ mod\ \frac{(n+1)(n+2)}{2})+1
$$
$mod$ è¡¨ç¤ºæ•´æ•°å–æ¨¡è¿ç®—ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœ $t=0$ï¼Œé‚£ä¹ˆå°±æœ‰ $x_i=\tilde{x_i}$ è€Œ $y_i=\tilde{y_i}$ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡º $q$ è¡Œï¼Œæ¯è¡Œä¸€ä¸ªæ­£æ•´æ•°ï¼Œå³ $x,y$ çš„æœ€è¿‘å…¬å…±ç¥–å…ˆçš„ç¼–å·ã€‚

#### é¢˜ç›®åˆ†æ

##### 20Pts

ç›´æ¥å»ºå‡ºä¸€æ£µæ ‘ç„¶åè·‘ä¸ª LCA å°±è¡Œäº†ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(q\log_2n)$ï¼Œä½† $n\leq 1000$ã€‚

##### 100Pts

æ³¨æ„ï¼šæ­¤æ–¹æ³•æƒ¨é­å¡å¸¸ï¼Œåœ¨è¿æ°”å¥½çš„æƒ…å†µä¸‹å¯ä»¥æ‹¿åˆ°æ»¡åˆ†ã€‚

ç”±äºéœ€è¦æ”¯æŒåœ¨çº¿æŸ¥è¯¢ï¼Œä¸” $n\leq 2\times 10^5$ï¼Œç›´æ¥å»ºæ ‘ç©ºé—´ä¸€å®šä¼šç‚¸ï¼Œè€ƒè™‘ä½¿ç”¨å¯æŒä¹…åŒ–çº¿æ®µæ ‘æ¥å»ºæ ‘ã€‚

æˆ‘ä»¬éœ€è¦å»ºä¸¤é¢—ä¸»å¸­æ ‘ï¼Œä¸€é¢—ç”¨æ¥ç»´æŠ¤å»ºåˆ°å½“å‰æ·±åº¦æ—¶è¿˜æœ‰å“ªäº›ç‚¹æ²¡æœ‰è¢«ä½¿ç”¨è¿‡ï¼Œä¸€é¢—ç”¨æ¥ç»´æŠ¤åº”è¯¥æ¥åœ¨å“ªä¸€ä¸ªèŠ‚ç‚¹ä¸Šã€‚

æ¯ä¸€æ¬¡è¾“å…¥ä¸€ä¸ª $a[i]$ æ—¶ï¼Œè®¡ç®— $a[i]$ æ‰€åœ¨çš„è¡Œ $x$ ä¸åˆ— $y$ï¼Œåœ¨ç¬¬ä¸€é¢—ä¸»å¸­æ ‘ä¸­äºŒåˆ†æŸ¥è¯¢ç¬¬ $y$ ä¸ªæ²¡æœ‰è¢«ä½¿ç”¨çš„ç‚¹ $k$ï¼Œå°†è¿™ä¸ªç‚¹åŠ å…¥æˆ‘ä»¬æ–°å»ºçš„ä¸€ä¸ªèŠ‚ç‚¹ $node[cnt]$ ä¸­ã€‚å¹¶å°†å…¶ä¸ç¬¬äºŒé¢—ä¸»å¸­æ ‘ä¸Šç¬¬ $k$ ä¸ $k+1$ ä¸ªç‚¹è¿è¾¹ï¼Œå°†ç¬¬ä¸€é¢—ä¸»å¸­æ ‘çš„ç¬¬ $k+1$ ä¸ªèŠ‚ç‚¹èµ‹å€¼ä¸º 0ã€‚

æ¥ç€åœ¨èŠ‚ç‚¹æ•°ç»„ $node$ ä¸Šè·‘ä¸€éæ­£å¸¸çš„ DFSï¼Œè®¡ç®—å‡ºå…¶æ ‘çŠ¶ç»“æ„ä¸‹çš„æ·±åº¦ä¸å®ƒä¸Šå‡ $2^0$ çš„æ·±åº¦åçš„èŠ‚ç‚¹ï¼Œå†é€šè¿‡é€’æ¨è®¡ç®—å‡ºæŸä¸€ä¸ªèŠ‚ç‚¹ä¸Šå‡ $2^z$ çš„æ·±åº¦åçš„èŠ‚ç‚¹ã€‚

æ¥ä¸‹æ¥çš„æŸ¥è¯¢æ“ä½œï¼Œå…ˆå°†ä¸¤ä¸ªæ•° $x$ ä¸ $y$ è§£å¯†å‡ºæ¥ï¼Œè®¡ç®—å‡º $x$ ä¸ $y$ æ‰€åœ¨çš„è¡Œ $f_x,f_y$ ä¸åˆ— $g_x,g_y$ï¼Œå†åœ¨ç¬¬äºŒé¢—ä¸»å¸­æ ‘ä¸­æŸ¥è¯¢å½“å…¶å»ºæ ‘æ·±åº¦ä¸º $f_x,f_y$ æ—¶å¯¹åº”çš„èŠ‚ç‚¹ $x',y'$ã€‚å¹¶ä»è¿™ä¸ªèŠ‚ç‚¹å¼€å§‹åœ¨æ‰€æœ‰ $node$ èŠ‚ç‚¹æ‰€æ„æˆçš„æ ‘ä¸Šè¿›è¡Œæ­£å¸¸çš„ LCAã€‚è‹¥å‘ç°è¿™ä¸¤ä¸ªåœ¨åŒä¸€æ¡é“¾ä¸Šï¼Œåˆ™ç›´æ¥è¾“å‡ºè¡Œæ•°è¾ƒä½çš„é‚£ä¸€ä¸ªï¼Œå¦åˆ™è¾“å‡º $x',y'$ çš„æœ€è¿‘å…¬å…±ç¥–å…ˆçš„çœŸå®ç¼–å·ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n\log_2^2n)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
using namespace std;
const van k=21,N=4e5+5;
struct node {
	van ls,rs;
	van num;
};
van up[N][k],n,a[N],RealNum[N<<2],cnt;
van root[N],cnt2,root2[N],cnt3;
node tree[N<<5],tree2[N<<5];
vector<van> g[N];van deep[N],q,t;
van Calc(van x) {
	return x*(x-1)/2;
}
pair<van,van> GetPos(van num) {
	van l=1,r=n+1,ans;
	while (l<=r) {
		van mid=l+r>>1;
		if (Calc(mid)<num) ans=mid,l=mid+1;
		else r=mid-1;
	}
	return make_pair(ans,num-Calc(ans));
}//ç”±æŸä¸€ä¸ªæ•°è·å–åˆ°å…¶æ‰€åœ¨çš„è¡Œä¸åˆ—
van BuildTree(van l,van r) {
	van now=++cnt2;
	if (l==r) {
		++cnt;RealNum[cnt]=Calc(n+1)+l;
		tree[now].num=cnt;
		return now;
	}
	van mid=l+r>>1;
	tree[now].ls=BuildTree(l,mid);
	tree[now].rs=BuildTree(mid+1,r);
	return now;
}//å»ºç«‹ç¬¬ä¸€é¢—ä¸»å¸­æ ‘(åŠä¸Šæ–‡æ‰€æåˆ°çš„ç¬¬äºŒé¢—ä¸»å¸­æ ‘)
van ChangeTree(van p,van l,van r,van where,van num) {
	van now=++cnt2;
	tree[now]=tree[p];
	if (l==r) {
		++cnt;RealNum[cnt]=num;
		tree[now].num=cnt;
		return now;
	}
	van mid=l+r>>1;
	if (where<=mid) tree[now].ls=ChangeTree(tree[p].ls,l,mid,where,num);
	else tree[now].rs=ChangeTree(tree[p].rs,mid+1,r,where,num);
	return now;
}//å•ç‚¹ä¿®æ”¹ä¸»å¸­æ ‘ä¸ŠæŸä¸€èŠ‚ç‚¹çš„å€¼
van QueryTree(van p,van l,van r,van num) {
	if (l==r) return tree[p].num;
	van mid=l+r>>1;
	if (num<=mid) return QueryTree(tree[p].ls,l,mid,num);
	else return QueryTree(tree[p].rs,mid+1,r,num);
}//å•ç‚¹æŸ¥è¯¢ä¸»å¸­æ ‘ä¸ŠæŸä¸€èŠ‚ç‚¹çš„å€¼
van BuildTree2(van l,van r) {
	van now=++cnt3;
	if (l==r) {
		tree2[now].num=1;
		return now;
	}
	van mid=l+r>>1;
	tree2[now].ls=BuildTree2(l,mid);
	tree2[now].rs=BuildTree2(mid+1,r);
	tree2[now].num=tree2[tree2[now].ls].num+tree2[tree2[now].rs].num;
	return now;
}//å»ºç«‹ç¬¬äºŒé¢—ä¸»å¸­æ ‘(åŠä¸Šæ–‡æ‰€æåˆ°çš„ç¬¬ä¸€é¢—ä¸»å¸­æ ‘)
van ChangeTree2(van p,van l,van r,van where,van num) {
	van now=++cnt3;
	tree2[now]=tree2[p];
	if (l==r) {
		tree2[now].num=num;
		return now;
	}
	van mid=l+r>>1;
	if (where<=mid) tree2[now].ls=ChangeTree2(tree2[p].ls,l,mid,where,num);
	else tree2[now].rs=ChangeTree2(tree2[p].rs,mid+1,r,where,num);
	tree2[now].num=tree2[tree2[now].ls].num+tree2[tree2[now].rs].num;
	return now;
}//å•ç‚¹ä¿®æ”¹ç¬¬äºŒé¢—ä¸»å¸­æ ‘çš„å€¼
van QueryTree2(van p,van l,van r,van L,van R) {
	if (L<=l&&r<=R) {
		return tree2[p].num;
	}
	van mid=l+r>>1,sum=0;
	if (L<=mid) sum+=QueryTree2(tree2[p].ls,l,mid,L,R);
	if (R>mid) sum+=QueryTree2(tree2[p].rs,mid+1,r,L,R);
	return sum;
}//åŒºé—´æŸ¥è¯¢ç¬¬äºŒé¢—ä¸»å¸­æ ‘ä¸ŠæŸä¸€äº›èŠ‚ç‚¹çš„å€¼çš„å’Œ
void AddLine(van father,van son) {
	g[father].push_back(son);
	g[son].push_back(father);
}//æ–°å»ºä¸€æ¡è¾¹
void initDFS(van now,van f) {
	for (int i=0;i<g[now].size();i++) {
		if (g[now][i]!=f) {
			deep[g[now][i]]=deep[now]+1;
			up[g[now][i]][0]=now;
			initDFS(g[now][i],now);
		}
	}
}//é¢„å¤„ç†èŠ‚ç‚¹æ·±åº¦ä¸up[i][0]æ•°ç»„
void initLCA() {
	deep[cnt]=1;
	initDFS(cnt,0);
	for (int j=1;j<k;j++) {
		for (int i=1;i<=cnt;i++) {
			up[i][j]=up[up[i][j-1]][j-1];
		}
	}
}//é€’æ¨å¤„ç†upæ•°ç»„
van GetDeep(van num) {
	return GetPos(num).first;
}
van LCA(van a,van b,van a1,van b1) {
	if (deep[a1]<deep[b1]) swap(a1,b1),swap(a,b);
	for (int i=k-1;i>=0;i--) {
		if (deep[up[a1][i]]>=deep[b1]) {
			a1=up[a1][i];
		}
	}
	if (a1==b1) {
		return (GetDeep(a)<GetDeep(b)?a:b);
	}
	for (int i=k-1;i>=0;i--) {
		if (up[a1][i]!=up[b1][i]) {
			a1=up[a1][i],b1=up[b1][i];
		}
	}
	return RealNum[up[a1][0]];
} //æ­£å¸¸çš„LCA(ä½†ç›´æ¥è¿”å›æœ€ç»ˆç»“æœ)
inline van read() {
    van x=0,f=1;
    char ch=getchar();
    while(ch<'0'||ch>'9'){
        if(ch=='-')
            f=-1;
        ch=getchar();
    }
    while(ch>='0'&&ch<='9'){
        x=(x<<1)+(x<<3)+(ch^48);
        ch=getchar();
    }
    return x*f;
}//å¿«è¯»
inline void write(van x) {
    char F[200];
    van tmp=x>0?x:-x ;
    if(x<0)putchar('-') ;
    van cnt=0 ;
    while(tmp>0)
    {
    	F[cnt++]=tmp%10+'0';
        tmp/=10;
    }
    while(cnt>0)putchar(F[--cnt]) ;
    putchar('\n');
}//å¿«è¾“
int main() {
	n=read(),q=read(),t=read();
	for (int i=1;i<=n;i++) {
		a[i]=read();
	}
	root[n+1]=BuildTree(1,n+1);
	root2[n+1]=BuildTree2(1,n+1);//å»ºæ ‘
	for (int i=n;i>=1;i--) {
		pair<van,van> pos=GetPos(a[i]);
		van l=1,r=n+1,tmp1,tmp2;
		while (l<=r) {
			van mid=l+r>>1;
			if (QueryTree2(root2[i+1],1,n+1,1,mid)>=pos.second) {
				tmp1=mid;r=mid-1;
			} 
			else l=mid+1;
		}//æŸ¥æ‰¾åº”è¯¥æ¥åœ¨å“ªä¸€åˆ—
		l=1,r=n+1;
		while (l<=r) {
			van mid=l+r>>1;
			if (QueryTree2(root2[i+1],1,n+1,1,mid)>=pos.second+1) {
				tmp2=mid,r=mid-1;
			}
			else l=mid+1;
		}//æŸ¥æ‰¾ä¸‹ä¸€ä¸ªæœ‰å€¼çš„åˆ—
		van son1=QueryTree(root[i+1],1,n+1,tmp1),
			son2=QueryTree(root[i+1],1,n+1,tmp2);
		root[i]=ChangeTree(root[i+1],1,n+1,tmp1,a[i]);
		van now=QueryTree(root[i],1,n+1,tmp1);
		AddLine(now,son1);AddLine(now,son2);//å»ºè¾¹
		root2[i]=ChangeTree2(root2[i+1],1,n+1,tmp1,1);
		root2[i]=ChangeTree2(root2[i],1,n+1,tmp2,0);//ä¿®æ”¹ç¬¬äºŒé¢—ä¸»å¸­æ ‘æŸä¸€èŠ‚ç‚¹çš„è¾¹æƒ
	} 
	initLCA();
	van z=0;
	while (q--) {
		van x,y;
		x=read(),y=read();
		if (t) {
			x=(x-1+t*z)%Calc(n+2)+1;
			y=(y-1+t*z)%Calc(n+2)+1;
		}//è§£å¯†x&y
		pair<van,van> posx=GetPos(x),posy=GetPos(y);
		van l=1,r=n+1,tmp1,tmp2;
		while (l<=r) {
			van mid=l+r>>1;
			if (QueryTree2(root2[posx.first],1,n+1,1,mid)>=posx.second) {
				tmp1=mid,r=mid-1;
			}
			else l=mid+1;
		}
		l=1,r=n+1;
		while (l<=r) {
			van mid=l+r>>1;
			if (QueryTree2(root2[posy.first],1,n+1,1,mid)>=posy.second) {
				tmp2=mid,r=mid-1;
			}
			else l=mid+1;
		}//äºŒåˆ†æŸ¥è¯¢x&yèŠ‚ç‚¹åœ¨æŸä¸€çŠ¶æ€ä¸‹æ‰€åœ¨çš„åˆ—
		van x1=QueryTree(root[posx.first],1,n+1,tmp1),
			y1=QueryTree(root[posy.first],1,n+1,tmp2);
		z=LCA(x,y,x1,y1);
		write(z);
	}
}
```

## COCI2020-2021 #4

### T1 Pizza

#### é¢˜ç›®æè¿°

åœ¨ä¸€æ•´å¤©çš„æ¼«é•¿å·¥ä½œä¹‹åï¼ŒMå…ˆç”Ÿå†³å®šæ™šé¥­åƒä¸€é¡¿æŠ«è¨æ¥çŠ’åŠ³ä¸€ä¸‹è‡ªå·±ã€‚åœ¨æ¡Œä¸Šå †ç§¯å¦‚å±±çš„æ–‡ä»¶å†…ï¼Œä»–æ‰¾åˆ°äº†é™„è¿‘ä¸€å®¶æŠ«è¨é¤å…çš„ä¸€å¼ ä¼ å•ã€‚ 

é¤å…å†…æä¾› $m$ ç§ä¸åŒçš„æŠ«è¨ï¼Œæ¯ç§æŠ«è¨æœ‰ä¸åŒçš„æµ‡æ–™ï¼Œè¿™äº›æµ‡æ–™ç”¨æ­£æ•´æ•°ç¼–å·æ¥è¡¨ç¤ºï¼Œç¬¬ğ‘–ç§æŠ«è¨æœ‰ $k_i$ ç§æµ‡æ–™ï¼Œç¼–å·åˆ†åˆ«ä¸º $b_{i,1},b_{i,2},...,b_{i,k_i}$ã€‚ 

Må…ˆç”Ÿå¯¹äºåƒä¸œè¥¿æ—¶éå¸¸æŒ‘å‰”çš„ï¼Œåœ¨æ‰€æœ‰çš„è¿™äº›æµ‡æ–™ä¸­ï¼Œæœ‰ $n$ ç§æµ‡æ–™æ˜¯Må…ˆç”Ÿå®Œå…¨ä¸æƒ³æ¥è§¦çš„ï¼Œä»–ä»¬çš„ç¼–å·åˆ†åˆ«æ˜¯ $a_1,a_2,...,a_n$ã€‚å› æ­¤ï¼Œä»–å¸Œæœ›ç‚¹çš„æŠ«è¨æ˜¯é‚£äº›å®Œå…¨ä¸åŒ…æ‹¬è¿™ $n$ ç§æµ‡æ–™çš„æŠ«è¨ï¼Œä½ çš„ä»»åŠ¡æ˜¯å¸®ä»–æ‰¾å‡ºï¼Œ**æœ‰å¤šå°‘ç§æŠ«è¨æ˜¯Må…ˆç”Ÿå¯ä»¥ç‚¹çš„**ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡Œæœ€å¼€å§‹æ˜¯ä¸€ä¸ªæ­£æ•´æ•° $n(1\leq n\leq 100)$ã€‚æ¥ä¸‹æ¥æœ‰ $n$ ä¸ªäº’ä¸ç›¸åŒçš„æ•´æ•° $a_i(1\leq a_i\leq 100)$ï¼Œè¡¨ç¤ºMå…ˆç”Ÿä¸å–œæ¬¢çš„æµ‡æ–™çš„ç¼–å·ã€‚

æ¥ä¸‹æ¥çš„ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•° $m(1\leq m\leq 100)$ï¼Œè¡¨ç¤ºæŠ«è¨çš„ç§ç±»æ•°ç›®ã€‚ 

æ¥ä¸‹æ¥çš„ $m$ è¡Œï¼Œæ¯è¡Œæè¿°ä¸€ç§æŠ«è¨ï¼Œæœ€å¼€å§‹æ˜¯ä¸€ä¸ªæ•´æ•° $k_i(1\leq k_i\leq 100)$ï¼Œè¡¨ç¤ºæµ‡æ–™çš„ç§ç±»ï¼Œ æ¥ä¸‹æ¥æ˜¯ $k_i$ ä¸ªäº’ä¸ç›¸åŒçš„æ•´æ•° $b_{i,j}(1\leq b_{i,j}\leq 100)$ï¼Œè¡¨ç¤ºæŠ«è¨æµ‡æ–™çš„ç¼–å·ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºMå…ˆç”Ÿå¯ä»¥ç‚¹çš„æŠ«è¨çš„æ•°ç›®ã€‚

#### é¢˜ç›®åˆ†æ

æ°´é¢˜ä¸€é“ï¼Œåªéœ€è¦åœ¨è¾“å…¥æ¯ä¸€å—æŠ«è¨éœ€è¦ç”¨åˆ°çš„æµ‡æ–™åŒæ—¶æ¯”è¾ƒè¿™ç§æµ‡æ–™æ˜¯ä¸æ˜¯Må…ˆç”Ÿå–œæ¬¢çš„å°±è¡Œäº†ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(nm^2)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 110
using namespace std;
van n,m,a[N],ans;
int main()
{
	cin>>n;
	for (int i=1;i<=n;i++) cin>>a[i];
	cin>>m;
	for (int i=1;i<=m;i++)
	{
		van sum;bool ok=true;
		cin>>sum;
		for (int j=1;j<=sum;j++)
		{
			van tmp;
			cin>>tmp;
			for (int k=1;k<=n;k++) if (a[k]==tmp) ok=false;
		}
		ans+=ok;
	}
	cout<<ans;
	return 0;
}
```

### T2 Vepar

#### é¢˜ç›®æè¿°

ç»™å®šä¸¤ä¸ªæ­£æ•´æ•°åŒºé—´ $\{a,a+1,..,b\}$ ä»¥åŠ $\{c,c+1,...,d\}$ ã€‚è¯·ä½ åˆ¤æ–­ $c(c+1)...d$ æ˜¯å¦è¢« $a(a+1)...b$ æ•´é™¤ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•° $t(1\leq t\leq 10)$ï¼Œè¡¨ç¤ºç‹¬ç«‹çš„æ•°æ®çš„ç»„æ•°ã€‚ 

æ¥ä¸‹æ¥çš„ $t$ è¡Œï¼Œæ¯è¡Œå››ä¸ªæ­£æ•´æ•° $a_i,b_i,c_i,d_i(1\leq a_i\leq b_i\leq 10^7,1\leq c_i\leq d_i\leq 10^7)$ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡º $t$ è¡Œï¼Œå¯¹äºç¬¬ $i$ ç»„æ•°æ®ï¼Œå¦‚æœå¯ä»¥æ•´é™¤ï¼Œè¯·è¾“å‡º `DA`ï¼Œå¦åˆ™è¾“å‡º `NE`ã€‚

#### é¢˜ç›®åˆ†æ

##### 45Pts

åªéœ€è¦ä¸€ä¸ªä¸ªæŒ¨ç€é¡ºåºå»æ‰¾è¿™ä¸ªè¿ä¹˜çš„ç»“æœæ‰€èƒ½æ‹†åˆ†å‡ºæ¥çš„è´¨å› æ•°å°±è¡Œäº†ã€‚

ç„¶åå°†æ¯”è¾ƒæ¯ä¸€ä¸ªèƒ½æ‹†åˆ†å‡ºæ¥çš„è´¨å› æ•°ã€‚è‹¥ $c(c+1)...d$ çš„è´¨å› æ•° $i$ çš„ä¸ªæ•°å°äº $a(a+1)...b$ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(tn\log_2n)$ã€‚

##### 100Pts

ä¾‹é¢˜ï¼šé˜¶ä¹˜åˆ†è§£

$c(c+1)...d$ ç­‰ä»·äº $\frac{d!}{(c-1)!}$ï¼Œ$a(a+1)...b$ ç­‰ä»·äº $\frac{b!}{(a-1)!}$ï¼Œå¯¹äº $c(c+1)...d$ çš„è´¨å› æ•°ï¼Œåªéœ€è¦ç®—å‡º $d!$ çš„è´¨å› æ•°ç„¶åå‡å» $(c-1)!$ çš„è´¨å› æ•°å³å¯ã€‚å¯¹äº $a(a+1)...b$ åŒç†ã€‚

æ¥ä¸‹æ¥çš„æ¯”è¾ƒä¸45Ptsçš„åšæ³•ç›¸åŒã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(tn)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 10001000
using namespace std;
van t,a,b,c,d;
bool prime[N];
van A[1000100],B[1000100],C[1000100],D[1000100];
vector<van> p;
void init()
{
	for (van i=2;i<=1e7;i++) if (!prime[i]) for (van j=i*i;j<=1e7;j+=i) prime[j]=true;
	for (van i=2;i<=1e7;i++) if (!prime[i]) p.push_back(i);
}//åŸƒå¼ç­›æ³•æ±‚å‡º1-10^7é‡Œçš„è´¨å› æ•°
void calc(van res[N],van n)
{
	for (int i=0;i<p.size();i++)
	{
		van base=1;
		if (p[i]>n) break;
		for (int j=1;j<=log(n)/log(p[i]);j++)
		{
			base*=p[i];
			res[i]+=n/base;
		}
	}
}//è®¡ç®—n!çš„è´¨å› æ•°åŠä¸ªæ•°
int main()
{
	init();
	cin>>t;
	while (t--)
	{
		cin>>a>>b>>c>>d;
		memset(A,0,sizeof A);
		memset(B,0,sizeof B);
		memset(C,0,sizeof C);
		memset(D,0,sizeof D);//æ¸…ç©ºè´¨å› æ•°æ•°ç»„
		calc(A,a-1);calc(B,b);calc(C,c-1);calc(D,d);//è®¡ç®—å››ä¸ªé˜¶ä¹˜çš„è´¨å› æ•°
		bool ok=true;
		for (int i=0;i<p.size();i++)
			if (D[i]-C[i]<B[i]-A[i]) ok=false;//æ£€æŸ¥èƒ½å¦è¢«æ•´é™¤
		cout<<(ok?"DA":"NE")<<endl;
	}
	return 0;
}

```

### T3 Hop

#### é¢˜ç›®æè¿°

æ± å¡˜å†…æœ‰ğ‘›æœµç¡è²ï¼Œç¬¬ğ‘–æœµç¡è²ä¸Šæœ‰ä¸€ä¸ªæ­£æ•´æ•° $x_i$ã€‚åºåˆ— $(x_i)_{1\leq i\leq n}$ **ä¸¥æ ¼å•è°ƒé€’å¢**ã€‚ 

æ¯ä¸€ç»„æ•°å¯¹ $(a,b)$ï¼Œ$(1\leq a<b\leq n)$ï¼Œå±äº**ä¸‰åªé’è›™**ä¸­çš„ä¸€åªã€‚ä¸€åªé’è›™å¯ä»¥ä»ç¡è² $i$ è·³åˆ°ç¡è² $j(j>i)$ï¼Œå½“ä¸”ä»…å½“æ•°å¯¹ $(i,j)$å±äºå®ƒï¼Œå¹¶ä¸”**$x_i|x_j$(å³$x_i$æ•´é™¤$x_j$)**ã€‚

 ç»™é’è›™åˆ†é…æ•°å¯¹ä½¿å¾—æ²¡æœ‰ä»»ä½•é’è›™å¯ä»¥è¿ç»­è·³è·ƒè¶…è¿‡ä¸‰æ¬¡ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•° $n(1\leq n\leq 1000)$ï¼Œè¡¨ç¤ºç¡è²çš„æ•°é‡ã€‚

è¾“å…¥çš„ç¬¬äºŒè¡ŒåŒ…æ‹¬ $n$ ä¸ªæ­£æ•´æ•° $x_i(1\leq x_i\leq 10^{18})$ï¼Œè¡¨ç¤ºç¡è²ä¸Šçš„æ•°å­—ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡º $n-1$ è¡Œï¼Œåœ¨ç¬¬ $i$ è¡Œå†…ï¼Œè¾“å‡º $i$ ä¸ªæ•°å­—ï¼Œæ¯ä¸€ä¸ªæ•°å­—ä¸º $\{1,2,3\}$ ä¸­çš„ä¸€ä¸ªï¼Œç¬¬ $i$ è¡Œçš„ç¬¬ $j$ ä¸ªæ•°å­— è¡¨ç¤ºè¾¹ $(j,i+1)$ çš„å½’å±ã€‚

#### é¢˜ç›®åˆ†æ

##### 1-3Pts

randä¸€ä¸‹å°±è¡Œäº†ã€‚èƒ½å¾—å¤šå°‘åˆ†å…¨é è¿æ°”äº†ã€‚

##### 100Pts

ç”±äº $(x_i)_{1\leq i\leq n}$ ä¸” $x_i|x_j$ï¼Œåˆ™ $x_i<x_j$ï¼Œå› æ­¤ $x_j$ æœ€å°‘éƒ½ä¼šæ˜¯ $x_i$ çš„ä¸¤å€ã€‚ç”±äºæ¯åªé’è›™æœ€å¤šåªèƒ½è¿ç»­è·³ä¸‰æ¬¡ï¼Œå› æ­¤å®ƒè¿ç»­è·³ä¸‰æ¬¡ä¹‹ååˆ°è¾¾çš„æ•°æœ€å°éƒ½ä¼šæ˜¯å½“å‰è¿™ä¸ªæ•°çš„ $2^3$ å€ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ•´ä¸ªåŒºå—æŒ‰ç…§æ•°çš„highbitå€¼åˆ†ä¸º4éƒ¨åˆ†ï¼Œæ¯ä¸€éƒ¨åˆ†çš„æ•°çš„èŒƒå›´åˆ†åˆ«ä¸º $[1,2^{16}-1],[2^{16},2^{32}-1],[2^{32},2^{48}-1],[2^{48},2^{64}-1]$ï¼Œå†å°†å·²ç»åˆ†å¥½çš„4ä¸ªéƒ¨åˆ†é‡Œåˆåˆ†æˆ4ä¸ªå°éƒ¨åˆ†ï¼Œè¿™16ä¸ªéƒ¨åˆ†é‡Œçš„æ•°åˆåˆ†åˆ«ä¸º $[1,2^4-1],[2^4,2^8-1],...$ï¼Œä»¥æ­¤ç±»æ¨ã€‚å› ä¸º $10^{18}\approx 2^{64}$ ä¸” $10^{18}<2^{64}$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è®©ç¬¬ä¸€åªé’è›™åªèƒ½åˆ†åˆ«åœ¨è¿™16ä¸ªå°éƒ¨åˆ†é‡Œé¢å»è·³ï¼Œä¸èƒ½è·³å‡ºæŸä¸€å°éƒ¨åˆ†åˆ°å¦å¤–çš„éƒ¨åˆ†å»äº†ï¼Œè¿™æ ·ç¬¬ä¸€åªé’è›™æ— è®ºæ€ä¹ˆè·³æœ€å¤šåªèƒ½è·³ä¸‰æ¬¡ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åˆè®©ç¬¬äºŒåªé’è›™åªåœ¨è¿™4ä¸ªå¤§éƒ¨åˆ†é‡Œå»è·³ï¼Œä½†åˆåªèƒ½åœ¨è¿™æŸä¸€ä¸ªéƒ¨åˆ†é‡Œé¢å»è·³ï¼Œåˆä¸èƒ½ä»æŸä¸€ä¸ªå°éƒ¨åˆ†åˆè·³åˆ°è¿™ä¸€ä¸ªå°éƒ¨åˆ†ï¼Œæœ€åæˆ‘ä»¬å†å°†å‰©ä¸‹çš„æ²¡æœ‰è·³è¿‡çš„è¾¹ç»™ç¬¬ä¸‰åªé’è›™ã€‚è¿™æ ·æˆ‘ä»¬å°±ä¿è¯äº†ä¸€åªé’è›™åªèƒ½è¿ç»­è·³3æ¬¡ã€‚æ•´ä¸ªè¿‡ç¨‹çš„æ¨¡æ‹Ÿå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![image-20210819193143586](./T3-åˆ†æ-100Pts-1.jpg)

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 1010
using namespace std;
van n,a[N];
van belong[N][N];
van highbit(van x)
{
	van tmp=x,ans=0,now=0;
	while (x)
	{
		if(x%2) ans=now;
		now++,x/=2;
	}
	return ans;
}//è®¡ç®—é«˜ä½highbit
int main()
{
	cin>>n;
	for (int i=1;i<=n;i++) cin>>a[i];
	for (int i=1;i<=n;i++)
		for (int j=i+1;j<=n;j++)
		{
			if (a[j]%a[i]!=0) belong[i][j]=1;
			else
			{
				if (highbit(a[i])/4==highbit(a[j])/4) belong[i][j]=1;
				else if (highbit(a[i])/16==highbit(a[j])/16) belong[i][j]=2;
				else belong[i][j]=3;
			}
		}//è¾“å…¥å¹¶è®¡ç®—ç‚¹å¯¹i,jç©¶ç«Ÿåº”è¯¥ç»™å“ªåªé’è›™
	for (int i=1;i<=n;i++)
	{
		for (int j=1;j<i;j++) cout<<belong[j][i]<<" ";
		cout<<endl;
	}//è¾“å‡ºç»“æœ
	return 0;
}
```

### T4 Janjetina

#### é¢˜ç›®æè¿°

åœ¨é•¿æœŸçš„å°é”ç»ˆäºç»“æŸä¹‹åï¼ŒMå…ˆç”Ÿå†³å®šå¼€å§‹ä¸€åœºç››å¤§çš„æ—…è¡Œäº«å—é£æ™¯ï¼Œä»¥åŠæœ€é‡è¦çš„ç¾é£Ÿã€‚ Må…ˆç”Ÿè®¡åˆ’å¯èƒ½æ—…è¡Œçš„åŸå¸‚ä¸€å…±æœ‰ $n$ åº§ï¼Œè¿™ $n$ åº§åŸå¸‚ç”± $n-1$ æ¡é“è·¯è¿æ¥èµ·æ¥ï¼Œæ¯æ¡é“è·¯è¿æ¥ä¸¤ä¸ªåŸå¸‚ï¼Œå¹¶ä¸”ä»»æ„ä¸¤ä¸ªç‚¹ä¹‹é—´éƒ½æœ‰è·¯å¾„å¯ä»¥è”é€šã€‚ æ‰€æœ‰è¿æ¥ä¸¤ä¸ªåŸå¸‚çš„è·¯ä¸Šéƒ½æœ‰è‹¥å¹²é¤å…ï¼Œä»–ä»¬çš„ç¾å‘³ç¨‹åº¦å¯ä»¥ç”¨ä¸€ä¸ªæ•°å­— $w_i$ æ¥è¡¨ç¤ºã€‚Må…ˆç”Ÿè®¡åˆ’çš„æ—…è¡Œä¼šä»ä¸€ä¸ªåŸå¸‚ $x$ å‡ºå‘ï¼Œæ²¿ç€æœ€çŸ­è·¯åˆ°å¦ä¸€ä¸ªåŸå¸‚ $y$ ç»“æŸã€‚æˆ‘ä»¬å‡å®šæ¯ä¸€æ¡è¿æ¥ä¸¤ä¸ªåŸå¸‚çš„é•¿åº¦éƒ½è®°ä¸ºä¸€ä¸ªå•ä½é•¿åº¦ã€‚æ—…è¡Œè¿‡ç¨‹ä¸­ï¼Œ**Må…ˆç”Ÿä¼šåœ¨ç¾å‘³ç¨‹åº¦æœ€é«˜çš„ä¸€æ¡é“è·¯ä¸Šäº«ç”¨ç¾é£Ÿ**ã€‚ å¯¹äºä¸€æ¬¡ç»è¿‡ $l$ ä¸ªå•ä½é•¿åº¦è·ç¦»ï¼Œäº«å—çš„ç¾é£Ÿç¾å‘³ç¨‹åº¦ä¸º $w$ çš„ä¸€æ¬¡æ—…è¡Œï¼Œå¦‚æœ $w-l\geq k$ï¼ŒMå…ˆç”Ÿå°±ä¼šå¯¹è¿™æ¬¡æ—…è¡Œæ„Ÿåˆ°æ»¡æ„ã€‚ä½ çš„ä»»åŠ¡æ˜¯æ±‚å‡ºä¼šä»¤Må…ˆç”Ÿæ„Ÿåˆ°æ»¡æ„çš„åŸå¸‚å¯¹çš„æ•°ç›®ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…å«ä¸¤ä¸ªæ­£æ•´æ•° $n$ å’Œ $k(1\leq n,k\leq 10^5)$ï¼Œè¡¨ç¤ºåŸå¸‚çš„æ•°ç›®ä»¥åŠæ»¡æ„çš„é˜ˆå€¼ã€‚ 

æ¥ä¸‹æ¥çš„ $n-1$ è¡Œï¼Œæ¯è¡Œä¸‰ä¸ªæ­£æ•´æ•° $x,y,w(1\leq x,y\leq n,x\not=y,1\leq w\leq 10^5)$ï¼Œè¿™è¡¨ç¤ºæœ‰ ä¸€æ¡è¿æ¥åŸå¸‚ $x$ å’ŒåŸå¸‚ $y$ çš„é“è·¯ï¼Œé“è·¯ä¸Šçš„é¤å…ç¾å‘³ç¨‹åº¦ä¸º$w$ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºä¸åŒçš„å¯ä»¥ä»¤Må…ˆç”Ÿæ„Ÿåˆ°æ»¡æ„çš„åŸå¸‚å¯¹ã€‚å®šä¹‰ä¸¤ä¸ªåŸå¸‚å¯¹ $(x_1,y_1)$ï¼Œ$(x_2,y_2)$ ä¸åŒï¼Œè¿™ä¸¤ä¸ªæ•°å¯¹è‡³å°‘æ»¡è¶³ $x_1\not=x_2$ ä»¥åŠ $y_1\not=y_2$ ä¸­çš„ä¸€ä¸ªã€‚

#### é¢˜ç›®åˆ†æ

##### 15Pts

æ­¤æ¡£æ•°æ®èŒƒå›´ $n\leq 1000$ï¼Œæšä¸¾ä¸¤ä¸ªç‚¹å†é€šè¿‡LCAæ±‚å‡º $w$ ä¸ $l$ çš„å€¼ä¸ $k$ æ¯”è¾ƒï¼Œè‹¥ç¬¦åˆæ¡ä»¶åˆ™ $ans$ åŠ ä¸Š1ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2\log_2n)$ã€‚

##### 50Pts

åœ¨å®ŒæˆSubtask1çš„åŸºç¡€ä¸Šè€ƒè™‘å¦‚ä½•è§£å†³Subtask2ã€‚

ç”±äºåœ¨Subtask2ä¸­ä¸€å®šä¼šå½¢æˆä¸€æ¡é“¾ï¼Œè€ƒè™‘é‡‡ç”¨çº¿æ€§çš„æ–¹æ³•è§£å†³è¿™ä¸ªSubtaskã€‚æˆ‘ä»¬å…ˆå°†æ•´å¹…å›¾åˆ†ä¸ºä¸¤ä¸ªåŒºé—´ï¼Œè®¡ç®—å·¦åŒºé—´çš„æŸä¸€ä¸ªç‚¹ä¸å³åŒºé—´çš„æŸä¸€ä¸ªç‚¹ç¬¦åˆæ¡ä»¶çš„æƒ…å†µæœ‰å¤šå°‘ç§ã€‚å†å°†å·¦åŒºé—´åˆ†ä¸ºä¸¤ä¸ªåŒºé—´ï¼Œåœ¨è¿™ä¸¤ä¸ªåŒºé—´å†…ç»§ç»­æ‰§è¡Œä¸Šé¢çš„æ“ä½œâ€¦â€¦ä»¥æ­¤ç±»æ¨ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åˆ†æ²»æ¥è§£å†³è¿™ä¸ªSubtaskã€‚å½“ç„¶ï¼Œåœ¨æ¯æ¬¡éƒ½å¹³åˆ†è¿™ä¸ªåŒºé—´çš„æƒ…å†µä¸‹ï¼Œèƒ½æœ€å°åŒ–æ—¶é—´å¤æ‚åº¦ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n\log_2n)$ã€‚

##### 100Pts

åœ¨å®ŒæˆSubtask2çš„åŸºç¡€ä¸Šç»§ç»­è€ƒè™‘å¦‚ä½•è§£å†³æ­¤é—®é¢˜ã€‚

é¦–å…ˆï¼ŒSubtask2ä¸­ä½¿ç”¨åˆ°äº†åˆ†æ²»çš„æ–¹æ³•è§£å†³çº¿æ€§çš„é—®é¢˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘åœ¨ä¸€æ£µæ ‘ä¸Šä½¿ç”¨åˆ†æ²»æ¥è§£å†³Subtask3ï¼Œå³ç‚¹åˆ†æ²»ã€‚

å‰©ä¸‹çš„åªéœ€è¦å°†ç‚¹åˆ†æ²»çš„æ¨¡æ¿å¥—ä¸Šå»å°±å¯ä»¥è§£å†³æ­¤é—®é¢˜äº†ã€‚

ç‚¹åˆ†æ²»çš„å‚è€ƒé“¾æ¥ï¼š[ã€ç®—æ³•å­¦ä¹ ã€‘ç‚¹åˆ†æ²» - ç²‰å…” - åšå®¢å›­ (cnblogs.com)](https://www.cnblogs.com/PinkRabbit/p/8593080.html)

æ—¶é—´å¤æ‚åº¦ä¸º $O(nlog_2^2n)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 100010
using namespace std;
vector<pair<van,van> > g[N];
van size[N],n,k,deep[N],cnt;bool used[N];
pair<van,van> wei[N];van c[N],ans,center,mx;
void FindSize(van root,van f,van s)
{
	size[root]=1;van num=0;
	for (int i=0;i<g[root].size();i++) if (g[root][i].first!=f&&!used[g[root][i].first])
	{
		FindSize(g[root][i].first,root,s);
		size[root]+=size[g[root][i].first];
		if (num<size[g[root][i].first]) num=size[g[root][i].first];
	}
	if (num<s-size[root]) num=s-size[root];
	if (num<mx) mx=num,center=root;
}//æŸ¥æ‰¾ä»¥rootä¸ºæ ¹èŠ‚ç‚¹çš„æ ‘çš„å¤§å°ï¼Œå¹¶ä¸”è®¡ç®—è¿™æ£µæ ‘çš„é‡å¿ƒ
void FindWeight(van root,van weight,van f)
{
	wei[++cnt]=make_pair(weight,deep[root]);
	for (int i=0;i<g[root].size();i++) if (g[root][i].first!=f&&!used[g[root][i].first])
	{
		deep[g[root][i].first]=deep[root]+1;
		FindWeight(g[root][i].first,max(weight,g[root][i].second),root);
	}
}//è®¡ç®—ä»rootåˆ°å…¶å­èŠ‚ç‚¹çš„wå€¼
van lowbit(van x){return x&-x;}
void add(van x,van num)
{
	while (x<N)//ä¸èƒ½æ˜¯nï¼Œå› ä¸ºwå€¼æœ‰å¯èƒ½ä¼šå¤§äºn
	{
		c[x]+=num;
		x+=lowbit(x);
	}
}
van query(van x)
{
	van ans=0;
	while (x>0)
	{
		ans+=c[x];
		x-=lowbit(x);
	}
	return ans;
}//æ ‘çŠ¶æ•°ç»„å¿«é€Ÿè®¡ç®—ç­”æ¡ˆ
van CalcAnswer(van root,van weight,van d)
{
	cnt=0;deep[root]=d;van tmp=0;
	FindWeight(root,weight,0);
	sort(wei+1,wei+cnt+1);
	for (int i=1;i<=cnt;i++)
	{
		tmp+=query(wei[i].first-k-wei[i].second+1);
		add(wei[i].second+1,1);
	}
	for (int i=1;i<=cnt;i++) add(wei[i].second+1,-1);
	return tmp;
}//è®¡ç®—ä»¥rootä¸ºæ ¹èŠ‚ç‚¹çš„ç­”æ¡ˆ
void Division(van root)
{
	ans+=CalcAnswer(root,0,0);
	used[root]=1;
	for (int i=0;i<g[root].size();i++) if (!used[g[root][i].first]) ans-=CalcAnswer(g[root][i].first,g[root][i].second,1);//å®¹æ–¥åŸç†å‡å»CalcAnswer(root,0,0)åŠ å¤šäº†çš„
	for (int i=0;i<g[root].size();i++) if (!used[g[root][i].first])//åˆ°å…¶å­æ ‘ä¸‹ç»§ç»­æ‰§è¡Œç‚¹åˆ†æ²»
	{
		mx=1e18;
		FindSize(g[root][i].first,root,size[g[root][i].first]);//é‡æ–°è®¡ç®—æ ‘çš„é‡å¿ƒä¸æ ‘çš„å¤§å°
		Division(center);
	}
};
int main()
{
	cin>>n>>k;
	for (int i=1;i<n;i++)
	{
		van f,s,w;
		scanf("%lld%lld%lld",&f,&s,&w);
		g[f].push_back(make_pair(s,w));
		g[s].push_back(make_pair(f,w));//å»ºè¾¹
	}
	mx=1e18;FindSize(1,0,n);//æŸ¥æ‰¾æ ‘çš„å¤§å°ä»¥åŠæ ‘çš„é‡å¿ƒ
	memset(used,0,sizeof used);
	Division(center);//ç‚¹åˆ†æ²»
	cout<<ans*2<<endl;//ç”±äºæ¯ä¸¤ä¸ªç‚¹åªè®¡ç®—äº†ä¸€æ¬¡ï¼Œå› æ­¤æœ€åç­”æ¡ˆéœ€è¦ä¹˜ä»¥2
}
```

### T5 Patkice II

#### é¢˜ç›®æè¿°

ä¸‰åªå°é¸­ï¼Œå†å‡ºå‘ï¼è¿™ä¸€æ¬¡ï¼Œæµ·æ´‹ä¼šæ›´åŠ æ±¹æ¶Œã€‚ 

æµ·æ´‹çš„æƒ…å†µå¯ä»¥ç”¨ä¸€å¼ å¤§å°ä¸º $r\times s$ çš„æµ·å›¾è¡¨ç¤ºï¼Œæµ·å›¾ä¸­çš„æ¯ä¸€ä¸ªæ ¼å­ä¼šæ˜¯`<>v^ox`ä¸­çš„ä¸€ä¸ª å­—ç¬¦ã€‚å…¶ä¸­`o`è¡¨ç¤ºèµ·ç‚¹,`x`è¡¨ç¤ºç»ˆç‚¹ã€‚å­—ç¬¦`<>v^`è¡¨ç¤ºæ´‹æµï¼Œè¡¨ç¤ºå¦‚æœå°é¸­å­ä»¬åˆ°è¾¾å¯¹åº”çš„æ ¼å­ï¼Œ ä¼šè¢«æ´‹æµæ¨å‘ä¸€ä¸ªç›¸é‚»çš„æ ¼å­`<`è¡¨ç¤ºè¢«æ´‹æµæ¨å‘è¥¿ä¾§çš„æ ¼å­ï¼Œ`>`è¡¨ç¤ºè¢«æ´‹æµæ¨å‘ä¸œä¾§çš„æ ¼å­ï¼Œ`v`è¡¨ç¤ºè¢«æ´‹æµæ¨å‘å—ä¾§çš„æ ¼å­ï¼Œ`^`è¡¨ç¤ºè¢«æ´‹æµæ¨å‘åŒ—ä¾§çš„æ ¼å­ã€‚`.`åˆ™è¡¨ç¤ºä¸€ç‰‡å¹³é™çš„æµ·æ´‹ï¼Œåˆ°è¾¾è¿™ç§æ ¼å­ä¹‹åï¼Œå°é¸­å­ä»¬å°±ä¼šç»“æŸä»–ä»¬çš„æ—…é€”ã€‚ 

å°é¸­å­ä»¬æœ€å¼€å§‹ä»`o`æ‰€åœ¨çš„ä½ç½®å‡ºå‘ï¼Œé€‰æ‹©ä¸œè¥¿å—åŒ—å››ä¸ªæ–¹å‘ä¸­çš„ä¸€ä¸ªï¼Œåˆ°è¾¾ç›¸é‚»çš„æ ¼å­ï¼Œ **éšåï¼Œåªèƒ½éšç€æ´‹æµç§»åŠ¨**ã€‚å¾ˆæ˜¾ç„¶ï¼Œä¸èƒ½ä¿è¯å°é¸­å­ä»¬ä¸€å®šå¯ä»¥åˆ°è¾¾ç›®çš„åœ°ï¼Œå³å­—ç¬¦`x`æ‰€åœ¨çš„æ ¼ å­ã€‚ç°åœ¨ï¼Œä½ è¢«èµ‹äºˆæ”¹å˜è‡ªç„¶çš„èƒ½åŠ›ï¼Œå¿…é¡»æƒ³åŠæ³•è®©é¸­å­ä»¬å¯ä»¥ä»`o`å‡ºå‘åˆ°è¾¾`x`ã€‚ä½ å¯ä»¥ä¿®æ”¹æµ·æ´‹ä¸­çš„ä»»ä½•ä¸€ä¸ªæ ¼å­æ‰€åœ¨çš„æµ·åŸŸ(å°†å¯¹åº”æ ¼å­ä¿®æ”¹ä¸º`v^<>.`ä¸­çš„ä¸€ä¸ªï¼Œä¸èƒ½ä¿®æ”¹`o`ï¼Œ`x`æ‰€åœ¨çš„æ ¼å­)ã€‚

ä½ éœ€è¦æ±‚å‡ºï¼Œæœ€å°‘éœ€è¦ä¿®æ”¹å¤šå°‘ä¸ªæ ¼å­çš„æµ·åŸŸï¼Œæ‰èƒ½å¤Ÿè®©å°é¸­å­ä»¬ä»`o`å‡ºå‘ï¼Œåˆ°è¾¾`x`ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ•´æ•° $r,s(3\leq r,s\leq 2000)$ï¼Œè¡¨ç¤ºæµ·å›¾çš„å¤§å°ã€‚ æ¥ä¸‹æ¥çš„ $r$ è¡Œï¼Œæ¯è¡Œä¸€ä¸ªé•¿ä¸º $s$ çš„å­—ç¬¦ä¸²ï¼Œå­—ç¬¦é›†ä¸º`o<>v^.x`ï¼Œè¡¨ç¤ºå½“å‰çš„æµ·æ´‹æƒ…å†µã€‚ä¿è¯åœ°å›¾ä¸­åªæœ‰ä¸€ä¸ª`o`å­—ç¬¦ä»¥åŠ`x`å­—ç¬¦ï¼Œå¹¶ä¸”äºŒè€…ä¸ä¼šç›¸é‚»ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºçš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•° $k$ï¼Œè¡¨ç¤ºæœ€å°‘éœ€è¦ä¿®æ”¹çš„æµ·åŸŸçš„æ•°ç›®ã€‚ 

æ¥ä¸‹æ¥çš„ $r$ è¡Œï¼Œæ¯è¡Œä¸€ä¸ªé•¿åº¦ä¸º $s$ çš„å­—ç¬¦ä¸²ï¼Œæè¿°ä¿®æ”¹ä¹‹åæµ·åŸŸçš„å½¢æ€ï¼Œæè¿°æ–¹æ³•ä¸è¾“å…¥çš„å½¢å¼ç›¸åŒã€‚å¦‚æœå­˜åœ¨å¤šç§å¯èƒ½çš„ç­”æ¡ˆï¼Œè¾“å‡ºä»»æ„ä¸€ç§ã€‚

#### é¢˜ç›®åˆ†æ

æˆ‘ä»¬å¯ä»¥é€šè¿‡ 01BFS æ¥è§£å†³æ­¤é—®é¢˜ï¼Œå°†å½“å‰æ¼©æ¶¡æ‰€æŒ‡å‘çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸å½“å‰èŠ‚ç‚¹æ‰€å½¢æˆçš„è¾¹çš„æƒå€¼è®¾ç½®ä¸º 0ï¼Œå°†å…¶ä»–ä¸‰ä¸ªæ–¹å‘çš„è¾¹è®¾ç½®ä¸º 1ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ª deque å®¹å™¨æ¥è§£å†³è¿™ä¸ª 01BFS é—®é¢˜ã€‚æœ€ååœ¨ä½¿ç”¨ä¸€ä¸ª DFS æ¥æŸ¥æ‰¾éœ€è¦ä¿®æ”¹çš„ç‚¹å¹¶å°†åˆæ³•æ–¹æ¡ˆè¾“å‡ºã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van int
#define N 2010
using namespace std;
struct node
{
	van x,y;
	van step;
};
char cha[N][N];
van n,m,VanGo[4][2]={{1,0},{0,1},{-1,0},{0,-1}};
bool used[N][N];van f[N][N];
deque<node> q;
van sx,sy,ex,ey;
pair<van,van> GetDirByChar(char x)
{
	if (x=='^') return make_pair(-1,0);
	if (x=='v') return make_pair(1,0);
	if (x=='<') return make_pair(0,-1);
	if (x=='>') return make_pair(0,1);
}//æ ¹æ®æ¼©æ¶¡çš„æ–¹å‘æ¥æ¨æ–­è¦ä¿®æ”¹çš„åæ ‡
char GetCharByDir(van x,van y)
{
	if (x==1&&y==0) return 'v';
	if (x==-1&&y==0) return '^';
	if (x==0&&y==1) return '>';
	if (x==0&&y==-1) return '<';
}//æ ¹æ®ä¿®æ”¹çš„åæ ‡æ¥æ¨æ–­æ¼©æ¶¡çš„æ–¹å‘
bool in(van x,van y)
{
	return x>0&&x<=n&&y>0&&y<=m;
}//åˆ¤æ–­(x,y)æ˜¯å¦åœ¨å›¾å†…
void DFS(van x,van y)
{
	used[x][y]=1;
	if (x==ex&&y==ey)
	{
		for(int i=1;i<=n;i++)
		{
			for (int j=1;j<=m;j++) cout<<cha[i][j];
			cout<<endl;
		}
		exit(0);
	}//æŸ¥æ‰¾åˆ°äº†åˆæ³•çš„å›¾
	char tmp=cha[x][y];
	for (int i=0;i<4;i++)
	{
		van xx=x+VanGo[i][0],yy=y+VanGo[i][1];
		if (!in(xx,yy)||used[xx][yy]) continue;
		van w=GetCharByDir(VanGo[i][0],VanGo[i][1])==tmp||tmp=='o'||tmp=='x'?0:1;//è®¡ç®—è¾¹çš„æƒå€¼
		if (f[xx][yy]==f[x][y]+w)//(xx,yy)æœ‰å¯èƒ½æ˜¯(x,y)çš„ä¸‹ä¸€ä¸ªç‚¹
		{
			if (cha[x][y]!='o') cha[x][y]=GetCharByDir(VanGo[i][0],VanGo[i][1]);
			DFS(xx,yy);
		}
	}
	cha[x][y]=tmp;//å›æº¯
}
int main()
{
	srand(time(0));
	cin>>n>>m;
	for (int i=1;i<=n;i++)
		for (int j=1;j<=m;j++) cin>>cha[i][j];//è¾“å…¥åœ°å›¾
	for (int i=1;i<=n;i++) for (int j=1;j<=m;j++)
	{
		if (cha[i][j]=='o') sx=i,sy=j;
		if (cha[i][j]=='x') ex=i,ey=j;
	}//åˆ¤æ–­èµ·ç‚¹ä¸ç»ˆç‚¹
	q.push_back((node){sx,sy,0});
	while (!q.empty())
	{
		node now=q.front();q.pop_front();
		if (used[now.x][now.y]) continue;
		used[now.x][now.y]=1;f[now.x][now.y]=now.step;
		if (now.x==ex&&now.y==ey) break;
		char tmp=cha[now.x][now.y];
		for (int i=0;i<4;i++)
		{
			node new_elem=now;
			new_elem.x+=VanGo[i][0],new_elem.y+=VanGo[i][1];
			if (!in(new_elem.x,new_elem.y)) continue;
			new_elem.step+=GetCharByDir(VanGo[i][0],VanGo[i][1])==tmp||tmp=='o'||tmp=='x'?0:1;
			if (new_elem.step-now.step==1) q.push_back(new_elem);
			else q.push_front(new_elem);
		}
	}//01BFSè§£å†³è¾¹æƒä¸º0æˆ–1çš„æœ€çŸ­è·¯é—®é¢˜
	cout<<f[ex][ey]<<endl;//è¾“å‡º(ex,ey)çš„æœ€å°æƒå€¼å³ä¿®æ”¹æ¬¡æ•°
	memset(used,0,sizeof used);
	DFS(sx,sy);//DFSæŸ¥æ‰¾ä¿®æ”¹åçš„å›¾
	return 0;
}
```

## COCI2020-2021 #5

### T1 Sifra

#### é¢˜ç›®æè¿°

éª‘å£« $Borna$ æ­£åœ¨è¯•å›¾ç ´è¯‘ä¸€å°æ¥è‡ªä»–çš„æ•Œäººçš„ç§˜å¯†ä¿¡ä»¶ã€‚è¿™å°ä¿¡ä»¶ç”±ä¸€ä¸ªç”±å°å†™å­—æ¯å’Œæ•°å­—ç¬¦å·ç»„æˆï¼Œ $Borna$ éœ€è¦ç ´è¯‘å‡ºæ¥çš„å¯†ç å°±æ˜¯å­—ç¬¦ä¸²å†…ä¸åŒçš„æ•°å­—ä¸ªæ•°ã€‚(è¿ç»­çš„æ•°å­—å­—ç¬¦çœ‹æˆä¸€ä¸ªæ•°å­—ï¼Œä¸å¯æ‹†å¼€) 

è¾“å…¥ä¿è¯å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸€ä¸ªæ•°å­—éƒ½æ²¡æœ‰å‰å¯¼é›¶ã€‚ä½ çš„ä»»åŠ¡å°±æ˜¯æ±‚å‡ºä¸åŒçš„æ•°å­—çš„ä¸ªæ•°ã€‚

#### è¾“å…¥æè¿°

ç¬¬ä¸€è¡ŒåŒ…å«ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé•¿åº¦åœ¨1åˆ°100ä¹‹é—´ï¼Œå­—ç¬¦ä¸²ç”±å°å†™å­—æ¯å’Œæ•°å­—å­—ç¬¦ç»„æˆã€‚è¾“å…¥ä¿ è¯æ‰€æœ‰çš„æ•°å­—æœ€å¤šåªç”±ä¸‰ä¸ªæ•°å­—å­—ç¬¦ç»„æˆã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºå­—ç¬¦ä¸²å†…ä¸åŒçš„æ•°å­—æ•°é‡ã€‚

#### é¢˜ç›®åˆ†æ

æ°´é¢˜ä¸€é“ï¼Œä»å·¦å¾€å³æ‰«ä¸€éå­—ç¬¦ä¸²ï¼Œå½“æ‰«åˆ°äº†æŸä¸€ä¸ªæ•°å­—çš„æ—¶å€™ï¼Œåœ¨å¾ªç¯å†…éƒ¨ç»§ç»­æ‰«ä¸‹å»ï¼Œç›´åˆ°æ‰«ä¸åˆ°æ•°å­—äº†ä¸ºæ­¢ï¼Œå¹¶å°†å¤–å±‚å¾ªç¯çš„ $i$ èµ‹å€¼ä¸ºå½“å‰çš„ä½ç½®ï¼Œè‡³äºè®¡ç®—è¿™ä¸ªæ•°å­—æ˜¯å¤šå°‘ï¼Œåªéœ€è¦æŒ‰ç…§å¿«è¯»çš„æ€è·¯è®¡ç®—å°±è¡Œäº†ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(s.size())$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 1010
#define ywhin cin
#define ywhout cout
using namespace std;
bool used[N];van an;
int main()
{
//	ifstream ywhin("sifra.in");
//	ofstream ywhout("sifra.out");
	string x;
	ywhin>>x;
	for (int i=0;i<x.size();i++)
	{
		van ans=0;
		while (x[i]>='0'&&x[i]<='9') ans*=10,ans+=x[i]-'0',i++;
		if (ans!=0) used[ans]=1,i--;
	}
	for (int i=0;i<=1000;i++) if (used[i]) an++;
	ywhout<<ans<<endl;
	return 0;
}
```

### T2 Po

#### é¢˜ç›®æè¿°

ä½ ä¼šè·å¾—ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ— $a_i$ï¼Œè¿™ä¸ªåºåˆ—æ˜¯ç”±ä¸€ä¸ªåˆå§‹åºåˆ—ç»è¿‡è‹¥å¹²å˜æ¢å¾—åˆ°çš„ã€‚åˆå§‹åºåˆ—æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„å…¨0åºåˆ—ã€‚å¯èƒ½å‡ºç°çš„å˜æ¢è§„åˆ™å¦‚ä¸‹ï¼š

å•ä¸ªå˜æ¢çš„æ•ˆæœä¸ºé€‰æ‹©ä¸€ä¸ªåŒºé—´ [$l$, $r$]ï¼Œå°† $a_l,a_{l+1},...,a_r$ çš„å€¼åŠ ä¸Šä¸€ä¸ªæ­£æ•´æ•° $x$ã€‚ä»»æ„ä¸¤æ¬¡å˜æ¢çš„åŒºé—´åªèƒ½**äº’ä¸ç›¸äº¤æˆ–è€…ä¸€ä¸ªåŒºé—´åŒ…å«å¦ä¸€ä¸ªåŒºé—´**ã€‚ 

ä½ çš„é—®é¢˜æ˜¯ï¼Œå¯¹äºç»™å®šçš„åºåˆ— $a_i$ï¼Œè¿™ä¸ªåºåˆ—è‡³å°‘æ˜¯è¿›è¡Œäº†å¤šå°‘æ¬¡å˜æ¢å¾—åˆ°çš„ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•° $n(1\leq n\leq 10^5)$ï¼Œè¡¨ç¤ºåºåˆ—çš„é•¿åº¦ã€‚

è¾“å…¥çš„ç¬¬äºŒè¡ŒåŒ…å«ğ‘›ä¸ªéè´Ÿæ•´æ•° $a_i(0\leq a_i\leq 10^9)$ã€‚è¡¨ç¤ºç»è¿‡è‹¥å¹²æ¬¡å˜æ¢å¾—åˆ°çš„åºåˆ—ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºä¸€ä¸ªæ•´æ•°$m$ï¼Œè¡¨ç¤ºè¦å¾—åˆ°è¿™ä¸ªåŒºé—´çš„æœ€å°‘çš„å˜æ¢æ¬¡æ•°ã€‚

#### é¢˜ç›®åˆ†æ

åˆ†æé¢˜æ„ï¼Œé¦–å…ˆè¿™ä¸ªé¢˜åŠ ä¸Šçš„è¿™ä¸ªæ­£æ•´æ•° $x$ åªèƒ½æ˜¯ä¸ªæ­£æ•´æ•°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬åœ¨æ¯æ¬¡å˜æ¢æ—¶åªèƒ½å˜æ¢åˆ°å½“å‰åŒºé—´æœ€å°çš„ä¸€ä¸ªå€¼ï¼Œå¦‚æœå˜æ¢åˆ°çš„ä¸æ˜¯æœ€å°çš„ä¸€ä¸ªå€¼ï¼Œé‚£ä¹ˆå°±å†ä¹Ÿå˜æ¢ä¸åˆ°å½“å‰åŒºé—´çš„æœ€å°å€¼äº†ã€‚

è€ƒè™‘é€šè¿‡åˆ†æ²»æ¥è§£å†³æ­¤é—®é¢˜ã€‚æ¯æ¬¡å˜æ¢æ—¶æŸ¥è¯¢å½“å‰åŒºé—´çš„æœ€å°å€¼ï¼Œå¹¶æ ¹æ®è¿™ä¸ªæœ€å°å€¼åœ¨å½“å‰åŒºé—´æ‰€å‡ºç°çš„ä½ç½®æ¥å°†å½“å‰åŒºé—´æ‹†åˆ†ä¸ºè‹¥å¹²ä¸ªå­åŒºé—´ç»§ç»­è¿›è¡Œåˆ†æ²»ï¼Œå¹¶ä¸”å°† $ans$ çš„å€¼å¢åŠ 1ï¼Œç›´åˆ° $l<r$ å°±å¯ä»¥é€€å‡ºè¯¥é€’å½’å‡½æ•°äº†ã€‚

æ³¨æ„ï¼Œå½“åŒºé—´çš„æœ€å°å€¼ä¸º0æ—¶ï¼Œ $ans$ çš„å€¼ä¸éœ€è¦å¢åŠ 1ï¼Œå› ä¸ºæ­¤æ—¶ä¸éœ€è¦è¿›è¡Œä¸€æ¬¡å˜æ¢ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(n\log_2^2n)$ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 100010
#define ywhin cin
#define ywhout cout
using namespace std;
van n,a[N],tmp[N];
van tree[N*4],ans;
vector<van> place[N];
void build(van p,van l,van r)
{
	if (l==r){tree[p]=a[l];return;}
	van mid=l+r>>1;
	build(p*2,l,mid);build(p*2+1,mid+1,r);
	tree[p]=min(tree[p*2],tree[p*2+1]);
}//æ„å»ºçº¿æ®µæ ‘
van query(van p,van l,van r,van L,van R)
{
	if (L<=l&&r<=R) return tree[p];
	van mid=l+r>>1;
	van x=1e18;
	if (L<=mid) x=min(x,query(p*2,l,mid,L,R));
	if (R>mid) x=min(x,query(p*2+1,mid+1,r,L,R));
	return x;
}//åœ¨çº¿æ®µæ ‘å†…æŸ¥è¯¢æœ€å°å€¼
void solve(van l,van r)
{
	if (l>r) return;
	van min_=query(1,1,n,l,r);//è·å–[l,r]çš„æœ€å°å€¼
	if (tmp[min_]!=0) ans++;//æ³¨æ„:å½“æœ€å°å€¼ä¸º0æ—¶æ˜¯ä¸éœ€è¦ans++çš„
	van ll=0,rr=place[min_].size()-1,lll;
	while (ll<=rr)
	{
		van mid=ll+rr>>1;
		if (place[min_][mid]>=l) lll=mid,rr=mid-1;
		else ll=mid+1;
	}//äºŒåˆ†æŸ¥æ‰¾æœ€å°å€¼æ‰€åœ¨çš„ä½ç½®idæœ€å°çš„ä½ç½®
	ll=0,rr=place[min_].size()-1;van rrr;
	while (ll<=rr)
	{
		van mid=ll+rr>>1;
		if (place[min_][mid]<=r) rrr=mid,ll=mid+1;
		else rr=mid-1;
	}//äºŒåˆ†æŸ¥æ‰¾æœ€å°å€¼æ‰€åœ¨çš„ä½ç½®idæœ€å¤§çš„ä½ç½®
	solve(l,place[min_][lll]-1);//è§£å†³[l,a_l-1]çš„åŒºé—´
	for (int i=lll;i<rrr;i++) solve(place[min_][i]+1,place[min_][i+1]-1);//è§£å†³[a_i+1,a_{i+1}-1]æ‰€åœ¨çš„åŒºé—´
	solve(place[min_][rrr]+1,r);//è§£å†³[a_r+1,r]çš„åŒºé—´
}//åˆ†æ²»è§£å†³é—®é¢˜
int main()
{
//	ifstream ywhin("po.in");
//	ofstream ywhout("po.out");
	ywhin>>n;
	for (int i=1;i<=n;i++) ywhin>>a[i];
	memcpy(tmp,a,sizeof tmp);
	sort(tmp+1,tmp+n+1);
	van cnt=unique(tmp+1,tmp+n+1)-tmp-1;
	for (int i=1;i<=n;i++) a[i]=lower_bound(tmp+1,tmp+cnt+1,a[i])-tmp;//ç¦»æ•£åŒ–
	for (int i=1;i<=n;i++) place[a[i]].push_back(i);//è®°å½•æŸä¸€ä¸ªç¦»æ•£åŒ–åçš„æ•°ä¼šå‡ºç°åœ¨å“ªäº›ä½ç½®
	build(1,1,n);
	solve(1,n);
	ywhout<<ans<<endl;
	return 0;
}
```

### T3 Megenta

#### é¢˜ç›®æè¿°

å°På’Œå°Måœ¨ç©ä¸€ä¸ªæ¸¸æˆï¼Œæ¸¸æˆçš„å†…å®¹æ˜¯è¿™æ ·çš„ã€‚ 

æœ‰ä¸€æ£µ $n$ ä¸ªèŠ‚ç‚¹çš„æ ‘ï¼Œæ ‘ä¸Šçš„ $ğ‘›âˆ’1$ æ¡è¾¹ç”±ä¸‰ç§æ ‡è®°ï¼Œåˆ†åˆ«ä¸º $ğ‘šğ‘ğ‘”ğ‘’ğ‘›ğ‘¡ğ‘,ğ‘ğ‘™ğ‘ğ‘£ğ‘,cğ‘Ÿğ‘£ğ‘’ğ‘›ğ‘$ ã€‚æ¸¸æˆå¼€å§‹çš„æ—¶å€™ï¼Œå°Pçš„æ£‹å­ä½äºèŠ‚ç‚¹ $a$ ï¼Œå°Mçš„æ£‹å­ä½äºèŠ‚ç‚¹ $b$ ã€‚æ¸¸æˆå¼€å§‹åï¼Œå°På…ˆè¡ŒåŠ¨ï¼Œä»–éœ€è¦é€‰æ‹©ä¸€æ¡è¾¹ï¼Œä»èŠ‚ç‚¹ $a$ æ²¿ç€è¾¹èµ°åˆ°å¦ä¸€ç«¯ï¼Œè¦æ±‚å°Mçš„æ£‹å­å¦ä¸€ç«¯å¹¶ä¸”è¾¹çš„æ ‡è®°ä¸º $ğ‘ğ‘™ğ‘ğ‘£ğ‘$ æˆ–è€… $ğ‘šğ‘ğ‘”ğ‘’ğ‘›ğ‘¡ğ‘$ ã€‚éšåç”±å°Mæ“ä½œï¼ŒåŒæ ·æ²¿ç€ä¸€æ¡è¾¹èµ°ï¼Œè¦æ±‚å°Pçš„æ£‹å­ä¸åœ¨å¦ä¸€ç«¯ï¼Œè¾¹çš„æ ‡è®°ä¸º $ğ‘ğ‘Ÿğ‘£ğ‘’ğ‘›ğ‘$ æˆ– $ğ‘šğ‘ğ‘”ğ‘’ğ‘›ğ‘¡ğ‘$ ã€‚äºŒäººè½®æµæ“ä½œï¼Œé¦–å…ˆæ— æ³•æ“ä½œçš„äººå¤±è´¥ã€‚ 

ç°åœ¨ï¼Œæˆ‘ä»¬å‡è®¾äºŒäººéƒ½æ˜¯ç»å¯¹ç†æ€§å’Œèªæ˜çš„ï¼Œè¯·é—®è°ä¼šè·å¾—èƒœåˆ©ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸€ä¸ªæ­£æ•´æ•° $n(1\leq n\leq 10^5)$ ï¼Œè¡¨ç¤ºæ ‘ä¸Šçš„èŠ‚ç‚¹çš„æ•°ç›®ã€‚

è¾“å…¥çš„ç¬¬äºŒè¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ­£æ•´æ•° $a,b(1\leq a,b\leq n,a\not=b)$ ï¼Œè¡¨ç¤ºæœ€å¼€å§‹å°På’Œå°Mçš„æ£‹å­æ‰€åœ¨çš„ ä½ç½®ã€‚ 

æ¥ä¸‹æ¥çš„ $n-1$ è¡Œï¼Œæ¯è¡Œçš„æ ¼å¼å¦‚ä¸‹" $x\ y\ signal$ "ã€‚è¡¨ç¤ºè¾¹ $<x,y>$ ä¸Šçš„æ ‡è®°ä¸º $signal$ã€‚$signal\in\{magenta,crvena,plava\}$ã€‚

#### è¾“å‡ºæè¿°

å¦‚æœå°Pä¼šè·èƒœï¼Œè¾“å‡º" $Paula$ ",å¦‚æœå°Mè·èƒœï¼Œè¾“å‡º" $Marin$ "ã€‚å¦‚æœå¹³å±€ï¼Œè¾“å‡º" $Magenta$ "ã€‚

#### é¢˜ç›®åˆ†æ

##### 30Pts

ç”±äºæ¯æ¡è·¯å¯¹äºæ¯ä¸ªäººéƒ½æ˜¯å¯ä»¥èµ°çš„ï¼Œå› æ­¤åªéœ€è¦åˆ¤æ–­ä¸¤ä¸ªäººä¹‹é—´çš„è·ç¦»å°±è¡Œäº†ã€‚

##### 100Pts

ä»¤å½“è½®åˆ°è‡ªå·±è¡ŒåŠ¨å‰ä¸å¯¹æ–¹çš„è·ç¦»ä¸ºå¶æ•°çš„ä¸€æ–¹killerï¼Œå¦ä¸€æ–¹ä¸ºloserï¼Œåˆ™killeråªä¼šèµ¢æˆ–å¹³å±€ï¼Œæ¯•ç«Ÿå…¶èµ°ä¸åˆ°å¯¹æ–¹çš„æ£‹å­ä¸Š(å½“killeræ ¹æœ¬æ— æ³•è¡Œèµ°æ—¶ï¼Œè¦æ³¨æ„åˆ¤æ–­)ã€‚

æœç´¢killerèƒ½èµ°åˆ°çš„è·¯å¾„ï¼Œå¹¶åœ¨è¿™æ¡è·¯å¾„ä¸Šçš„æ¯ä¸€æ¡çˆ¶èŠ‚ç‚¹æ‰©å±•ä»–è¿˜èƒ½åˆ°è¾¾çš„å­èŠ‚ç‚¹æ ‡è®°ä¸º1ï¼Œå†æœç´¢loserèƒ½å¦åˆ°è¾¾è¿™äº›æ ‡è®°ä¸º1çš„ç‚¹ï¼Œå³loserèƒ½å¦æˆåŠŸé€ƒè„±ï¼Œè‹¥loserèƒ½æˆåŠŸé€ƒè„±ï¼Œåˆ™ä¸ºå¹³å±€ï¼Œå¦åˆ™loserè¾“ã€‚

åˆ†ç±»è®¨è®º:

1.è‹¥å…ˆæ‰‹æ— å¤„å¯èµ°ï¼Œåæ‰‹èµ¢ã€‚

2.è‹¥åæ‰‹æ— å¤„å¯èµ°ï¼Œå…ˆæ‰‹èµ¢ã€‚

3.è‹¥loserèƒ½å¤ŸæˆåŠŸé€ƒè„±ï¼Œå¹³å±€ã€‚

4.å¦åˆ™killerèµ¢ã€‚

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 100010
#define pb push_back
#define mp make_pair
using namespace std;
van n,a,b,fa[N],dis[N],len;
vector<pair<van,van> > graph[N];
bool used1[N],used2[N];
van cnt1,cnt2,killer,loser;
void PutError(string info)
{
	cout<<info;
	exit(0);
}//é”™è¯¯è¾“å‡º
void A(){printf("Paula");exit(0);}//å…ˆæ‰‹èµ¢
void B(){printf("Marin");exit(0);}//åæ‰‹èµ¢
void C(){printf("Magenta");exit(0);}//å¹³å±€
void DFS1(van u,van f)
{
	fa[u]=f;
	for (int i=0;i<graph[u].size();i++) if (graph[u][i].first!=f) DFS1(graph[u][i].first,u);
}//æŸ¥æ‰¾æ¯ä¸ªå­èŠ‚ç‚¹çš„çˆ¶äº²èŠ‚ç‚¹
void DFS2(van u,van f)
{
	cnt1++;
	for (int i=0;i<graph[u].size();i++) if (graph[u][i].first!=f&&graph[u][i].first!=b&&graph[u][i].second!=a) DFS2(graph[u][i].first,u);
}//æŸ¥æ‰¾aèƒ½èµ°çš„ç‚¹
void DFS3(van u,van f)
{
	cnt2++;
	for (int i=0;i<graph[u].size();i++) if (graph[u][i].first!=f&&graph[u][i].second!=b) DFS3(graph[u][i].first,u);
}//æŸ¥æ‰¾bèƒ½èµ°çš„ç‚¹
void DFS4(van u,van f,van step)
{
	dis[u]=step;cnt1++;used1[u]=1;
	for (int i=0;i<graph[u].size();i++) if (graph[u][i].first!=f&&graph[u][i].second!=killer) DFS4(graph[u][i].first,u,step+1);
}//æœç´¢killerèƒ½èµ°åˆ°çš„ç‚¹
void DFS5(van u,van f,van step)
{
	if (used2[u]) C();
	for (int i=0;i<graph[u].size();i++) if (graph[u][i].first!=f&&graph[u][i].second!=loser&&step+1-(loser==a)<dis[graph[u][i].first]) DFS5(graph[u][i].first,u,step+1);
}//æœç´¢loserèƒ½èƒ½å¦é€ƒè„±
int main()
{
	scanf("%lld\n%lld%lld",&n,&a,&b);
	for (int i=1;i<n;i++)
	{
		van f,s;string w;
		scanf("%lld%lld",&f,&s);cin>>w;
		van weight=112700;
		if (w[0]=='m') weight=0;
		else if (w[0]=='p') weight=b;
		else if (w[0]=='c') weight=a;
		else PutError("Input Error!");
		graph[f].pb(mp(s,weight));
		graph[s].pb(mp(f,weight));
	}//åŠ è¾¹
	DFS1(1,0);
	for (int i=a;i;i=fa[i])
	{
		used1[i]=1;
		dis[fa[i]]=dis[i]+1;
	}
	if (used1[b]) len=dis[b];
	else for (int i=b;i;i=fa[i])
	{
		if (used1[fa[i]])
		{
			len=dis[i]+dis[fa[i]]+1;
			break;
		}
		dis[fa[i]]=dis[i]+1;
	}
	killer=len%2?b:a,loser=len%2?a:b;//æŸ¥æ‰¾killerä¸loser
	for (int i=1;i<=n;i++) used1[i]=0,dis[i]=1e18;
	DFS2(a,0);if (cnt1==1) B();
	DFS3(b,0);if (cnt2==1) A();
	DFS4(killer,0,0);
	for (int i=1;i<=n;i++) if (!used1[i])
	{
		for (int j=0;j<graph[i].size();j++) if (!used1[graph[i][j].first]&&graph[i][j].second!=loser)
		{
			used2[i]=1;
			break;
		}
	}
	DFS5(loser,0,0);
	if (killer==a) A();else B();//loseræ— æ³•é€ƒè„±
	return 0;
}
```

### T4 Planine

### é¢˜ç›®æè¿° :

å‹‡è€…å°ğ‘è¦è·¨è¶Šç²¾çµå±±è„‰å¯»æ‰¾é—è½çš„ç²¾çµç§˜å®ã€‚ç²¾çµå±±è„‰å¯ä»¥ç”¨ä¸€ä¸ªé•¿ä¸ºå¥‡æ•°çš„åæ ‡åºåˆ—è¡¨ç¤ºï¼Œå¦‚æœæˆ‘ä»¬å°†è¿™äº›ç‚¹çš„åæ ‡æŒ‰ç…§ $x$ åæ ‡æ’åºï¼Œé™¤å»ç¬¬ä¸€ä¸ªç‚¹å’Œæœ€åä¸€ä¸ªç‚¹ä¹‹å¤–çš„å¥‡æ•°ç¼–å·çš„ç‚¹çš„ $y$ åæ ‡è¡¨ç¤º**å±±è°·**çš„é«˜åº¦ï¼Œå¶æ•°ç¼–å·çš„ç‚¹è¡¨ç¤º**å±±é¡¶**çš„åæ ‡ã€‚æ˜¾ç„¶ï¼Œå±±è°·çš„é«˜åº¦ä¸€å®šæ¯”æ—è¾¹çš„ä¸¤ä¸ªå±±é¡¶çš„é«˜åº¦ä½ã€‚ 

å‹‡è€…å°ğ‘æƒ§æ€•é»‘æš—ï¼Œå¥½åœ¨ç²¾çµå±±è„‰å†…æœ‰ç€å¯ä»¥ç…§æ˜çš„ç²¾çµï¼Œè¿™äº›ç²¾çµå›ºå®šåœ¨é«˜åº¦ä¸º$h$çš„åœ°æ–¹ï¼Œ ä¸€ä¸ªç²¾çµå¯ä»¥ç…§äº®ä¸€åº§å±±è°·ï¼Œå½“ä¸”ä»…å½“**è¯¥ç²¾çµä¸è¿™åº§å±±è°·çš„è¿çº¿ä¸ä¼šä¸å±±è„‰ç›¸äº¤**ã€‚

ä½ çš„ä»»åŠ¡æ˜¯æ±‚å‡ºï¼Œæœ€å°‘éœ€è¦å¤šå°‘åªç²¾çµçš„å¸®åŠ©æ‰èƒ½å¤Ÿç…§äº®æ‰€æœ‰å±±è°·ï¼Œè®©å°ğ‘ç©¿è¶Šç²¾çµå±±è„‰ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ­£æ•´æ•° $n(3\leq n\leq 10^6)$ï¼Œ$n$ æ˜¯ä¸€ä¸ªå¥‡æ•°å’Œæ­£æ•´æ•° $h(1\leq h\leq 106)$ åˆ†åˆ«æè¿°ç²¾çµå±±è„‰ä»¥åŠç…§æ˜ç²¾çµçš„é«˜åº¦ã€‚ 

æ¥ä¸‹æ¥çš„ğ‘›è¡Œï¼Œç¬¬ğ‘–è¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ•´æ•° $x_i$ å’Œ $y_i(-10^6\leq x_i\leq 10^6,0\leq y_i<h)$ï¼Œè¡¨ç¤ºæè¿°å±±è„‰çš„ç¬¬ ğ‘–ä¸ªç‚¹çš„åæ ‡ã€‚ 

è¾“å…¥ä¿è¯ $x_1<x_2<...<x_n$ï¼Œå¹¶ä¸” $y_1<y_2,y_2>y_3,y_3<y_4...y_{n-1}>y_n$ã€‚

#### è¾“å‡ºæè¿°

è¾“å‡ºæœ€å°‘çš„ï¼Œç…§äº®æ‰€æœ‰å±±è°·æ‰€éœ€è¦çš„ç…§æ˜ç²¾çµçš„æ•°ç›®ã€‚

#### é¢˜ç›®åˆ†æ

#### 20Pts:

ç”±äºè¿™ä¸€æ¡£çš„å±±é¡¶çš„é«˜åº¦éƒ½ç›¸åŒï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦é€šè¿‡æ˜ å°„ä¸€åªç²¾çµèƒ½å¤Ÿç…§äº®æŸä¸€ä¸ªå±±è°·æ‰€éœ€è¦æ”¾ç½®çš„èŒƒå›´ï¼Œç„¶åç”¨ä¸€ä¸ªè´ªå¿ƒå°±å¯ä»¥é€šè¿‡æ­¤é¢˜ã€‚

è´ªå¿ƒç­–ç•¥:

è®¾ç¬¬$i$ä¸ªå±±è°·æ˜ å°„åçš„èŒƒå›´ä¸º$[l_i,r_i]$ï¼Œå·²ç»å®‰æ”¾çš„æœ€åä¸€åªç²¾çµçš„åæ ‡ä¸º$(pos,h)$ï¼Œ$pos=-\infty$ ï¼ŒæŒ‰ç…§æ¯ä¸ªèŒƒå›´çš„å·¦ç«¯ç‚¹ $l_i$ ä»å°åˆ°å¤§æ’åºã€‚

ä¾æ¬¡è€ƒè™‘æ¯ä¸ªåŒºé—´ï¼Œè‹¥ $l_i>pos$ï¼Œåˆ™åœ¨ $r_i$ çš„ä½ç½®ä¸Šæ–°å¢ä¸€åªç²¾çµã€‚å¦åˆ™å°±å°†æœ€åçš„é‚£ä¸€åªç²¾çµä» $pos$ æ”¾ç½®åˆ° $\min(pos,r_i)$ã€‚

##### 50Pts

æ­¤æ¡£æ•°æ®é‡ $n\leqslant 2000$ï¼Œåœ¨ $n^2$ çš„æ—¶é—´å¤æ‚åº¦èƒ½å¤Ÿé€šè¿‡æ­¤é¢˜ï¼Œå› æ­¤åœ¨æ‰§è¡Œè´ªå¿ƒæ“ä½œä¹‹å‰ä½¿ç”¨ $n^2$ çš„æ—¶é—´å¤æ‚åº¦æ‰¾åˆ°ä¸ä¼šè¢«æŒ¡ä½çš„å±±é¡¶çš„ç¼–å·ä»¥åŠæ˜ å°„åˆ°çš„ä½ç½®å³å¯ã€‚

##### 100Pts

åœ¨æŸç›¸é‚»ä¸¤ä¸ªå±±é¡¶ä¸­é—´è¿ä¸€æ¡çº¿(å¦‚ä¸‹å›¾æ‰€ç¤º)ï¼Œåœ¨è¿™æ¡çº¿æ‰€åœ¨çš„ç›´çº¿ä¸Šæ–¹çš„æ‰€æœ‰å±±è°·ä¸ä¸Šæ–¹çš„å±±é¡¶çš„è¿çº¿éƒ½ä¼šæ¯”ä¸ä¸‹æ–¹å±±é¡¶çš„è¿çº¿æ›´ä¼˜ï¼Œå› æ­¤å…¶å³ä¸Šæ–¹çš„å±±è°·ä¼šå°†ä¸‹æ–¹å±±é¡¶ç»™è¸¢æ‰ï¼Œæœ€åå½¢æˆçš„ä¼šæ˜¯ä¸€ä¸ªä¸Šå‡¸å£³ï¼Œä»å·¦å¾€å³ä»¥åŠä»å³å¾€å·¦å„æ‰«ä¸€éä¹‹åå°±èƒ½æ‰¾åˆ°å¯¹äºæ¯ä¸ªå±±è°·æ‰€æ˜ å°„çš„ä½ç½®ï¼Œç„¶åæ ¹æ®è´ªå¿ƒç­–ç•¥è§£å†³æ­¤é—®é¢˜å³å¯ã€‚

![image-20210817203120771](./T4-åˆ†æ-100Pts-1.jpg)

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 1000100
#define ywhin cin
#define ywhout cout
using namespace std;
struct node
{
	van x,y;
}pts[N];//å­˜å‚¨è¾“å…¥çš„ç‚¹
struct node2
{
	double l,r;
}area[N];//å­˜å‚¨å±±è°·æ‰€æ˜ å°„åˆ°hçš„åŒºé—´
van p[N],l=1,r=0;
van L[N],R[N];
van n,h,cnt,ans;
double calc(node a,node b)
{
	double dertax=b.x-a.x,dertay=b.y-a.y;
	return dertay/dertax;
}//è®¡ç®—æ–œç‡
bool cmp(node2 a,node2 b)
{
	if (a.l==b.l) return a.r<b.r;
	return a.l<b.l;
}//æ¯”è¾ƒå‡½æ•°
int main()
{
 	scanf("%lld %lld",&n,&h);
	for (int i=1;i<=n;i++) scanf("%lld %lld",&pts[i].x,&pts[i].y);
	for (int i=2;i<=n-1;i++)//æ­£ç€æ‰«ä¸€é
	{
		if (!(i%2))
		{
			while (l<r&&calc(pts[p[r-1]],pts[p[r]])<=calc(pts[p[r]],pts[i])) r--;//æ³¨æ„:è¿™é‡Œä¸åŠ ç­‰äºå·ä¼šTLE 
			p[++r]=i;
			while (r==l+1&&pts[p[l]].y<pts[p[r]].y) l++;
		}//å±±é¡¶è¸¢å±±é¡¶(ç»´æŠ¤å‡¸å£³)
		else
		{
			double min_k=1e18,now=-1;
			for (int j=l;j<=r;j++)
			    if (now==-1||calc(pts[p[j]],pts[i])<min_k) min_k=calc(pts[p[j]],pts[i]),now=p[j];
			L[i]=now;
		}//æŸ¥æ‰¾å¯¹äºå½“å‰å±±è°·æ¥è¯´æœ€é«˜çš„å·¦è¾¹çš„å±±é¡¶çš„ç¼–å·
	}
	l=1,r=0;
	for (int i=n-1;i>=2;i--)//åç€æ‰«ä¸€é
	{
		if (!(i%2))
		{
			while (l<r&&calc(pts[p[r]],pts[p[r-1]])>=calc(pts[i],pts[p[r]])) r--;//æ³¨æ„:è¿™é‡Œä¸åŠ ç­‰äºå·ä¼šTLE
			p[++r]=i;
			while (r==l+1&&pts[p[r]].y<pts[p[l]].y) l++;
		}//å±±é¡¶è¸¢å±±é¡¶(ç»´æŠ¤å‡¸å£³)
		else
		{
			double min_k=1e18,now=-1;
			for (int j=l;j<=r;j++)
			    if (now==-1||calc(pts[p[j]],pts[i])>min_k) min_k=calc(pts[p[j]],pts[i]),now=p[j];
			R[i]=now;
		}//æŸ¥æ‰¾å¯¹äºå½“å‰å±±è°·æ¥è¯´æœ€é«˜çš„å³è¾¹çš„å±±é¡¶çš„ç¼–å·
	}
	for (int i=3;i<=n-2;i+=2)
	{
		area[++cnt].l=(double)pts[i].x-(double)(h-pts[i].y)/(pts[L[i]].y-(double)pts[i].y)*(double)(pts[i].x-pts[L[i]].x);
		area[cnt].r=(double)pts[i].x+(double)(h-pts[i].y)/(pts[R[i]].y-(double)pts[i].y)*(double)(pts[R[i]].x-pts[i].x);
	}//è®¡ç®—å½“å‰å±±è°·æ‰€æ˜ å°„åˆ°hçš„åŒºé—´
	double pos=-1e9;
	sort(area+1,area+cnt+1,cmp);
	for (int i=1;i<=cnt;i++)
	{
		if (area[i].l>pos) ans++,pos=area[i].r;
		else pos=min(pos,area[i].r);
	}//è´ªå¿ƒè®¡ç®—æœ€å°å€¼
	cout<<ans<<endl;
	return 0;
}
```

### T5 Sjeckanje

#### é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ— $a_i$ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåºåˆ—çš„åˆ’åˆ†æ˜¯å°†ä¸€ä¸ªåºåˆ—åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªåŒºé—´ï¼Œè¿™ äº›åŒºé—´ä¾æ¬¡è¿æ¥èµ·æ¥å°±å¯ä»¥è¿˜åŸæ•´ä¸ªåºåˆ—ã€‚ä¾‹å¦‚ï¼šåŒºé—´[1 3]\[1 4][3 6]å°±æ˜¯åºåˆ—1 3 1 4 3 6çš„ä¸€ä¸ª åˆæ³•åˆ’åˆ†ã€‚æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŒºé—´çš„æƒå€¼ä¸º**åŒºé—´å†…çš„æœ€å¤§å€¼å‡å»åŒºé—´å†…çš„æœ€å°å€¼ã€‚å®šä¹‰åœ¨è¿™ä¸ªåŒºé—´åˆ’åˆ†ä¸‹ï¼Œåºåˆ—çš„æƒå€¼ä¸ºå„ä¸ªåŒºé—´çš„æƒå€¼çš„å’Œã€‚**

ä¾‹å¦‚ï¼šåœ¨åŒºé—´åˆ’åˆ†[1 3]\[1 4][3 6]çš„æƒ…å†µä¸‹ï¼Œåºåˆ—çš„æƒå€¼ä¸º $(3-1)+(4-1)+(6-3)=9$ã€‚ 

ä½ çš„ä»»åŠ¡æ˜¯ï¼šæ±‚å‡ºåºåˆ— $a_i$ æƒå€¼æœ€å¤§çš„åŒºé—´åˆ’åˆ†æ‰€å¯¹åº”çš„åºåˆ—æƒå€¼ã€‚ 

éœ€è¦æ”¯æŒ $q$ æ¬¡ä¿®æ”¹æ“ä½œï¼Œä¿®æ”¹æ“ä½œå½¢å¼å¦‚ä¸‹:å°†ä¸‹æ ‡åŒºé—´[ $l,r$ ]ä¸­çš„ $a_i$ åŠ ä¸Š $x$ ã€‚ä½ éœ€è¦åœ¨æ¯ä¸€æ¬¡ä¿®æ”¹æ“ä½œä¹‹åï¼Œè¾“å‡ºæ–°çš„åºåˆ—çš„æƒå€¼æœ€å¤§çš„åŒºé—´åˆ’åˆ†æ‰€å¯¹åº”çš„æƒå€¼ã€‚

#### è¾“å…¥æè¿°

è¾“å…¥çš„ç¬¬ä¸€è¡ŒåŒ…æ‹¬ä¸¤ä¸ªæ•´æ•° $n$ å’Œ $q(1\leq n,q\leq 2\times10^5)$ï¼Œåˆ†åˆ«è¡¨ç¤ºåºåˆ—çš„é•¿åº¦å·²ç»æ›´æ–°æ“ä½œçš„æ¬¡æ•°ã€‚ ç¬¬äºŒè¡ŒåŒ…å« $n$ ä¸ªæ•´æ•° $a_i(-10^8\leq a_i\leq 10^8)$ï¼Œè¡¨ç¤ºåºåˆ—çš„åˆå€¼ $a_i$ã€‚ æ¥ä¸‹æ¥çš„ $q$ è¡Œï¼Œæ¯è¡ŒåŒ…æ‹¬ä¸‰ä¸ªæ•´æ•° $l,r(1\leq l\leq r\leq n)$ å’Œ $x(-10^8\leq x\leq 10^8)$ï¼Œæè¿°ä¸€ä¸ªä¿®æ”¹æ“ä½œã€‚

#### è¾“å‡ºæè¿°

è¾“å‡º $q$ è¡Œï¼Œæ¯è¡Œä¸€ä¸ªæ•´æ•°ï¼Œè¡¨ç¤ºæ¯ä¸€æ¬¡æ›´æ–°æ“ä½œä¹‹ååºåˆ—æœ€å¤§çš„å¯èƒ½çš„åŒºé—´åˆ’åˆ†çš„æƒå€¼ã€‚

#### é¢˜ç›®åˆ†æ

##### 30pts

ä»¤ $dp_i$ ä¸ºå¯¹äºå‰ $i$ ä¸ªæ•°æ®çš„åŒºé—´èƒ½å–åˆ°çš„æœ€å¤§æƒå€¼ï¼Œåˆ™ $dp_{i+j}=dp_i+a_{max}-a_{min}$ã€‚

è€Œå¯¹äºåŒºé—´ä¿®æ”¹ï¼Œforå¾ªç¯ä¸€ä¸ªä¸€ä¸ªåœ°åŠ å°±è¡Œäº†ï¼Œæ—¶é—´å¤æ‚åº¦å°±åªæœ‰ $O(qn)$ã€‚

æ€»æ—¶é—´å¤æ‚åº¦ $O(qn^2)$ã€‚

##### 60pts

æœ€çŸ­è·¯ä¼˜åŒ–ï¼Œå°†éå•è°ƒåŒºé—´æ‹†åˆ†æˆè‹¥å¹²ä¸ªå•è°ƒåŒºé—´ï¼Œä½¿å¾—æœ€ç»ˆç­”æ¡ˆä¸€å®šä¸åŠ£ã€‚

ä»¤ $d_i$ ä¸º $a_i$ ä¸ $a_{i-1}$ çš„å·®å€¼ï¼Œåˆ™ $d_i=a_i-a_{i-1}\ \&\ d_1=0$ã€‚

è‹¥å¯¹äºåŒºé—´ $[l,r]$ï¼Œä½¿å¾— $d_{l+1},d_{l+2},...,d_r$ çš„ç¬¦å·ä¸€å®šæ˜¯ä¸€æ ·çš„ï¼Œåˆ™å½“å‰åŒºé—´$[l,r]$æ‰€èƒ½æä¾›çš„å¯¹ç­”æ¡ˆçš„è´¡çŒ®ä¸º $\sum_{l+1}^r|d_i|$ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(qn)$ã€‚

##### 100pts

å¼•å…¥çº¿æ®µæ ‘è¿›è¡Œç»´æŠ¤ï¼Œè®°å½•çº¿æ®µæ ‘èŠ‚ç‚¹ $T[x][0/1][0/1]$ï¼Œè¡¨ç¤ºçº¿æ®µæ ‘èŠ‚ç‚¹ä¸º$x$æ‰€ä»£è¡¨çš„åŒºé—´èƒ½å–åˆ°çš„åŒºé—´æœ€å€¼ã€‚

åé¢çš„ä¸¤ä¸ª0/1åˆ†åˆ«è¡¨ç¤ºå·¦ç«¯ç‚¹çš„ $d_i$ å–è¿˜æ˜¯ä¸å–ï¼Œä»¥åŠå³ç«¯ç‚¹ $d_i$ å–è¿˜æ˜¯ä¸å–ã€‚

ä¿®æ”¹æ—¶åªéœ€è¦ä¿®æ”¹æ‰€éœ€è¦ä¿®æ”¹çš„åŒºé—´çš„å·¦ç«¯ç‚¹ä»¥åŠå³ç«¯ç‚¹ç„¶åæ›´æ–°åˆ°çº¿æ®µæ ‘ä¸Šå³å¯ã€‚

æ—¶é—´å¤æ‚åº¦ä¸º $O(qlog_2n)ã€‚$

#### å‚è€ƒä»£ç 

```C++
#include<bits/stdc++.h>
#define van long long
#define N 1000100
using namespace std;
van n,a[N],q,d[N];
van t[N*4][2][2];//çº¿æ®µæ ‘
void update(van p,van num)
{
	for (int i=0;i<2;i++) for (int j=0;j<2;j++)
	{
		t[p][i][j]=-1e18;
		for (int k=0;k<2;k++) for (int l=0;l<2;l++) if (l!=1||k!=1||d[num]*d[num+1]>=0) t[p][i][j]=max(t[p][i][j],t[p*2][i][k]+t[p*2+1][l][j]);
	}
}//æ›´æ–°çº¿æ®µæ ‘pèŠ‚ç‚¹ä¸Šçš„å€¼
void add(van p,van l,van r,van where)
{
	if (l==r)
	{
//		cout<<"add "<<l<<" "<<d[l]<<endl;
		t[p][1][1]=abs(d[l]);
		return;
	}
	van mid=l+r>>1;
	if (where<=mid) add(p*2,l,mid,where);
	if (where>mid) add(p*2+1,mid+1,r,where);
	update(p,mid);
}//æ›´æ–°çº¿æ®µæ ‘(å•ç‚¹ä¿®æ”¹)
van query(van x)
{
	return max(t[x][0][0],max(t[x][0][1],max(t[x][1][0],t[x][1][1])));
}//æŸ¥è¯¢çº¿æ®µæ ‘ä¸ŠxèŠ‚ç‚¹çš„æœ€å¤§å€¼
int main()
{
//	ifstream ywhin("sjeckanje.in");
//	ofstream ywhout("sjeckanje.out");
	#define ywhin cin
	#define ywhout cout
	ywhin>>n>>q;
	for (int i=1;i<=n;i++) ywhin>>a[i];
	for (int i=1;i<=n;i++) d[i]=i==1?0:a[i]-a[i-1],add(1,1,n,i);//å·®åˆ†å¹¶æ’å…¥çº¿æ®µæ ‘ä¸Š
	while (q--)
	{
		van l,r,k;
		ywhin>>l>>r>>k;
		if (l!=1)
		{
			d[l]+=k;
			add(1,1,n,l);
		}//æ·»åŠ å·¦ç«¯ç‚¹
		if (r!=n)
		{
			d[r+1]-=k;
			add(1,1,n,r+1);
		}//æ·»åŠ å³ç«¯ç‚¹
		cout<<query(1)<<endl;//æŸ¥è¯¢[1,n]çš„åŒºé—´æœ€å€¼
	}
	return 0;
}
```

## 20220207 

### T1 ç¤¾äº¤è·ç¦»

#### é¢˜ç›®æè¿°

ä¸€ç§å¯æ€•çš„æ–°ç–¾ç—… COVID-19 å·²å¼€å§‹åœ¨ä¸–ç•Œå„åœ°ä¼ æ’­ã€‚äººä»¬è¯•å›¾é‡‡å–å°½å¯èƒ½å¤šçš„é¢„é˜²æªæ–½ä»¥ä¿æŠ¤è‡ªå·±å…å—æ„ŸæŸ“ï¼Œå…¶ä¸­æœ‰ä¸€é¡¹å°±æ˜¯å¢åŠ äººä¸äººä¹‹é—´çš„â€œç¤¾äº¤è·ç¦»â€ã€‚

ç°åœ¨è€ƒè™‘è¿™æ ·çš„ä¸€ä¸ªé—®é¢˜ï¼šåœ¨ç«è½¦ç«™çš„å€™è½¦å…æœ‰ä¸€æ’ç‹­çª„çš„åº§ä½ï¼Œè¿ç»­ N ä¸ªåº§ä½åœ¨ä¸€æ¡ç›´çº¿ä¸Šã€‚ è¿™äº›åº§ä½ä¸­æœ‰ä¸€äº›ç›®å‰è¢«äººå æ®ï¼Œæœ‰äº›ç©ºç€ã€‚ åœ¨äº†è§£äº†â€œç¤¾äº¤è·ç¦»â€Dçš„é‡è¦æ€§ä¹‹åï¼Œåæ¥çš„äººéƒ½å¸Œæœ›æœ€å¤§åŒ– Dï¼Œå…¶ä¸­ D æ˜¯æœ€è¿‘çš„ä¸¤ä¸ªè¢«å ç”¨çš„åº§ä½ä¹‹é—´çš„è·ç¦»ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœåº§ä½ 3 å’Œ 8 æ˜¯æœ€æ¥è¿‘çš„åº§ä½ï¼Œåˆ™ D = 5ã€‚

æœ€è¿‘æœ‰ä¸€ä¸ªæ–°çš„ä¹˜å®¢æ¥äº†æƒ³æ‰¾ä½å­åä¸‹ï¼Œä»–éœ€è¦ç¡®å®šåº”è¯¥åå“ªä¸ªä»¥å‰ç©ºç½®çš„åº§ä½ï¼Œä»¥ä½¿ D çš„æœ€ç»ˆå€¼ä»å°½å¯èƒ½å¤§ã€‚æ³¨æ„ï¼šå·²ç»åä¸‹æ¥çš„ä¹˜å®¢ä¸èƒ½åŠ¨ã€‚

#### é¢˜ç›®åˆ†æ

~~å­¦è¿‡æ•°ç»„çš„äººéƒ½ä¼šåšã€‚~~

ä¸»è¦æ˜¯æ³¨æ„ç»†èŠ‚é—®é¢˜ï¼Œä»£ç æœ¬èº«æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯ std è¿˜æ˜¯å‡ºäº†ç‚¹é—®é¢˜çš„ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
#define read() FastRead(garbage)
using namespace std;
typedef long long van;
van garbage;
template<typename T> inline
T FastRead(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;return x;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[41]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar('0'+st[i]);
}
const van MaxN=1e5+10;
char state[MaxN];van max_=-1e18,min_=1e18;
van ans=0;
int main() {
	freopen("socdist.in","r",stdin);
	freopen("socdist.out","w",stdout);
	van n;cin>>n; van lst=-1,st=-1;
	for (int i=1;i<=n;i++) cin>>state[i];
	for (int i=1;i<=n;i++) {
		if (state[i]=='1') {
			if (lst==-1){lst=i;st=i;continue;}
			max_=max(i-lst,max_);
			min_=min(min_,i-lst);
			lst=i;
		}
	} ans=max(min(min_,n-lst),min(min_,st-1));
	ans=max(ans,min(min_,max_/2)); print(ans);
	return 0;
}

```

### T2 è·¯å¾„

#### é¢˜ç›®æè¿°

ç»™å‡ºä¸€æ£µnä¸ªèŠ‚ç‚¹çš„æ ‘ï¼ŒèŠ‚ç‚¹ç¼–å·ä¸º1~nï¼ˆæ ¹èŠ‚ç‚¹ç¼–å·ä¸º1ï¼‰ã€‚å¯¹äºæ¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œè¾“å‡ºä»æ ¹åˆ°å¶å­çš„è·¯å¾„ã€‚

æ³¨æ„ï¼šæŒ‰ç…§è·¯å¾„çš„å­—å…¸åºä»å°åˆ°å¤§è¾“å‡ºã€‚

#### é¢˜ç›®åˆ†æ

æ™®æ™®é€šé€šçš„ DFSï¼Œåªä¸è¿‡è·‘ä¹‹å‰å¯¹äºæ¯ä¸ªéå¶èŠ‚ç‚¹å°†è‡ªå·±çš„å„¿å­æŒ‰åºå·ä»å°åˆ°å¤§æ’ä¸ªåºå°±å¯ä»¥äº†ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
#define read() FastRead(garbage)
using namespace std;
typedef long long van;
van garbage;
template<typename T> inline
T FastRead(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;return x;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[41]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar('0'+st[i]);
}
const van MaxN=1e5+10;
van n; vector<van> g[MaxN];
van st[MaxN],top=-1;
void DFS(van now=1) {
	st[++top]=now;
	if (g[now].size()==0) {
		for (int i=0;i<=top;i++) 
			print(st[i]),putchar(' ');
		putchar('\n'); top--;
		return;
	} for (int i=0;i<g[now].size();i++)
		DFS(g[now][i]); top--;
}
int main() {
	freopen("path.in","r",stdin);
	freopen("path.out","w",stdout);
	n=read(); for (int i=1;i<n;i++) {
		van f=read(),s=read();
		g[f].push_back(s);
	} for (int i=1;i<=n;i++) sort(g[i].begin(),g[i].end());
	DFS();
	return 0;
}

```

### T3 å€¾æ–œçš„çº¿

#### é¢˜ç›®æè¿°

ç»™å®šä¸¤ä¸ªæ­£æ•´æ•° P å’Œ Qã€‚åœ¨äºŒç»´å¹³é¢ä¸Šæœ‰ n ä¸ªæ•´ç‚¹ã€‚ç°åœ¨è¯·ä½ æ‰¾åˆ°ä¸€å¯¹ç‚¹ä½¿å¾—ç»è¿‡å®ƒä»¬çš„ç›´çº¿çš„æ–œç‡åœ¨æ•°å€¼ä¸Šæœ€æ¥è¿‘ P/Qï¼ˆå³è¿™æ¡ç›´çº¿çš„æ–œç‡ä¸ P/Q çš„å·®æœ€å°ï¼‰ï¼Œè¯·è¾“å‡ºç»è¿‡å®ƒä»¬ç›´çº¿çš„æ–œç‡ p/qã€‚å¦‚æœæœ‰ä¸¤ç»„ç‚¹çš„æ–œç‡çš„æ¥è¿‘ç¨‹åº¦ç›¸åŒï¼Œè¯·è¾“å‡ºè¾ƒå°çš„æ–œç‡ã€‚

ä¿è¯ç­”æ¡ˆçš„ p/q > 0ï¼Œå³è¾“å‡ºçš„ p å’Œ q éƒ½æ˜¯æ­£æ•´æ•°ã€‚

#### é¢˜ç›®åˆ†æ

å°†æ‰€æœ‰ç‚¹æŒ‰ç…§è¿‡å…¶çš„æ–œç‡ä¸º P/Q çš„ç›´çº¿çš„æˆªè·æ’åºã€‚ä»¤(i,j,k)ä¸ºå…¶ä¸­çš„æœ‰åºä¸‰å…ƒç»„ï¼Œæ˜“è¯å¾—ç›´çº¿(i,j)å’Œç›´çº¿(j,k)ä¸­è‡³å°‘æœ‰ä¸€æ¡çš„æ–œç‡æ¯”ç›´çº¿(i,k)çš„æ–œç‡æ›´æ¥è¿‘ P/Qï¼Œæ•…ç­”æ¡ˆæ‰€é€‰çš„ä¸¤ä¸ªç‚¹åœ¨æ’åºåä¸€å®šç›¸é‚»ã€‚

æ³¨æ„ç›´æ¥ç”¨ double ç±»å‹å¯èƒ½ä¼šç‚¸ç²¾åº¦ï¼Œæ‰€ä»¥éœ€è¦ç”¨æ•´æ•°è¿›è¡Œåˆ¤æ–­ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
#define read() FastRead(garbage)
using namespace std;
typedef __int128 van;
van garbage;
template<typename T> inline
T FastRead(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;return x;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[41]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar('0'+st[i]);
}
template<typename T> inline
T abs(T x) {return x<0?-x:x;}
const van MaxN=2e5+10;
van n,P,Q,ansp=1,ansq=-1,id;
struct point {
	van x,y;
	point(){};
	point(van x,van y):x(x),y(y){};
	bool operator < (const point& a) const {
		if (x==a.x) return y<a.y;
		return x<a.x; 
	}
}p[MaxN];
struct point2 {
	van x,y,id;
	point2(){};
	point2(van x,van y,van id):x(x),y(y),id(id){};
	bool operator < (const point2& a) const {
		if (y==a.y) return x<a.x;
		return y<a.y; 
	}
}p2[MaxN];
bool judge2(van p1,van q1,van p2,van q2) {
	return p1*q2<p2*q1;
}
void SubTask2() {
	for (int i=1;i<=n;i++) p2[i]=point2(p[i].x,p[i].y*Q-p[i].x*P,i);
	sort(p2+1,p2+n+1); for (int i=1;i<=n-1;i++) {
		van a=i,b=i+1;
		van ansp1=abs(p2[a].y-p2[b].y),ansq1=abs(p2[a].x-p2[b].x);
		if (id==0) ansp=ansp1,ansq=ansq1,id=i;
		else if (judge2(ansp1,ansq1,ansp,ansq)) ansp=ansp1,ansq=ansq1,id=i;
	} van a=p2[id].id,b=p2[id+1].id;
	van resp=abs(p[a].y-p[b].y),resq=abs(p[a].x-p[b].x);
	van gcd=__gcd(resp,resq);resp/=gcd,resq/=gcd;
	print(resp),putchar('/'),print(resq);
}
int main() {
	freopen("slope.in","r",stdin);
	freopen("slope.out","w",stdout);
	n=read(),P=read(),Q=read(); 
	for (int i=1;i<=n;i++) {
		van x=read(),y=read();
		p[i]=point(x,y);
	}
	SubTask2();
	return 0;
}
```

### T4 ç¬¦æ–‡

#### é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º |s| çš„ç¬¦æ–‡ä¸² s å’Œä¸€ä¸ªé•¿åº¦ä¸º |p| çš„ç¬¦æ–‡ä¸² p ï¼Œå®šä¹‰ç¬¦æ–‡çš„ç­‰çº§r(s,p) è¡¨ç¤ºç¬¦æ–‡ä¸² s ä¸­æœ€å¤šæœ‰å¤šå°‘ä¸ªäº’ä¸é‡å çš„å­ä¸² p ã€‚

ç°åœ¨ä½ å¯ä»¥åœ¨ä»»æ„ä½ç½®åˆ é™¤ä»»æ„ä¸ªç¬¦æ–‡ã€‚

ä½ éœ€è¦ç®—å‡ºåœ¨åˆ é™¤ i (0â‰¤iâ‰¤|s|)ä¸ªç¬¦æ–‡åå¾—åˆ°çš„ç¬¦æ–‡ä¸²tiçš„r(ti,p)ã€‚

#### é¢˜ç›®åˆ†æ

dpï¼Œä»¤ f[i][j] ä¸ºå‰ i ä¸ªç¬¦æ–‡åˆ å» j ä¸ªç¬¦æ–‡åæœ€å¤šæœ‰å¤šå°‘ä¸ª p ä¸²ã€‚

ä»¤ w[i] ä¸ºä½¿å¾—ç¬¬ i ä¸ªç¬¦æ–‡åˆ°ç¬¬ i+w[i]-1 ä¸ªç¬¦æ–‡ä»…æœ‰ä¸€ä¸ªå­åºåˆ—ç­‰äº p çš„æœ€å°çš„ w[i]ã€‚

å¯æ¨å¯¼å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹å¦‚ä¸‹: 

ä¸åˆ é™¤æ—¶: f[i+1][j]=Max{f[i][j]};

åˆ é™¤æ—¶: f[i+1][j+1]=Max{f[i][j]},f[i+w[i]][j+w[i]-|p|]=Max{f[i][j]+1};

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
#define read() FastRead(garbage)
using namespace std;
typedef long long van;
van garbage;
template<typename T> inline
T FastRead(T& x) {
	T f=1,b=0;
	char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	}
	while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;
	return x;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {
		putchar('0');
		return;
	}
	van st[41]= {0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k; i; i--) putchar('0'+st[i]);
}
const van MaxN=2e3+10;
const van MaxM=5e2+10;
string s,p;
van f[MaxN][MaxN];
van w[MaxN];
int main() {
	freopen("runes.in","r",stdin);
	freopen("runes.out","w",stdout);
	cin>>s>>p;
	van n=s.size(),m=p.size();
	memset(w,-1,sizeof w);
	for (int i=0; i<n; i++) {
		van k=0;
		for (int j=i; j<n; j++) {
			if (s[j]==p[k]) k++;
			if (k==p.size()) {
				w[i+1]=j-i+1;
				break;
			}
		}
	}
	memset(f,-1,sizeof f);
	f[0][0]=0;
	for (int i=1; i<=n; i++) {
		for (int j=0; j<=i; j++) {
			f[i][j]=max(f[i][j],f[i-1][j]);
			f[i][j+1]=max(f[i][j+1],f[i-1][j]);
			if (w[i]!=-1)
				f[i+w[i]-1][j+w[i]-m]=max(f[i+w[i]-1][j+w[i]-m],f[i-1][j]+1);
		}
	}
	for (int i=0; i<=n; i++) print(f[n][i]),putchar(' ');
	return 0;
}
```

### T5 è´­ç¥¨

#### é¢˜ç›®æè¿°

æ—…è¡Œçš„è·¯çº¿ç”±ç¼–å·ä¸º 1â€¦Nï¼ˆ1â‰¤Nâ‰¤10^5ï¼‰çš„ N ä¸ªæ£€æŸ¥ç‚¹ç»„æˆã€‚æœ‰ Kï¼ˆ1â‰¤Kâ‰¤10^5ï¼‰å¼ ç¥¨å¯ä¾›è´­ä¹°ã€‚ç¬¬ i å¼ ç¥¨å¯ä»¥åœ¨æ£€æŸ¥ç«™ ciï¼ˆ1â‰¤ciâ‰¤Nï¼‰ä»¥ piï¼ˆ1â‰¤piâ‰¤10^9ï¼‰çš„ä»·æ ¼è´­å¾—ï¼Œå¹¶ä¸”å¯ä»¥ç”¨å…¶è¿›å…¥æ‰€æœ‰æ£€æŸ¥ç«™ [ai,bi]ï¼ˆ1â‰¤aiâ‰¤biâ‰¤Nï¼‰ã€‚åœ¨è¿›å…¥ä»»ä½•æ£€æŸ¥ç«™ä¹‹å‰ï¼Œå¿…é¡»å·²è´­ä¹°ä¸€å¼ å…è®¸å…¶è¿›å…¥è¯¥æ£€æŸ¥ç«™çš„ç¥¨ã€‚ä¸€æ—¦å¯ä»¥å‰å¾€æŸä¸€æ£€æŸ¥ç«™ï¼Œå°±å¯ä»¥åœ¨æœªæ¥çš„ä»»ä½•æ—¶å€™å›åˆ°è¯¥æ£€æŸ¥ç«™ã€‚å¯¹äºæ¯ä¸€ä¸ª iâˆˆ[1,N]ï¼Œå¦‚æœæœ€åˆåªèƒ½è¿›å…¥æ£€æŸ¥ç‚¹ iï¼Œè¾“å‡ºä½¿å¾—å¯ä»¥è¿›å…¥æ£€æŸ¥ç‚¹ 1 å’Œ N æ‰€éœ€çš„æœ€ä½æ€»ä»·ã€‚å¦‚æœæ— æ³•è¿™æ ·åšï¼Œè¾“å‡º âˆ’1

#### é¢˜ç›®åˆ†æ

çº¿æ®µæ ‘ä¼˜åŒ–å»ºè¾¹ã€‚ å¯¹äºæ¯ä¸€æ¡è¾¹ï¼Œç”±äºåªç”¨ä»˜ä¸€æ¬¡çš„ä»·é’±ï¼Œæ‰€ä»¥éœ€è¦å°†è¦è¿èµ·æ¥çš„è¾¹å…ˆè¿åˆ°ä¸€ä¸ªæ–°ç‚¹ä¸Šï¼Œæƒå€¼ä¸º 0ï¼Œç„¶åå†å°†è¿™ä¸ªç‚¹å’Œç›®æ ‡ç‚¹è¿æ¥èµ·æ¥ï¼Œæƒå€¼ä¸º piï¼Œç„¶åè·‘å‡º 1 å’Œ n åˆ°å„ç‚¹çš„æœ€çŸ­è·¯ï¼Œåœ¨å°†æ‰€æœ‰çš„ç‚¹æ‰”è¿›å †é‡Œæ€»ä½“è·‘ä¸€ä¸ªæœ€çŸ­è·¯å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
#define read() FastRead(garbage)
using namespace std;
typedef long long van;
van garbage;
template<typename T> inline
T FastRead(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;return x;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[41]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar('0'+st[i]);
}
const van MaxN=1e5+10;
struct ticket{
	van p,c,a,b;
	ticket(){};
	ticket(van p,van c,van a,van b):p(p),c(c),a(a),b(b){};
}t[MaxN];
struct Edge {
	van u,v,w;
	Edge(van u,van v,van w):u(u),v(v),w(w){};
};
van n,k; van id[MaxN];
vector<Edge> g[MaxN*6];

void Connect(van from,van to,van w) {
	g[from].push_back(Edge(from,to,w));
}
void BuildTree(van p=1,van l=1,van r=n) {
	if (l==r) {id[l]=p;return;} van mid=(l+r)>>1;
	Connect(p*2,p,0); Connect(p*2+1,p,0);
	BuildTree(p*2,l,mid); BuildTree(p*2+1,mid+1,r);
} 
void Update(van L,van R,van from,van p=1,van l=1,van r=n) {
	if (L<=l&&r<=R) {
		Connect(p,from,0);
		return;
	} van mid=(l+r)>>1;
	if (L<=mid) Update(L,R,from,p*2,l,mid);
	if (R>mid) Update(L,R,from,p*2+1,mid+1,r);
}
struct state {
	van dis,id;
	state(van dis,van id):dis(dis),id(id){};
	bool operator < (const state& a) const {
		return dis>a.dis;
	}
}; priority_queue<state> q;
van dis[MaxN*6]; bool used[MaxN*6];
van dis1[MaxN*6],dis2[MaxN*6];
void Dijkstra(van st,bool ahhh=true) {
	memset(used,0,sizeof used);
	for (int i=1;i<=5*n+k;i++) dis[i]=1e18;
	if (ahhh) dis[st]=0,q.push(state(dis[st],st));
	else {
		memcpy(dis,dis1,sizeof dis);
		for (int i=1;i<=5*n+k;i++) q.push(state(dis[i],i));
	}
	while (!q.empty()) {
		van now=q.top().id; q.pop();
		if (used[now]) continue; used[now]=1;
		for (int i=0;i<g[now].size();i++) {
			Edge e=g[now][i];
			if (dis[e.v]>dis[now]+e.w) {
				dis[e.v]=dis[now]+e.w;
				q.push(state(dis[e.v],e.v));
			}
		}
	}
}
int main() {
	n=read(),k=read(); BuildTree();
	for (int i=1;i<=k;i++) {
		van p=read(),c=read(),a=read(),b=read();
		t[i]=ticket(p,c,a,b);
		Update(a,b,4*n+i);
		Connect(4*n+i,id[p],c);
	} Dijkstra(id[1]); memcpy(dis1,dis,sizeof dis1);
	Dijkstra(id[n]); for (int i=1;i<=n*5+k;i++) dis1[i]+=dis[i];
	Dijkstra(0,false); for (int i=1;i<=n;i++)
		print(dis[id[i]]>=1e18?-1:dis[id[i]]),putchar('\n');
	return 0;
}
```

## 20220210

### T1 å•†è´¸

#### é¢˜ç›®æè¿°

å‹‡è€…å°ğ´é€šè¿‡å¯»å®æå‡è‡ªå·±çš„å®åŠ›ä¹‹åä»ç„¶æ— æ³•æˆ˜èƒœè™«ç¾¤ï¼Œä»–ç»ˆäºæ„è¯†åˆ°äº†ä¸€ä¸ªäººçš„åŠ›é‡ç»ˆç©¶æ—¶æœ‰æé™çš„ï¼Œå› æ­¤ï¼Œä»–å†³å®šå¼€å§‹æ‹›å…µä¹°é©¬ï¼Œç„¶è€Œï¼Œä¸€ä¸ªå¾ˆç°å®çš„é—®é¢˜æ‘†åœ¨ä»–çš„é¢å‰â€”â€”ä»–æ²¡æœ‰é’±ã€‚æ‰€å¹¸ä»–ç°åœ¨æ‰€åœ¨çš„å›½å®¶æ˜¯ä¸€ä¸ªå•†è´¸éå¸¸å‘è¾¾çš„å•†ä¸šå…±å’Œå›½ï¼Œä»–å¯ä»¥ä»ä¸­è·‘å•†èµšé’±ã€‚å…±å’Œå›½å†…æœ‰ğ‘åº§åŸå¸‚ï¼Œç¼–å·ä¸º1,2,3 â€¦ ğ‘ã€‚ç”±ğ‘€æ¡å•å‘çš„é“è·¯è¿æ¥ã€‚å°ğ´æ¯ä¸€æ¬¡åˆ°è¾¾åŸå¸‚ğ‘–éƒ½å¯ä»¥è·å¾—ğ‘šğ‘–çš„æ”¶ç›Šã€‚å°ğ´æœ€å¼€å§‹ä½äºåŸå¸‚1ï¼Œæœ€åä¹Ÿå¿…é¡»å›åˆ°ç¼–å·ä¸º1çš„åŸå¸‚ã€‚ä¸è¿‡èº«ä¸ºå‹‡è€…çš„å°ğ´çš„æ—¶é—´æ˜¯éå¸¸å®è´µçš„ï¼Œæ²¿ç€ä¸€æ¡é“è·¯ä»ä¸€åº§åŸå¸‚åˆ°è¾¾å¦ä¸€åº§åŸå¸‚éœ€è¦èŠ±è´¹ä¸€å¤©çš„æ—¶é—´ã€‚ä¸ºäº†é‡åŒ–å°ğ´èŠ±è´¹æ—¶é—´è´¸æ˜“çš„ä»£ä»·ï¼Œæˆ‘ä»¬è®¤ä¸ºå°ğ´èŠ±è´¹ğ‘‡æ—¶é—´è´¸æ˜“çš„æˆæœ¬ä¸ºğ¶ Ã— ğ‘‡^2ã€‚

ä½ éœ€è¦è®¡ç®—å‡ºå°ğ´å¯èƒ½å¾—åˆ°çš„æœ€é«˜æ”¶ç›Šã€‚

#### é¢˜ç›®åˆ†æ

æ³¨æ„åˆ°æ—¶é—´æˆæœ¬å¾ˆä½ï¼Œè€ƒè™‘ç›´æ¥ dpï¼Œè®¾ f[i][j] ä¸ºç¬¬ i ä¸ªç‚¹åœ¨ç¬¬ j çš„æ—¶é—´èƒ½å¤Ÿè·å¾—çš„æœ€å¤§è´¡çŒ®ï¼Œç›´æ¥ä»æœ€å°æ—¶é—´è½¬ç§»åˆ°æœ€å¤§æ—¶é—´å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[42]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
van n,k;
const van MaxN=1e3+10;
vector<van> g[MaxN];
bool used[MaxN];
van f[MaxN][MaxN],c,w[MaxN];
int main() {
	freopen("trade.in","r",stdin);
	freopen("trade.out","w",stdout);
	read(n),read(k),read(c);
	for (int i=1;i<=n;i++) read(w[i]);
	for (int i=1;i<=k;i++) {
		van f,s; read(f),read(s);
		g[f].push_back(s);
	} for (int i=1;i<=n;i++) {
		for (int j=0;j<=1000;j++) {
			f[i][j]=-1e18;
		}
	} f[1][0]=0;
	for (int i=1;i<=1000;i++) {
		for (int j=1;j<=n;j++) {
			for (int k=0;k<g[j].size();k++) {
				van e=g[j][k];
				f[e][i]=max(f[e][i],f[j][i-1]+w[e]);
			}
		}
	} van ans=0;
	for (int i=0;i<=1000;i++)
		ans=max(f[1][i]-c*i*i,ans);
	print(ans);
	return 0;
}
```

### T2 éƒ¨é˜Ÿé›†ç»“

#### é¢˜ç›®æè¿°

å°ğ´éœ€è¦é›†ç»“ä»–çš„éƒ¨é˜Ÿã€‚é€šè¿‡ä½¿ç”¨é’èƒ½åŠ›ï¼Œå°ğ´å·²ç»æ‹›å‹Ÿåˆ°äº†ğ‘åå¸¸å¹´æ¸¸èµ°äºåˆ€å‰‘ä¹‹ä¸Šçš„è€ç»ƒé›‡ä½£å…µï¼Œç°åœ¨ï¼Œä»–ä»¬æ‹æˆä¸€åˆ—ï¼Œç¼–å·ä»1åˆ°ğ‘ï¼Œæ­£åœ¨æ¥å—å°ğ´çš„æ£€é˜…ã€‚

å°ğ´ä¹Ÿéœ€è¦å°†è¿™ğ‘åé›‡ä½£å…µåˆ†æˆå°é˜Ÿè¡ŒåŠ¨ï¼Œä½†æ˜¯ï¼Œé¢†é˜Ÿçš„é€‰æ‹©æˆä¸ºäº†æ‰“é—®é¢˜ã€‚å…·ä½“æ¥è¯´ï¼Œå°ğ´åªèƒ½å¤Ÿé€‰æ‹©ä¸€ä¸ªè¿ç»­çš„ç¼–å·åŒºé—´[ğ‘™, ğ‘Ÿ]ä½œä¸ºå°é˜Ÿè¡ŒåŠ¨ï¼Œæ‰€æœ‰ç¼–å·ğ‘™ â‰¤ ğ‘– â‰¤ ğ‘Ÿçš„é›‡ä½£å…µğ‘–ä¼šåŠ å…¥å°é˜Ÿï¼Œé›‡ä½£å…µğ‘™, ğ‘Ÿä¼šä½œä¸ºé¢†é˜Ÿã€‚ç„¶è€Œï¼Œä¸åŒçš„é›‡ä½£å…µæœ‰è‡ªå·±çš„æŠ€æœ¯å€¾å‘ï¼Œå…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°å­—ğ‘ğ‘–æ¥æè¿°ç¼–å·ä¸ºğ‘–çš„é›‡ä½£å…µçš„æŠ€æœ¯å€¾å‘ï¼Œå¦‚æœé˜Ÿé•¿çš„æŠ€æœ¯å€¾å‘ä¸é˜Ÿå†…çš„å…¶ä»–æˆå‘˜(åŒ…æ‹¬å¦ä¸€ä½é˜Ÿé•¿)ç›¸åŒï¼Œé‚£ä¹ˆè¿™ä¸ªé˜Ÿä¼å°±æ— æ³•å’Œç¦ç›¸å¤„ã€‚

ä½ çš„ä»»åŠ¡æ˜¯å¸®åŠ©å°ğ´è®¡ç®—å‡ºæœ‰å¤šå°‘ä¸ªåŒºé—´å¯ä»¥åˆ’åˆ†å‡ºä¸€ä¸ªå’Œç¦ç›¸å¤„çš„å°é˜Ÿã€‚

#### é¢˜ç›®åˆ†æ

ç»å…¸çš„æ•°æ®ç»“æ„é¢˜ã€‚æ‰¾åˆ°å¯¹äºæŸä¸€ä¸ªé˜Ÿé•¿ï¼Œä»–æ‰€èƒ½æ‰¾åˆ°çš„å¦ä¸€ä¸ªé˜Ÿé•¿çš„åŒºé—´åœ¨å“ªé‡Œï¼Œç„¶ååŠ¨æ€åŠ ç‚¹åˆ ç‚¹ï¼ŒåŒºé—´æŸ¥è¯¢å½“è¯¥äººä½œä¸ºé˜Ÿé•¿æ—¶ç¬¦åˆæ¡ä»¶çš„å³ç«¯ç‚¹æœ‰å¤šå°‘ä¸ªå³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[42]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=2e5+10;
van n,a[MaxN]; vector<van> waited_delete[MaxN];
van nxt[MaxN],pre[MaxN],now[MaxN],ans=0;
struct SegmentTree {
	van dat[MaxN<<2];
	void UpdateTree(van wh,van num,van p=1,van l=1,van r=n) {
		if (l==r) {dat[p]+=num;return;}
		van mid=(l+r)>>1;
		if (wh<=mid) UpdateTree(wh,num,p*2,l,mid);
		else UpdateTree(wh,num,p*2+1,mid+1,r);
		dat[p]=dat[p*2]+dat[p*2+1];
	}
	van QueryTree(van L,van R,van p=1,van l=1,van r=n) {
		if (L<=l&&r<=R) return dat[p];
		van sum=0,mid=(l+r)>>1;
		if (L<=mid) sum+=QueryTree(L,R,p*2,l,mid);
		if (R>mid) sum+=QueryTree(L,R,p*2+1,mid+1,r);
		return sum;
	}
}T;
int main() {
	freopen("gather.in","r",stdin);
	freopen("gather.out","w",stdout);
	read(n); for (int i=1;i<=n;i++) read(a[i]);
	for (int i=1;i<=n;i++) 
		pre[i]=now[a[i]],nxt[now[a[i]]]=i,now[a[i]]=i;
	for (int i=1;i<=n;i++) if (nxt[i]==0) nxt[i]=n+1;
	for (int i=n;i;i--) {
		for (int j=0;j<waited_delete[i].size();j++) {
			van id=waited_delete[i][j];
			T.UpdateTree(id,-1);
		} ans+=T.QueryTree(i+1,nxt[i]-1); // cout<<i<<" "<<T.QueryTree(i+1,nxt[i]-1)<<endl;
		T.UpdateTree(i,1); waited_delete[pre[i]].push_back(i);
	} print(ans);
	return 0;
}
```

### T3 è™«ç¾¤æ‰©å¼ 

#### é¢˜ç›®æè¿°

ç»è¿‡ä¸€ç•ªæˆ˜æ–—ä¹‹åï¼Œè™«ç¾¤ç»ˆäºè¢«å°ğ´å‡»æºƒï¼Œè™«ç¾¤å¥³ç‹ä¹Ÿè½å…¥åˆ°äº†å°ğ´è®¾è®¡çš„é™·é˜±ä¹‹ä¸­ã€‚

å°ğ´è®¾è®¡çš„é™·é˜±å¯ä»¥ç”¨ä¸€ä¸ªğ‘ Ã— ğ‘çš„æ–¹é˜µè¡¨ç¤ºï¼Œå…¶ä¸­ï¼Œæ¯ä¸€ä¸ªæ–¹æ ¼å¯èƒ½æ˜¯ç©ºæ ¼æˆ–è€…ç‚¸å¼¹ï¼Œå¹¶ä¸”æ‰€æœ‰è¾¹ç•Œä¸Šçš„æ–¹æ ¼éƒ½è¢«å°ğ´å¸ƒç½®äº†ç‚¸å¼¹ã€‚æŸä¸€äº›æ²¡æœ‰è¢«å¸ƒç½®ç‚¸å¼¹çš„æ–¹æ ¼å¯èƒ½å›ä½¿è™«ç¾¤å¥³ç‹å‡ºç°çš„èµ·å§‹ä½ç½®ã€‚

æœ€å¼€å§‹ï¼Œè™«ç¾¤å¥³ç‹ä½äºæŸä¸€ä¸ªå¯èƒ½çš„èµ·å§‹ä½ç½®ä¸Šï¼Œåœ¨è¿™ä¹‹åçš„æ¯ä¸€ä¸ªå•ä½æ—¶é—´å†…ï¼Œå¥³ç‹å’Œå¥¹çš„è™«ç¾¤ä¼šå‘ç€ç›¸åŒçš„æ–¹å‘ç§»åŠ¨ä¸€æ ¼æˆ–åœç•™åœ¨åŸåœ°ï¼ˆç§»åŠ¨æ–¹å‘ä¸ºç½‘æ ¼å†…çš„ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ä¸­çš„ä¸€ä¸ªï¼‰ã€‚æ¯ç»è¿‡ğ·ä¸ªå•ä½æ—¶é—´ï¼Œè™«ç¾¤ä¼šè¿›è¡Œä¸€ä¸ªå¢æ®–ï¼Œä½äº(ğ’™, ğ’š)çš„è™«å­ä¼šåœ¨æ–¹æ ¼(ğ’™ + ğŸ, ğ’š), (ğ’™ âˆ’ ğŸ, ğ’š), (ğ’™, ğ’š âˆ’ ğŸ), (ğ’™, ğ’š + ğŸ)å„äº§ç”Ÿä¸€åªæ–°çš„è™«å­ã€‚æ¯ä¸€ä¸ªæ ¼å­å†…å¯èƒ½å‡ºç°å¤šåªè™«å­ã€‚

å¦‚æœç§»åŠ¨æˆ–è€…å¢æ®–ä½¿å¾—ä»»ä½•ä¸€åªè™«å­è§¦ç¢°åˆ°äº†ç‚¸å¼¹ï¼Œé‚£ä¹ˆç‚¸å¼¹å°±ä¼šè¢«å¼•çˆ†ï¼Œç”±äºè¿é”çˆ†ç‚¸ï¼Œæ•´ä¸ªç½‘æ ¼å›¾éƒ½ä¼šè¢«ç‚¸æ¯ã€‚èº«ä¸ºæ…é‡å‹‡è€…çš„å°ğ´å…·æœ‰çŸ­è·ç¦»ä¼ é€çš„èƒ½åŠ›ï¼Œå› æ­¤ä»–å†³å®šåœ¨ç‚¸å¼¹æ¿€å‘ä¹‹å‰å‰å¾€é™·é˜±å†…ä»¥é˜²æ­¢ä¸€äº›æ„å¤–æƒ…å†µåœ°å‘ç”Ÿã€‚ä¸ºäº†è®©å°ğ´åœ°è¡ŒåŠ¨æ›´åŠ æœ‰æ•ˆç‡ï¼Œä½ éœ€è¦å¸®åŠ©å°ğ´æ±‚å‡ºæœ‰å¤šå°‘ä¸ªæ ¼å­å†…å¯èƒ½å‡ºç°è™«ç¾¤ã€‚

#### é¢˜ç›®åˆ†æ

ä¸¤é Dijkstra å’Œä¸€é BFS å³å¯ã€‚ç¬¬ä¸€é Dijkstra åˆ™è·‘å‡ºå¯¹äºæŸä¸ªç‚¹èƒ½å¤Ÿæ¥å—çš„è™«ç¾¤å¥³ç‹çš„æœ€å¤§åŠå¾„æ˜¯å¤šå°‘ï¼Œæ¥ä¸‹æ¥è·‘ä¸€é BFS æŸ¥æ‰¾å‡ºè™«ç¾¤å¥³ç‹èƒ½å¤Ÿèµ°åˆ°å“ªäº›ç‚¹ï¼Œæœ€åä¸€é Dijkstra åˆ™å°†æ‰€æœ‰å¥³ç‹èƒ½å¤Ÿåšåˆ°çš„æ ¼å­ä»¥åŠè¿™ä¸ªæ ¼å­èƒ½å¤Ÿæ‰¿å—çš„æœ€å¤§åŠå¾„ä½œä¸ºæƒå€¼ï¼Œè·‘ä¸€éæœ€å¤§è·¯ï¼Œç»Ÿè®¡å‡ºæœ‰å“ªäº›æ ¼å­èƒ½å¤Ÿè¢«æ‰©å±•åˆ°å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[42]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=1e3+10;
van n,d;char m[MaxN][MaxN];
van dis[MaxN][MaxN]; bool used[MaxN][MaxN];
van dis2[MaxN][MaxN];
van VanGo[4][2]={{0,1},{1,0},{0,-1},{-1,0}};
bool in(van x,van y) {return x>0&&y>0&&x<=n&&y<=n;}
void Dijkstra() {
	memset(dis,(1<<6)-1,sizeof dis);
	priority_queue<pair<van,pair<van,van> > > q;
	for (int i=1;i<=n;i++) for (int j=1;j<=n;j++) 
		if (m[i][j]=='#') q.push(make_pair(0,make_pair(i,j))),dis[i][j]=0;
	while (!q.empty()) {
		van x=q.top().second.first,y=q.top().second.second;q.pop();
		if (used[x][y]) continue; used[x][y]=1;
		for (int i=0;i<4;i++) {
			van xx=x+VanGo[i][0],yy=y+VanGo[i][1];
			if (m[xx][yy]=='#') continue;
			if (!in(xx,yy)) continue;
			if (dis[xx][yy]>dis[x][y]+1) {
				dis[xx][yy]=dis[x][y]+1;
				q.push(make_pair(-dis[xx][yy],make_pair(xx,yy)));
			}
		}
	}
}
void BFS() {
	queue<pair<pair<van,van>,pair<van,van> > > q;
	for (int i=1;i<=n;i++) for (int j=1;j<=n;j++)
		if (m[i][j]=='S') q.push(make_pair(make_pair(i,j),make_pair(0,1)));
	while (!q.empty()) {
		van x=q.front().first.first,y=q.front().first.second;
		van dnow=q.front().second.first,l=q.front().second.second; q.pop();
		if (used[x][y]) continue;
		used[x][y]=1; if (dnow>=d) dnow-=d,l++;
		if (l>dis[x][y]) continue;
		for (int i=0;i<4;i++) {
			van xx=x+VanGo[i][0],yy=y+VanGo[i][1];
			if (m[xx][yy]=='#') continue;
			if (!used[xx][yy]) if (dis[xx][yy]>=l) 
				q.push(make_pair(make_pair(xx,yy),make_pair(dnow+1,l)));
		}
	}
}
void dijkstra() {
	priority_queue<pair<van,pair<van,van> > > q;
	for (int i=1;i<=n;i++) for (int j=1;j<=n;j++) 
		if (used[i][j]) q.push(make_pair(dis[i][j],make_pair(i,j))),dis2[i][j]=dis[i][j];
	memset(used,0,sizeof used);
	while (!q.empty()) {
		van x=q.top().second.first,y=q.top().second.second;q.pop();
		if (used[x][y]) continue; used[x][y]=1;
		if (dis2[x][y]==1) continue;
		for (int i=0;i<4;i++) {
			van xx=x+VanGo[i][0],yy=y+VanGo[i][1];
			if (m[xx][yy]=='#') continue;
			if (dis2[xx][yy]<dis2[x][y]-1) {
				dis2[xx][yy]=dis2[x][y]-1;
				q.push(make_pair(dis2[xx][yy],make_pair(xx,yy)));
			}
		}
	}
}
van ans=0;
void Solve() {
	memset(used,0,sizeof used);
	BFS(); for (int i=1;i<=n;i++) {
		for (int j=1;j<=n;j++) cout<<used[i][j];
		cout<<endl;
	} dijkstra(); 
	for (int i=1;i<=n;i++) for (int j=1;j<=n;j++)
		if (used[i][j]) ans++;
}
int main() {
//	freopen("proliferate.in","r",stdin);
//	freopen("proliferate.ans","w",stdout);
	read(n),read(d); for (int i=1;i<=n;i++)
		for (int j=1;j<=n;j++) cin>>m[i][j];
	Dijkstra(); Solve(); print(ans);
	return 0;
}
```

### T4 æ¨æ¼”

#### é¢˜ç›®æè¿°

å°½ç®¡è™«ç¾¤å·²ç»è¢«å°ğ´å½»åº•æ¯ç­äº†ï¼Œå¥³ç‹æ‰‹ä¸­è¿›å…¥é­”ç‹åŸçš„å››ä¸ªé’¥åŒ™ç¢ç‰‡ä¹‹ä¸€ä»ç„¶æ²¡æœ‰è¢«å°ğ´è·å¾—ï¼Œè¿™ä¸ªé’¥åŒ™ç¢ç‰‡è¢«è—åœ¨äº†è™«å·¢å†…éƒ¨ä¸€ä¸ªéšè”½çš„ä¼ é€é—¨å†…çš„ç©ºé—´é‡Œã€‚

è¿™ç¯‡ç¥å¥‡çš„ç©ºé—´å¹¶ä¸æ˜¯ä¸€ç¯‡å¹³å¦çš„ç©ºé—´ï¼Œè¿™ç¯‡ç©ºé—´å¯ä»¥è¢«çœ‹æˆæ˜¯ä¸€ä¸ªå·¨å¤§çš„äºŒç»´ç½‘æ ¼ã€‚å¯¹äºå…¶ä¸­çš„ä¸€ä¸ªåæ ‡(ğ‘¥, ğ‘¦)ï¼Œåªæœ‰åœ¨æ»¡è¶³å¦‚ä¸‹æ¡ä»¶æ—¶æ‰æ˜¯ä¸€å—å¯ä»¥åˆ°è¾¾çš„æ‚¬æµ®çŸ³å—ï¼š

å¯¹äºæ‰€æœ‰çš„æ•´æ•°ğ‘˜ â‰¥ 0,âŒŠ$\frac{x}{3^k}$âŒ‹å’ŒâŒŠ$\frac{y}{3^k}$âŒ‹å¯¹3å–æ¨¡å¾—åˆ°çš„æ•°å­—å¥‡å¶æ€§ç›¸åŒã€‚ä¾‹å¦‚:(1,7)å°±æ˜¯ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„åæ ‡ï¼Œå› ä¸ºå½“ğ‘˜ = 0æ—¶ä¸¤ä¸ªæ•°å­—å¯¹3å»æ¨¡å¾—åˆ°çš„ç»“æœéƒ½æ˜¯1ï¼Œğ‘˜ = 1æ—¶ä¸¤ä¸ªæ•°å­—å¯¹3å–æ¨¡å¾—åˆ°çš„ç»“æœä¸º0å’Œ2ã€‚å¥‡å¶æ€§ç›¸åŒã€‚è€Œğ‘˜ â‰¥ 2æ—¶ï¼Œå¾—åˆ°çš„æ•°éƒ½æ˜¯0ã€‚

ç”±äºè‡ªèº«æŠ€èƒ½ç‰¹æ€§çš„åŸå› ï¼Œå°ğ´éœ€è¦ä½ è®¡ç®—å‡ºæŸä¸€ä¸ªç‰¹å®šåŒºåŸŸå†…æœ‰å¤šå°‘ä¸ªæ ¼å­ä¸Šæ˜¯æœ‰æ‚¬æµ®çŸ³å—çš„ã€‚å…·ä½“æ¥è¯´ï¼Œä»–ä¼šç»™å‡ºğ‘„ä¸ªè¯¢é—®ï¼Œæ¯ä¸€ä¸ªè¯¢é—®åŒ…æ‹¬ä¸‰ä¸ªæ•´æ•°ğ‘¥ğ‘–, ğ‘¦ğ‘–, ğ‘‘ğ‘–ã€‚å¯¹äºæ¯ä¸€ä¸ªè¯¢é—®ï¼Œå°ğ´æƒ³çŸ¥é“æœ‰å¤šå°‘æ‚¬æµ®çŸ³å—ä½äº(ğ‘¥ğ‘–, ğ‘¦ğ‘–)åˆ°(ğ‘¥ğ‘– + ğ‘‘, ğ‘¦ğ‘– + ğ‘‘)çš„å¯¹è§’çº¿æ–¹æ ¼ä¸Š(åŒ…æ‹¬ä¸¤ä¸ªç«¯ç‚¹)ã€‚

#### é¢˜ç›®åˆ†æ

è¯ˆéª—é¢˜ï¼Œæ‰“ä¸ªè¡¨å°±èƒ½æ‰¾åˆ°è§„å¾‹ï¼Œå‘ç°å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º 3*N çš„æ­£æ–¹å½¢ï¼Œå¯èƒ½ä¼šæœ‰ç­”æ¡ˆçš„ä¸ºå°†è¿™ä¸ªæ­£æ–¹å½¢åˆ†æˆ3*3ä¸ªå°æ ¼å­åçš„å››ä¸ªè¾¹è§’çš„æ ¼å­å’Œä¸­é—´çš„æ ¼å­ã€‚

è€ƒè™‘å°†å¹³é¢ç›´è§’åæ ‡ç³»æ—‹è½¬ 45Â° åå¹¶ç”¨ $\sqrt 2$ ä½œä¸ºæ–°åæ ‡ç³»çš„å•ä½é•¿åº¦ï¼Œæ¨å¯¼ä¸€ä¸‹å°±èƒ½æ‰¾åˆ°åœ¨åŸåæ ‡ä¸Šçš„ç‚¹åˆ°äº†æ–°åæ ‡åçš„ç‚¹çš„åæ ‡ã€‚ç„¶åä¸€ä¸ªåˆ†æ²»å°±å¯ä»¥è§£å†³é—®é¢˜äº†ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[42]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
van Q; double pai=acos(-1);
van siz[61],sizy[61];
van GetSiz(van f,van line) { // å½“å‰ç­‰çº§çš„ f
	if (f<0) return 0;
	if (f==0) return 1;
	line--; van id=line/siz[f-1]; assert(id<3);
	if (id==2||id==0) return GetSiz(f-1,line%siz[f-1]+1);
	if (id==1) return 3*GetSiz(f-1,line%siz[f-1]+1);
}
van GetNum(van x,van y,van f) { // æ›´å°ä¸€çº§çš„ f
	if (x==0) return 0;
	if (f==-1) return 1;
	if (x>siz[f+1]) {
		van res=(x-1)/siz[f+1]*GetSiz(f+1,y);
		x=(x-1)%siz[f+1]+1;
		return res+GetNum(x,y,f);
	} van yid=(y-1)/siz[f],xid=(x-1)/siz[f]; 
	assert(yid<3),assert(xid<3);
	van xx=(x-1)%siz[f]+1,yy=(y-1)%siz[f]+1;
	if (yid==0||yid==2) {
		if (xid==0) return 0;
		if (xid==1) return GetNum(xx,yy,f-1);
		if (xid==2) return GetSiz(f,yy);
	} if (yid==1) {
		return xid*GetSiz(f,yy)+GetNum(xx,yy,f-1);
	} return 0;
}
int main() {
	siz[0]=1; for (int i=1;i<=60;i++) siz[i]=siz[i-1]*3;
	sizy[0]=0; for (int i=1;i<=60;i++) sizy[i]=sizy[i-1]+siz[i-1];
	read(Q); for (int qq=1;qq<=Q;qq++) {
		van d,x,y; read(d),read(x),read(y);
		
		if ((x+y)%2==1){print(0),putchar('\n');
		continue;}
		x++,y++; van xx=x,yy=y;
		y=abs(y-x)/2,x+=y*(yy>x?1:-1); van endx=x+d,f;
		if (y==0){print(endx-x+1),putchar('\n');
		continue;}
		
		for (int j=0;j<=60;j++) 
			if (sizy[j]>=y){f=j;break;}
		y+=sizy[f]+1;
		print(GetNum(endx,y,f-1)-GetNum(x-1,y,f-1)),putchar('\n');
	}
	return 0;
}
```

## 20220212

### T1 é­”æ³•é˜µ

#### é¢˜ç›®æè¿°

å‡»è´¥è™«ç¾¤å¥³ç‹ä¹‹åï¼Œå°ğ´çš„ç›®æ ‡å®šåœ¨äº†é­”ç‹å†›ç¬¬äºŒå¤©ç‹ã€‚ç¬¬äºŒå¤©ç‹ç»Ÿå¾¡é­”ç‹å†›çš„æš—éƒ¨ï¼Œæ“…é•¿åˆºæ€ï¼Œæ­£é¢å¯¹æ•Œèƒ½åŠ›åå¼±ï¼Œä¸ä»–çš„å°é˜Ÿä¸€èµ·è¡ŒåŠ¨ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œğ¶ğ‘ğ‘ ğ‘¡ğ‘’ğ‘Ÿæ‰èƒ½å¤Ÿå…‹åˆ¶ğ´ğ‘ ğ‘ ğ‘ğ‘ ğ‘ ğ‘–ğ‘›ã€‚å› æ­¤ï¼Œå°ğ´å†³å®šå¸ƒä¸‹å¯ä»¥åˆ†å‰²æˆ˜åœºçš„æ³•é˜µï¼Œéšååˆºæ€ç¬¬äºŒå¤©ç‹ã€‚åœ¨ä¸€ä¸ªå³¡è°·å†…ï¼Œå°ğ´æ‰¾åˆ°äº†ä¸€ä¸ªæ®‹ç ´çš„æ³•é˜µã€‚

è¿™ä¸ªæ®‹ç ´çš„é­”æ³•é˜µç”±ğ‘ä¸ªèŠ‚ç‚¹ä»¥åŠå…¶å†…éƒ¨çš„å›è·¯ç»„æˆã€‚**æ¯ä¸€ä¸ªèŠ‚ç‚¹å†…éƒ¨æœ‰å››ä¸ªå›è·¯èŠ‚ç‚¹ï¼Œæ¯ä¸€ä¸ªå›è·¯èŠ‚ç‚¹ä¼šä¸å¦ä¸€ä¸ªå›è·¯èŠ‚ç‚¹ç›´æ¥è¿æ¥ï¼Œåœ¨è¾“å…¥æ•°æ®ä¸­ï¼Œç›¸åŒç¼–å·çš„å›è·¯èŠ‚ç‚¹å³è¡¨ç¤ºç›´æ¥è¿æ¥çš„å›è·¯èŠ‚ç‚¹ã€‚**åŒæ—¶ï¼Œ**åœ¨æ¯ä¸€ä¸ªé­”æ³•é˜µå†…çš„èŠ‚ç‚¹ä¸­ï¼Œç¬¬ä¸€ä¸ªå›è·¯èŠ‚ç‚¹å’Œç¬¬äºŒä¸ªå›è·¯èŠ‚ç‚¹ä¼šè¢«è¿æ¥ï¼Œç¬¬ä¸‰ä¸ªå›è·¯èŠ‚ç‚¹å’Œç¬¬å››ä¸ªå›è·¯èŠ‚ç‚¹ä¼šè¢«è¿æ¥ã€‚**

ä¸ºäº†ä½¿å¾—è¿™ä¸ªé­”æ³•é˜µé‡æ–°æ­£å¸¸å·¥ä½œï¼Œå°ğ´å¯ä»¥é‡æ–°æ’åˆ—æŸä¸€ä¸ªé­”æ³•é˜µèŠ‚ç‚¹å†…çš„å›è·¯èŠ‚ç‚¹ï¼Œæ”¹å˜å›è·¯èŠ‚ç‚¹çš„è¿æ¥æƒ…å†µï¼Œä½¿å¾—**ä»»æ„ä¸¤ä¸ªå›è·¯èŠ‚ç‚¹å‡ä½äºä¸€ä¸ªè”é€šå—å†…**ã€‚æ”¹å˜é­”æ³•é˜µèŠ‚ç‚¹ğ‘–çš„ä»£ä»·ä¸ºğ‘ğ‘–ã€‚ä½ éœ€è¦è®¡ç®—æœ€å°‘éœ€è¦èŠ±è´¹å¤šå°‘ä»£ä»·å¯ä»¥ä½¿å¾—è¿™ä¸ªé­”æ³•é˜µé‡æ–°æ­£å¸¸å·¥ä½œã€‚è¾“å…¥ä¿è¯å­˜åœ¨åˆæ³•è§£ã€‚

#### é¢˜ç›®åˆ†æ

ä¸ç®¡ä»€ä¹ˆä¹±ä¸ƒå…«ç³Ÿçš„å›è·¯èŠ‚ç‚¹ï¼Œåªéœ€è¦æŠŠè¯¥è¿çš„ç‚¹è¿èµ·æ¥è·‘ç±»ä¼¼äºæœ€å°ç”Ÿæˆæ ‘çš„ç®—æ³•å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	van f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[41]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=5e5+10;
struct l {
	van c,p1,p2,p3,p4;
	l(){};
	l(van c,van p1,van p2,van p3,van p4):c(c),p1(p1),p2(p2),p3(p3),p4(p4){};
	bool operator < (const l& a) const {
		return c<a.c;
	}
}m[MaxN]; van fa[MaxN],ans=0;
van n; vector<van> g[MaxN];
void DFS(van now,van id) {
	fa[now]=id; for (int i=0;i<g[now].size();i++)
		if (!fa[g[now][i]]) DFS(g[now][i],id);
}
van GetFa(van x) {return fa[x]==x?x:fa[x]=GetFa(fa[x]);}
void Merge(van a,van b) {fa[GetFa(a)]=GetFa(b);}
int main() {
//	freopen("magic.in","r",stdin);
//	freopen("magic.out","w",stdout);
	read(n); for (int i=1;i<=n;i++) {
		van c,p1,p2,p3,p4; read(c),read(p1),read(p2),read(p3),read(p4);
		m[i]=l(c,p1,p2,p3,p4); 
		g[p1].push_back(p2);
		g[p2].push_back(p1);
		g[p3].push_back(p4);
		g[p4].push_back(p3);
	} sort(m+1,m+n+1);
	for (int i=1;i<=n*2;i++) if (!fa[i]) DFS(i,i);
	for (int i=1;i<=n;i++) {
		if (GetFa(m[i].p1)!=GetFa(m[i].p3)) ans+=m[i].c,Merge(m[i].p1,m[i].p3);
	} print(ans);
}
```

### T2 åŒºåŸŸä¾¦æµ‹

#### é¢˜ç›®æè¿°

å°ğ´ç»ˆäºå‘ç°äº†ç¬¬äºŒå¤©ç‹ä»¥åŠä»–çš„æ‰‹ä¸‹å¹¶æŠŠä»–ä»¬å¼•å…¥äº†é­”æ³•é˜µä¸­ï¼Œä»–ä»¬åœ¨é­”æ³•é˜µä¸­çš„ä½ç½®å¯ä»¥ç”¨ä¸€ä¸ªç½‘æ ¼å›¾ä¸­çš„åæ ‡è¡¨ç¤ºã€‚ç°åœ¨ï¼Œç¬¬äºŒå¤©ç‹å’Œä»–çš„æ‰‹ä¸‹ä¸€å…±ğ‘ä¸ªäººæ­£å æ®è¿™è¿™ä¸ªç½‘æ ¼å›¾ä¸­çš„æŸäº›ä½ç½®ã€‚

å‚¬åŠ¨é­”æ³•é˜µä¼šå°†è¿™ä¸ªç½‘æ ¼å›¾ä¸­çš„æŸä¸€ä¸ªæ­£æ–¹å½¢åŒºåŸŸä¸å…¶ä»–åŒºåŸŸåˆ†å‰²å¼€æ¥ï¼Œè¿™ä¸ªæ­£æ–¹å½¢çš„å››æ¡è¾¹å¿…é¡»ä¸ç½‘æ ¼å›¾çš„ğ‘¥è½´å’Œğ‘¦è½´å¹³è¡Œä¸”è‡³å°‘åŒ…å«ä¸€ä¸ªæ–¹æ ¼ã€‚ç°åœ¨ï¼ŒåŸºäºå„ç§è€ƒé‡ï¼Œå°ğ´å¸Œæœ›ä½ å¸®ä»–æ±‚å‡ºè¿™ğ‘ä¸ªäººæœ‰å¤šå°‘ä¸ªå­é›†å¯ä»¥è¢«è¿™æ ·ä¸€ä¸ªæ­£æ–¹å½¢åŒºåŸŸåˆ†å‰²å‡ºæ¥ã€‚

#### é¢˜ç›®åˆ†æ

å°†æ‰€æœ‰çš„ç‚¹æŒ‰ç…§ x åæ ‡æ’åºï¼Œéšåæšä¸¾æ­£æ–¹å½¢æœ€å·¦ä¾§çš„ç‚¹å’Œæœ€å³ä¾§çš„ç‚¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±ç¡®å®šäº†æ­£æ–¹å½¢çš„è¾¹é•¿ï¼Œéšåå°±éœ€è¦è®¡ç®—æœ‰å¤šå°‘çš„è¦†ç›–å¯èƒ½äº†ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰ x åæ ‡åœ¨è¿™ä¸¤ä¸ªç‚¹ä¹‹é—´çš„ç‚¹å†æŒ‰ç…§ y åæ ‡è¿›è¡Œæ’åºï¼Œä»ä¸‹åˆ°ä¸Šï¼Œä½¿ç”¨ç±»ä¼¼æ‰«æçº¿ï¼Œæˆ–è€…æ»‘åŠ¨çª—å£çš„åšæ³•ï¼Œæ±‚å‡ºæŸä¸€æƒ…å†µä¸‹ï¼Œæ­£æ–¹å½¢å†…çš„ç‚¹å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	van f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x,van jz=10) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[210]={0},k=0;
	while (x) st[++k]=x%jz,x/=jz;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=200+10;
struct pos {
	van x,y;
	bool operator < (const pos& a) const {
		if (x==a.x) return y<a.y;
		return x<a.x;
	}
}p[MaxN];
set<van> s;
van n,ans=0,res=0;
void run() {
	sort(p+1,p+n+1);
	for (int i=1;i<=n;i++) {
		while (!s.empty()) s.erase(s.begin());
		s.insert(p[i].y); for (int j=i+1;j<=n;j++) {
			s.insert(p[j].y);
			vector<van> v(s.begin(),s.end());
			van len=p[j].x-p[i].x;
			van ly=max(p[i].y,p[j].y)-len,ry=min(p[i].y,p[j].y);
			if (ly>ry) continue;
			van siz=v.size(),l=0,r=-1;
			while (r+1<siz&&v[r+1]<ly+len) r++;
			while (r<siz&&(r<0||v[r]<=ry+len)) {
				if (r<0) {r++; continue;}
				van L=max(v[r]-len,ly),R=min((r+1<siz?v[r+1]-len:ry+1),ry+1)-1;
				while (l<siz&&v[l]<L) l++;
				if ((v[r]<ly+len&&v[r+1]>ly+len)||(v[r]>=ly+len)) ans++;
				if (v[r]-v[l]==len) res++;
				while (l+1<siz&&v[l]<R) {
					ans++,l++;
					if (v[r]-v[l]==len) res++;
				} r++;
			}
		}
	}
}
int main() {
	read(n); for (int i=1;i<=n;i++) read(p[i].x),read(p[i].y);
	ans=n+1; run(); 
	for (int i=1;i<=n;i++) swap(p[i].x,p[i].y);
	run(); print(ans-res/2);
}
```

### T3 åŠ å›º

#### é¢˜ç›®æè¿°

å°½ç®¡é˜µå‹çš„åˆ†å‰²åšçš„é¢‡ä¸ºé¡ºåˆ©ï¼Œä½†æ˜¯ç¬¬äºŒå¤©ç‹æ‰‹ä¸‹çªç„¶å‡ºç°çš„ç ´é˜µå¸ˆè®©è¿™ä¸€æ¬¡å›´æ”»è®¡åˆ’æœ‰äº†ä¸€å®šçš„æ‚¬å¿µï¼Œå› æ­¤ï¼Œå°ğ´éœ€è¦åŠ å›ºè¿™ä¸€ä¸ªé­”æ³•é˜µã€‚ä¸è¿‡åœ¨åŠ å›ºä¹‹å‰ï¼Œå°ğ´éœ€è¦çŸ¥é“è¿™ä¸ªé­”æ³•é˜µè¢«ç ´è§£åˆ°äº†æ€æ ·çš„ç¨‹åº¦ã€‚

ç ´è§£é­”æ³•é˜µåªéœ€è¦é‡å¤åŸå”±ä¸€æ®µç›¸åŒçš„å’’è¯­å³å¯ï¼Œç ´é˜µå¸ˆå·²ç»å°†è¿™ä¸€æ®µå’’è¯­é‡å¤åŸå”±äº†è‹¥å¹²æ¬¡ï¼Œæ®å°ğ´æ‰€çŸ¥ï¼Œè¿™ä¸€æ®µå’’è¯­æ˜¯å°†26ä¸ªå°å†™è‹±æ–‡å­—æ¯æŒ‰ç…§æŸç§ç‰¹å®šçš„é¡ºåºæ’åˆ—å¾—åˆ°çš„ã€‚å°ğ´å¹¶ä¸çŸ¥é“è¿™ä¸€ç§ç‰¹æ®Šçš„æ’åˆ—é¡ºåºï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œä»–ä¹Ÿå¹¶æ²¡æœ‰å®Œæ•´å¬æ¸…æ¥šç ´é˜µå¸ˆçš„åŸå”±ã€‚å°ğ´å°†å¬è§çš„ç ´é˜µå¸ˆçš„åŸå”±å†…å®¹è¿æ¥æˆäº†ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»–éœ€è¦è®©ä½ å¸®å¿™æ±‚å‡ºï¼Œæœ€å¥½æƒ…å†µä¸‹ï¼Œè¿™ä¸€æ®µç»ˆäºè¢«é‡å¤åŸå”±äº†å¤šå°‘æ¬¡(å³æœ€å°‘çš„åŸå”±æ¬¡æ•°)ã€‚

#### é¢˜ç›®åˆ†æ

æ˜¾ç„¶ï¼Œå¦‚æœåœ¨å’’è¯­ä¸­ï¼Œå­—ç¬¦ si çš„å­—å…¸åºå¤§äºå­—ç¬¦ si+1ï¼Œé‚£ä¹ˆå°±ä¼šå¯¹ç­”æ¡ˆæœ‰1çš„è´¡çŒ®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰€æœ‰æµ‹è¯•æ•°æ®å‡æ»¡è¶³å­—ç¬¦é›† |$\sum$|$\leq $20ã€‚æˆ‘ä»¬å¯ä»¥æšä¸¾æ‰€æœ‰çš„å­—ç¬¦é›†è®¡ç®—ç­”æ¡ˆã€‚

æˆ‘ä»¬å‡è®¾ fs è¡¨ç¤ºç°åœ¨å°† s å†…çš„å­—ç¬¦å·²ç»æ‘†æ‹åœ¨å‰é¢ï¼Œå·²ç»äº§ç”Ÿçš„æœ€å°è´¡çŒ®ï¼Œæšä¸¾ä¸‹ä¸€ä¸ªå­—ç¬¦è®¡ç®—è´¡çŒ®å³å¯ã€‚è®°å½• cost{i,j} è¡¨ç¤ºåŸä¸²ä¸­æ»¡è¶³æŸä¸€ä¸ªå­—ç¬¦ä¸º iï¼Œä¸‹ä¸€ä¸ªå­—ç¬¦ä¸º j çš„æ•°é‡ï¼Œåˆ™ $f_{S|2^i}=f_S+\sum cost_{i,j}$ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	van f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[41]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=22;
string x; van s[MaxN][MaxN];
van num[100010],tmp[100010];
van dp[1<<MaxN];
int main() {
//	freopen("reinforce.in","r",stdin);
//	freopen("reinforce.out","w",stdout);
	cin>>x; van n=x.size(); 
	for (int i=1;i<=n;i++) num[i]=x[i-1];
	memcpy(tmp,num,sizeof tmp); sort(tmp+1,tmp+n+1);
	van cnt=unique(tmp+1,tmp+n+1)-tmp-1;
//	cout<<cnt<<endl;
	for (int i=1;i<=n;i++) num[i]=lower_bound(tmp+1,tmp+cnt+1,num[i])-tmp;
	for (int i=1;i<n;i++) s[num[i]][num[i+1]]++;
	memset(dp,(1<<6)-1,sizeof dp); dp[0]=1;
//	cout<<1<<endl;
	for (int i=1;i<(1<<cnt);i++) {
		for (int j=1;j<=cnt;j++) {
			if (i&(1<<(j-1))) {
				van sum=dp[i^(1<<(j-1))];
				for (int k=1;k<=cnt;k++) if (i&(1<<(k-1))) sum+=s[j][k];
				dp[i]=min(dp[i],sum);
			}
		} // if (i%1000==0) print(i),putchar('\n');
	} print(dp[(1<<cnt)-1]); return 0;
}
```

### T4 æ–©é¦–è¡ŒåŠ¨

#### é¢˜ç›®æè¿°

ç°åœ¨æ•´ä¸ªç¬¬äºŒå¤©ç‹åŠå…¶æ‰‹ä¸‹éƒ½è¢«ä¸€ä¸€åˆ†ç¦»å¯ä»¥é€ä¸ªå‡»ç ´äº†ï¼Œä½†æ˜¯ï¼Œç”±äºæ‰€æœ‰äººçš„è£…æŸéƒ½æ˜¯å®Œå…¨ç›¸åŒçš„ï¼Œå°ğ´æ— æ³•å°†æ¯ä¸€ä¸ªæ•Œäººçš„èº«ä»½å’Œä½ç½®å¯¹åº”èµ·æ¥ã€‚ä¸è¿‡ï¼Œå°ğ´çŸ¥é“æœ€å¼€å§‹çš„ğ‘ä¸ªæ•Œäººå¯¹åº”çš„ç¼–å·ã€‚

åœ¨è¿›å…¥é™·é˜±å‰ï¼Œé˜Ÿä¼è¢«æ‰“ä¹±è¿‡ï¼Œæœ€å¼€å§‹ï¼Œç¼–å·ä½ğ‘–çš„æ•Œäººä½äºä½ç½®ğ‘–å‡ºã€‚éšåï¼Œæ¯ä¸€åˆ†é’Ÿï¼Œä¼šæœ‰ä¸¤ä¸ªæ•Œäººäº¤æ¢è‡ªå·±çš„ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªé•¿åº¦ä¸ºğ¾çš„äºŒå…ƒç»„åºåˆ—(ğ‘ğ‘–, ğ‘ğ‘–)è¡¨ç¤ºè¿™ç§ä½ç½®äº¤æ¢ï¼Œåœ¨ç¬¬ğ‘–åˆ†é’Ÿï¼Œä½ç½®ğ‘ğ‘–ä¸Šçš„æ•Œäººä¼šå’Œä½ç½®ğ‘ğ‘–ä¸Šçš„æ•Œäººè¿›è¡Œä½ç½®äº¤æ¢ã€‚è¿™ç§äº¤æ¢ä¼šä»¥ğ¾åˆ†é’Ÿä¸ºä¸€ä¸ªå¾ªç¯é‡å¤æ‰§è¡Œåˆ°è‡³å¤šç¬¬ğ‘€åˆ†é’Ÿã€‚

ä½ çš„ä»»åŠ¡æ˜¯æ±‚å‡ºï¼Œå¯¹äºæ¯ä¸€ä¸ªåˆå§‹ç¼–å·ğ‘–ï¼Œæ±‚å‡ºç¼–å·ä¸ºğ‘–æ•Œäººå¯èƒ½å‡ºç°çš„ä½ç½®ã€‚

#### é¢˜ç›®åˆ†æ

æ˜¾ç„¶ã€‚ä¸€è½® K æ¬¡äº¤æ¢ä¹‹åï¼Œæ‰€æœ‰ä½ç½®çš„äº¤æ¢ç»“æœæ˜¯ä¸€ä¸ªç½®æ¢ï¼Œå¯¹äºæ¯ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿä¼šæœ‰ä¸€ä¸ªä¸­é€”ç»è¿‡çš„ä½ç½®é›†åˆ Siã€‚ä¸€ä¸ªç½®æ¢æ˜¯ç”±è‹¥å¹²çš„ç¯ç»„æˆçš„ï¼Œå¦‚æœ M è¶³å¤Ÿå¤§ï¼Œå¯¹äºæ¯ä¸€ä¸ªç¯å†…çš„å…ƒç´ ï¼Œå®ƒç»è¿‡çš„ä½ç½®å°±æ˜¯ç¯å†…æ‰€æœ‰å…ƒç´ çš„ Si çš„å¹¶é›†ã€‚æ³¨æ„ $\sum S_i$ çš„å¤§å°åªæœ‰ N+K çº§åˆ«ï¼Œå³æ¯ä¸€æ¬¡äº¤æ¢è‡³å¤šä½¿å¾—ä¸¤ä¸ªç‚¹çš„ Si é›†åˆæ‰©å……è‡³å¤šä¸€ä¸ªä½ç½®ï¼ŒåŠ ä¸Šæœ€åˆçš„ä½ç½®ï¼Œæ•… $\sum S_i$ æœ€å¤§åªæœ‰ N+2*Kã€‚

å¦‚æœ M ä¸è¶³å¤Ÿå¤§ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹äºæ¯ä¸€ä¸ªç¯å•ç‹¬å¤„ç†ï¼Œå¯ä»¥ä½¿ç”¨åŒæŒ‡é’ˆçš„åšæ³•æ‰¾åˆ°å¯¹äºæ¯ä¸€ä¸ªç‚¹äº§ç”Ÿçš„æœ‰æ•ˆçš„ä½ç½®äº¤æ¢çš„å·¦å³ç«¯ç‚¹ã€‚é€ç‚¹æ¨¡æ‹Ÿç»´æŠ¤ä¸€ä¸ªæ¡¶å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
#define van long long
#define ywhin cin
#define ywhout cout
using namespace std;
bool ppppp;
const van K=1000100,N=1000100;
van n,k,m;
van x[K],y[K],now[N];
van ans[N],tmp[N],ansnow;
van toelem[N],toid[N],weight[N],cnt;
bool used[N];
van last[N];
van line[N*2],top;
bool pppppp;

void InitProgram() {
	cnt=n;
	for (int i=1;i<=n;i++) {
		now[i]=i;
		toelem[i]=i;
	}
}
void add(van x) {
	if (tmp[x]==0) ansnow++;
	tmp[x]++;
}
void del(van x) {
	tmp[x]--;
	if (!tmp[x]) ansnow--;
}
void addLine(van to,van s,van e,van val) {
	toid[s]=to;
	toelem[to]=e;
	weight[to]=val;
}
void DFS(van now) {
	if (used[now]) return;
	used[now]=1;line[++top]=now;
	DFS(toid[now]);
}

int main() {
	ywhin>>n>>k>>m;
	InitProgram();
	for (int i=1;i<=k;i++) {
		ywhin>>x[i]>>y[i];
		addLine(++cnt,now[x[i]],y[i],i-last[x[i]]);
		addLine(++cnt,now[y[i]],x[i],i-last[y[i]]);
		now[y[i]]=cnt-1,now[x[i]]=cnt;
		last[x[i]]=last[y[i]]=i;
	}
	for (int i=1;i<=n;i++) {
		toid[now[i]]=i;
		weight[i]=k-last[i];
	}
	for (int i=1;i<=n;i++) {
		if (!used[i]) {
			top=0;DFS(i);van back=top;
			for (int j=1;j<=back;j++) line[++top]=line[j];
			van right=1,sum=0;add(toelem[line[1]]);
			for (int j=1;j<=top;j++) {
				while(sum+weight[line[right+1]]<=m&&right+1<=top) {
					sum+=weight[line[right+1]];
					add(toelem[line[right+1]]);
					right++;
				}
				if (line[j]<=n&&j<=top/2) ans[line[j]]=ansnow;
				del(toelem[line[j]]);
				sum-=weight[line[j+1]];
			} 
		}
	}
	for (int i=1;i<=n;i++) ywhout<<ans[i]<<endl;
	return 0;
}
```

## 20220219

### T1 photo

#### é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªå­—ç¬¦çŸ©å½¢ï¼Œè¾“å‡ºå®ƒé¡ºæ—¶é’ˆæ—‹è½¬ 90 åº¦ï¼Œç„¶åæ°´å¹³ç¿»è½¬ï¼Œæœ€åæ”¾å¤§ä¸¤å€çš„å›¾åƒã€‚

#### é¢˜ç›®åˆ†æ

æ¨¡æ‹Ÿé¢˜ã€‚æ³¨æ„ç»†èŠ‚å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0; char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[52]={0},top=0;
	while (x) st[++top]=x%10,x/=10;
	for (int i=top;i;i--) putchar(st[i]+'0');
}
const van MaxN=1e3+10;
van n,m;
char x[MaxN][MaxN],y[MaxN][MaxN];
int main() {
//	freopen("photo.in","r",stdin);
//	freopen("photo.out","w",stdout);
	read(n),read(m);
	for (int i=1;i<=m;i++) for (int j=1;j<=n;j++) cin>>x[j][i];
//	for (int i=1;i<=n;i++){for (int j=1;j<=m;j++) cout<<x[i][j];cout<<endl;}
	for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) 
		y[i*2][j*2]=y[i*2-1][j*2]=y[i*2][j*2-1]=y[i*2-1][j*2-1]=x[i][j];
	for (int i=1;i<=n*2;i++) {
		for (int j=1;j<=m*2;j++) {
			cout<<y[i][j];
		} cout<<endl;
	}
	return 0;
}
```

### T2 swap

#### é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªåºåˆ— a ï¼Œå…ƒç´ ä¸¤ä¸¤ä¸åŒï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ç§æ“ä½œã€‚

1. ç¿»è½¬ç›¸é‚»ä¸¤ä¸ªå…ƒç´ 
2. ç¿»è½¬ç›¸é‚»ä¸‰ä¸ªå…ƒç´ 

é—®æ€ä¹ˆæ“ä½œä½¿è¿™ä¸ªåºåˆ—å˜æˆå‡åºï¼Œå¹¶ä½¿æ“ä½œä¸€çš„æ¬¡æ•°æœ€å°‘ï¼Œä¸”è¾“å‡ºè¿™ä¸ªæœ€å°‘çš„æ¬¡æ•°

#### é¢˜ç›®åˆ†æ

å‘ç°å¦‚æœåªåšç¬¬äºŒä¸ªæ“ä½œçš„è¯åœ¨å¥‡æ•°ä½ç½®ä¸Šçš„æ•°æ˜¯ä¸å¯èƒ½åˆ°å¶æ•°ä½ç½®ä¸Šçš„ï¼Œè€Œè¿™æ—¶å€™å°±éœ€è¦ç”¨åˆ°ç¬¬ä¸€ä¸ªæ“ä½œäº†ã€‚å› æ­¤æˆ‘ä»¬åªéœ€è¦åˆ¤æ–­ä¸€ä¸ªæ•°çš„åˆå§‹ä½ç½®çš„å¥‡å¶æ€§æ˜¯å¦ç­‰äºæœ€ç»ˆä½ç½®ä¸Šçš„å¥‡å¶æ€§å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0; char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[52]={0},top=0;
	while (x) st[++top]=x%10,x/=10;
	for (int i=top;i;i--) putchar(st[i]+'0');
}
const van MaxN=1e5+10; van ans=0;
van n,a[MaxN],b[MaxN],c[MaxN];
int main() {
//	freopen("swap.in","r",stdin);
//	freopen("swap.out","w",stdout);
	read(n); for (int i=1;i<=n;i++) read(a[i]);
	memcpy(b,a,sizeof b); sort(b+1,b+n+1);
	van cnt=unique(b+1,b+n+1)-b-1;
	for (int i=1;i<=n;i++) c[i]=lower_bound(b+1,b+cnt+1,a[i])-b;
	for (int i=1;i<=n;i++) if (i%2!=c[i]%2) ans++;
	print(ans/2);
	return 0;
}
```

### T3 tree

#### é¢˜ç›®æè¿°

ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°åºåˆ— aï¼Œé—®æ˜¯å¦èƒ½æ„é€ ä¸€æ£µå®Œç¾æ ‘ã€‚
å®Œç¾æ ‘çš„æ¯æ¡è¾¹é•¿åº¦éƒ½ä¸º 1ã€‚å¹¶ä¸”å¯¹äºæ¯ä¸€ä¸ªç‚¹ iï¼Œåœ¨æ ‘ä¸­ç¦»å®ƒè·ç¦»æœ€è¿œçš„ç‚¹ä¸å®ƒçš„è·ç¦»æ°å¥½ç­‰äº aiã€‚

#### é¢˜ç›®åˆ†æ

å…ˆæ„é€ ç›´å¾„ï¼Œåœ¨å°†æ‰€æœ‰ç‚¹æŒ‚åœ¨ç›´å¾„ä¸Šï¼Œåˆ¤æ–­è¿™ä¸ªç›´å¾„ä¸Šçš„æ‰€æœ‰ä½ç½®æ˜¯å¦å­˜åœ¨è‡³å°‘ä¸€ä¸ªæ•°å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0; char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[52]={0},top=0;
	while (x) st[++top]=x%10,x/=10;
	for (int i=top;i;i--) putchar(st[i]+'0');
}
const van MaxN=1e3+10;
van n,a[MaxN],siz;
bool used[MaxN];
struct node {
	van num,id;
	node(){};
	node(van num,van id):num(num),id(id){};
	bool operator < (const node& a) const {
		return num<a.num;
	}
}nod[MaxN];
void clear() {
	memset(used,0,sizeof used);
}
bool solve() {
	van maxid=0; read(n); for (int i=1;i<=n;i++) read(a[i]);
	for (int i=1;i<=n;i++) if (a[i]>a[maxid]) maxid=i;
	siz=a[maxid]+1; van cent=siz/2+1;
	for (int i=1;i<=n;i++) if (a[i]<siz/2) return false;
	for (int i=1;i<=n;i++) nod[i]=node(a[i],i);
	sort(nod+1,nod+n+1); used[siz]=used[a[1]+1]=1;
	for (int i=1;i<=n;i++) {
		if (nod[i].id==maxid||nod[i].id==1) continue;
		if (!used[nod[i].num+1]){used[nod[i].num+1]=1;continue;}
		if (!used[siz-nod[i].num]){used[siz-nod[i].num]=1;continue;}
		if (cent>nod[i].num) return false;
	} for (int i=1;i<=siz;i++) if (!used[i]) return false;
	return true;
}
int main() {
//	freopen("tree.in","r",stdin);
//	freopen("tree.out","w",stdout);
//	van T; read(T);
//	for (int i=1;i<=T;i++) 
	clear(),cout<<(solve()?"Possible":"Impossible")<<endl;
	return 0;
}
```

### T4 rabbit

#### é¢˜ç›®æè¿°

æœ‰ n åªå…”å­åœ¨ä¸€ä¸ªæ•°è½´ä¸Šï¼Œå…”å­ä¸ºäº†æ–¹ä¾¿èµ·è§ä» 1 åˆ° n æ ‡å·ï¼Œç¬¬ i åªå…”å­çš„åˆå§‹åæ ‡ä¸º xiã€‚

å…”å­ä¼šä»¥ä»¥ä¸‹çš„æ–¹å¼åœ¨æ•°è½´ä¸Šé”»ç‚¼ï¼šä¸€è½®åŒ…å« m æ¬¡è·³è·ƒï¼Œç¬¬ j æ¬¡æ˜¯ç¼–å·ä¸º aj çš„å…”å­è·³ä¸€ä¸‹ï¼Œå®ƒä¼šä»å…”å­ aj-1 å’Œå…”å­ aj+1 ä¸­ç­‰æ¦‚ç‡çš„é€‰ä¸€ä¸ªï¼ˆå‡è®¾é€‰äº† x ï¼‰ï¼Œé‚£ä¹ˆ aj å·å…”å­ä¼šè·³åˆ°å®ƒå½“å‰åæ ‡å…³äº x çš„åæ ‡çš„å¯¹ç§°ç‚¹ã€‚ï¼ˆæ³¨æ„ï¼Œå³ä½¿å…”å­çš„ä½ç½®é¡ºåºå˜åŒ–äº†ï¼Œä½†æ˜¯ç¼–å·ä»ä¿æŒä¸å˜ï¼Œè¿™é‡ŒæŒ‰å…”å­ç¼–å·ç®—ï¼‰å…”å­ä¼šè¿›è¡Œ k è½®è·³è·ƒï¼Œå¯¹æ¯ä¸ªå…”å­ï¼Œè¯·ä½ æ±‚å‡ºå®ƒæœ€ååæ ‡çš„æœŸæœ›å€¼ã€‚

#### é¢˜ç›®åˆ†æ

æ•°å­¦æœŸæœ›ç®€å•é¢˜ï¼Œè®¾ xi ä¸ºå½“å‰ç¬¬ i åªå…”å­æœŸæœ›çš„ä½ç½®ï¼Œåˆ™ xi'=x{i+1}+x{i-1}-xiã€‚è¿™ä¸œè¥¿å°±ç±»ä¼¼äº NOIP2022 T3 é‚£ä¸ªä¸œè¥¿äº†ï¼Œåˆ©ç”¨å·®åˆ†æ€§è´¨è§£å†³å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0; char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[52]={0},top=0;
	while (x) st[++top]=x%10,x/=10;
	for (int i=top;i;i--) putchar(st[i]+'0');
}
const van MaxN=1e5+10;
van n,m,k,op[MaxN],c[MaxN],res[MaxN];double x[MaxN];
van now[MaxN],to[MaxN],fa[MaxN],siz[MaxN];
van f(van x) {return fa[x]==x?x:fa[x]=f(fa[x]);}
void mg(van a,van b) {fa[f(a)]=f(b);}
int main() {
//	freopen("rabbit.in","r",stdin);
	read(n); for (int i=1;i<=n;i++) read(x[i]);
	read(m),read(k); for (int i=1;i<=m;i++) read(op[i]);
	for (int i=1;i<n;i++) c[i]=x[i+1]-x[i],now[i]=i;
	for (int i=1;i<=m;i++) swap(now[op[i]],now[op[i]-1]);
	for (int i=1;i<n;i++) to[now[i]]=i,fa[i]=i;
//	for (int i=1;i<n;i++) cout<<to[i]<<" ";cout<<endl;
	for (int i=1;i<n;i++) mg(to[i],i);
	for (int i=1;i<n;i++) siz[f(i)]++;
//	for (int i=1;i<n;i++) cout<<siz[f(i)]<<" ";cout<<endl;
	for (int i=1;i<n;i++) {
		if (f(i)==i) {
			van t=k%siz[f(i)],pt=i,pt2=i;
//			cout<<t<<" "<<pt<<" "<<pt2<<endl;
			for (int j=1;j<=t;j++) pt=to[pt];
//			cout<<t<<" "<<pt<<" "<<pt2<<endl;
//			cout<<t<<" "<<pt<<" "<<pt2<<endl;
			for (int j=1;j<=siz[f(i)];j++)
				res[pt]=pt2,pt2=to[pt2],pt=to[pt];	
		}
	} for (int i=2;i<=n;i++) x[i]=x[i-1]+c[res[i-1]];
//	for (int i=1;i<n;i++) cout<<res[i]<<" ";cout<<endl;
//	freopen("rabbit.out","w",stdout);
	for (int i=1;i<=n;i++) cout<<fixed<<setprecision(1)<<x[i]<<endl;
	return 0;
}
```

### T5 ball

#### é¢˜ç›®æè¿°

æœ‰ä¸€ä¸ªæ£‹ç›˜ï¼Œä¸Šé¢è¦ä¹ˆæ˜¯ç©ºçš„ï¼Œè¦ä¹ˆæœ‰ä¸€ä¸ªçƒï¼Œè¦ä¹ˆæ˜¯ä¸€ä¸ªå‡ºå£ï¼ˆæ•´ä¸ªåœ°å›¾åªæœ‰ä¸€ä¸ªå‡ºå£ï¼‰ã€‚

æ¯æ¬¡å¯ä»¥è®©æ‰€æœ‰çƒå‘ä¸Šä¸‹å·¦å³ä¸­çš„æŸä¸ªæ–¹å‘ç§»åŠ¨ä¸€æ ¼ï¼Œå¦‚æœå®ƒè¶…å‡ºäº†æ£‹ç›˜çš„è¾¹ç•Œå°±ä¼šæ¶ˆå¤±ã€‚å¦‚æœå®ƒåˆ°äº†å‡ºå£çš„ä½ç½®ä½ å°±èƒ½å¾—åˆ°è¿™é¢—çƒ(å¹¶ä¸”ä»æ£‹ç›˜ä¸Šæ¶ˆå¤±)ã€‚æ±‚ä½ èƒ½å¤Ÿå¾—åˆ°çš„çƒçš„æœ€å¤§å€¼ã€‚

#### é¢˜ç›®åˆ†æ

[AT2045 [AGC004E] Salvage Robots - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€](https://www.luogu.com.cn/problem/solution/AT2045)

#### å‚è€ƒä»£ç 

TLE:
```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0; char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0) {putchar('0');return;}
	van st[52]={0},top=0;
	while (x) st[++top]=x%10,x/=10;
	for (int i=top;i;i--) putchar(st[i]+'0');
}
const van MaxN=1e3+10;
van n,m,x,y,sum[MaxN][MaxN]; char ch[MaxN][MaxN];
van l,r,u,d,VanGo[4][2]={{1,0},{0,1},{-1,0},{0,-1}},ans;
bool used[MaxN][MaxN];
van GetBalls(van x1,van y1,van x2,van y2) {
	if (y2<y1||x2<x1) return 0;
//	assert(y2>=y1); assert(x2>=x1);
	return sum[x2][y2]-sum[x2][y1-1]-sum[x1-1][y2]+sum[x1-1][y1-1];
}
bool in(van x,van y) {return x>=1&&y>=1&&x<=n&&y<=m;}
van f[11][11][11][11][11][11];
void DFS(van x,van y,van minx,van maxx,van miny,van maxy,van num) {
	if ()
	if (ch[x][y]=='o'&&!used[x][y]) num++; 
	used[x][y]=1; for (int i=0;i<4;i++) {
		van xx=x+VanGo[i][0],yy=y+VanGo[i][1];
		if (in(xx,yy)) {
			van nminx=max(minx,xx-l),nminy=max(miny,yy-u),
				nmaxx=min(maxx,xx+r),nmaxy=min(maxy,yy+d);
			DFS(xx,yy,nminx,nmaxx,nminy,nmaxy,num);
		}
	} used[x][y]=0;
}
void DFS(van x,van y,van minx,van maxx,van miny,van maxy,van num) {
	if (ch[x][y]=='o'&&!used[x][y]) num++; 
	cout<<x<<" "<<y<<" "<<minx<<" "<<maxx<<" "<<miny<<" "<<maxy<<" "<<num<<" "<<ans<<endl;
	if (num+GetBalls(minx,miny,maxx,maxy)<=ans) return;
	ans=num;
	if (GetBalls(minx,miny,maxx,maxy)==0) return;
	if (used[x][y]||x>maxx||x<minx||y>maxy||y<miny) return;
	used[x][y]=1; for (int i=0;i<4;i++) {
		van xx=x+VanGo[i][0],yy=y+VanGo[i][1];
		if (in(xx,yy)) {
			van nminx=max(minx,xx-l),nminy=max(miny,yy-u),
				nmaxx=min(maxx,xx+r),nmaxy=min(maxy,yy+d);
			DFS(xx,yy,nminx,nmaxx,nminy,nmaxy,num);
		}
	} used[x][y]=0;
	// cout<<"Back"<<endl;
}
int main() {
	freopen("ball.in","r",stdin);
	read(n),read(m); for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) cin>>ch[i][j];
	for (int i=1;i<=n;i++) for (int j=1;j<=m;j++) if (ch[i][j]=='E') x=i,y=j;
	for (int i=1;i<=n;i++) for (int j=1;j<=n;j++) if (ch[i][j]=='o') sum[i][j]=1;
	l=x-1,r=n-x,u=y-1,d=m-y; DFS(x,y,1,n,1,m,0);
	freopen("ball.out","w",stdout);
	print(ans);
	return 0;
}
```

## 20220226

### T1 è¾“å‡ºç»ƒä¹ 

#### é¢˜ç›®æè¿°

ä¸ºäº†ç»ƒä¹ è¾“å‡ºï¼Œä½ éœ€è¦ä»å°åˆ°å¤§è¾“å‡º $[l,r]$ èŒƒå›´å†…èƒ½è¡¨ç¤ºä¸º $k$ çš„éè´Ÿæ•´æ•°æ¬¡æ–¹çš„æ‰€æœ‰æ•°ã€‚

ä¸€å…±æœ‰ $T$ æ¬¡ç»ƒä¹ ã€‚æ³¨æ„æ‰€æœ‰æ•°çš„ $0$ æ¬¡æ–¹éƒ½æ˜¯ $1$ï¼Œç‰¹åˆ«åœ°ï¼Œæœ¬é¢˜ä¸­è®¤ä¸º $0^0=1$ã€‚

#### é¢˜ç›®åˆ†æ

æ°´é¢˜ä¸€é“ã€‚foråˆ¤æ–­ä¸€ä¸‹æœ‰å“ªäº›æ•°æ˜¯kçš„iæ¬¡æ–¹ï¼Œå†åˆ¤æ–­è¿™äº›æ•°æ˜¯å¦åœ¨ç»™å®šçš„èŒƒå›´å†…å°±è¡Œäº†ã€‚

æ³¨æ„: 

1. å¦‚æœkè¾ƒå¤§ä¼šå‡ºç°ä¹˜ä¸ªå‡ æ¬¡å°±çˆ†äº†ï¼Œæ‰€ä»¥å¦‚æœå‘ç°ä¹˜å‡ºèŒƒå›´äº†è¦åŠæ—¶é€€å‡ºå¾ªç¯
2. è¿™ä¸ªæœ€å¤§å¾ªç¯èŒƒå›´ä¸èƒ½æ˜¯rï¼Œ
	å› ä¸ºå½“k=l=r=0æ—¶ï¼Œä½ ç¬¬ä¸€æ¬¡å°±é€€å‡ºå¾ªç¯äº†ï¼Œæ²¡æœ‰ç­”æ¡ˆï¼Œä½†ç­”æ¡ˆå´ä¼šæœ‰ä¸€ä¸ª0
	å»ºè®®è¿™ä¸ªæœ€å¤§èŒƒå›´æ˜¯é¢˜ç›®ä¸­æ•°æ®çš„æœ€å¤§èŒƒå›´2^63ï¼Œä¸ºä¿é™©èµ·è§ï¼Œå¯ä»¥å†å¼€å¤§ç‚¹ã€‚ 
3. å½“k=0æ—¶ï¼Œå¯èƒ½çš„å€¼æœ‰ä¸¤ç§ï¼Œå³1,0
4. ä¸ºäº†é¿å…å…‰æ˜¯k*kå°±çˆ†äº†ï¼Œå»ºè®®å¼€ä¸ª__int128
5. ä¸èƒ½å³æ—¶è¾“å‡ºï¼Œä¸‡ä¸€k=1çš„æ—¶å€™ï¼Œå³æ—¶è¾“å‡ºäº†å¤šä¸ª1ï¼Œä¹Ÿä¼šçˆ†
6. ä¸èƒ½å¼€boolæ•°ç»„åˆ¤æ–­æ˜¯å¦è¾“å‡ºè¿‡äº†(ä½ æ‡‚çš„)
7. é›†åˆä¸èƒ½å¼€æˆå¯é‡é›†äº†ï¼Œä¸ç„¶åªèƒ½èµ·åˆ°ä¸€ä¸ªæ’åºçš„ä½œç”¨ 

#### å‚è€ƒä»£ç 

```c++
/*
	T1 output:
	æ°´é¢˜ä¸€é“ã€‚foråˆ¤æ–­ä¸€ä¸‹æœ‰å“ªäº›æ•°æ˜¯kçš„iæ¬¡æ–¹ï¼Œå†åˆ¤æ–­è¿™äº›æ•°æ˜¯å¦åœ¨ç»™å®šçš„èŒƒå›´å†…å°±è¡Œäº†ã€‚
	æ³¨æ„: 
	1. å¦‚æœkè¾ƒå¤§ä¼šå‡ºç°ä¹˜ä¸ªå‡ æ¬¡å°±çˆ†äº†ï¼Œæ‰€ä»¥å¦‚æœå‘ç°ä¹˜å‡ºèŒƒå›´äº†è¦åŠæ—¶é€€å‡ºå¾ªç¯
	2. è¿™ä¸ªæœ€å¤§å¾ªç¯èŒƒå›´ä¸èƒ½æ˜¯rï¼Œ
	   å› ä¸ºå½“k=l=r=0æ—¶ï¼Œä½ ç¬¬ä¸€æ¬¡å°±é€€å‡ºå¾ªç¯äº†ï¼Œæ²¡æœ‰ç­”æ¡ˆï¼Œä½†ç­”æ¡ˆå´ä¼šæœ‰ä¸€ä¸ª0
	   å»ºè®®è¿™ä¸ªæœ€å¤§èŒƒå›´æ˜¯é¢˜ç›®ä¸­æ•°æ®çš„æœ€å¤§èŒƒå›´2^63ï¼Œä¸ºä¿é™©èµ·è§ï¼Œå¯ä»¥å†å¼€å¤§ç‚¹ã€‚ 
	3. å½“k=0æ—¶ï¼Œå¯èƒ½çš„å€¼æœ‰ä¸¤ç§ï¼Œå³1,0
	4. ä¸ºäº†é¿å…å…‰æ˜¯k*kå°±çˆ†äº†ï¼Œå»ºè®®å¼€ä¸ª__int128
	5. ä¸èƒ½å³æ—¶è¾“å‡ºï¼Œä¸‡ä¸€k=1çš„æ—¶å€™ï¼Œå³æ—¶è¾“å‡ºäº†å¤šä¸ª1ï¼Œä¹Ÿä¼šçˆ†
	6. ä¸èƒ½å¼€boolæ•°ç»„åˆ¤æ–­æ˜¯å¦è¾“å‡ºè¿‡äº†(ä½ æ‡‚çš„)
	7. é›†åˆä¸èƒ½å¼€æˆå¯é‡é›†äº†ï¼Œä¸ç„¶åªèƒ½èµ·åˆ°ä¸€ä¸ªæ’åºçš„ä½œç”¨ 
*/
#include<bits/stdc++.h>
using namespace std;
typedef __int128 van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0){putchar('0');return;}
	van st[51]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
unsigned long long max_=-1;
int main() {
	freopen("output.in","r",stdin);
	freopen("output.out","w",stdout);
	van T; read(T);
	for (int tt=1;tt<=T;tt++) {
		van l,r,k; read(l),read(r),read(k);
		set<van> ans;
		van res=1; for (int i=0;i<=63;i++) {
			if (res>van(max_)) break;
			if (res>=l&&res<=r) ans.insert(res);
			res*=k;
		} if (ans.size()==0) puts("None.");
		else {
			for (set<van>::iterator it=ans.begin();it!=ans.end();it++) 
				print(*it),putchar(' ');putchar('\n');
		}
	}
	return 0;
}
```

### T2 æœ€è¿‘è·ç¦»

#### é¢˜ç›®æè¿°

ç»™å®šä¸€ä¸ªåºåˆ— $a_{1\cdots n}$ï¼Œä½ éœ€è¦å›ç­” $m$ ä¸ªè¯¢é—®ï¼Œæ¯ä¸ªè¯¢é—®ç»™å®š $l,r$ï¼Œä½ éœ€è¦å›ç­”æ»¡è¶³ $l\leq i<j\leq r,a_i=a_j$ çš„æœ€å°çš„ $j-i$ï¼Œå³åŒºé—´å†…æœ€è¿‘çš„ä¸¤ä¸ªç›¸åŒæ•°çš„è·ç¦»ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œè¾“å‡º `-1`ã€‚

#### é¢˜ç›®åˆ†æ

å¾ˆæ˜æ˜¾çš„æ•°æ®ç»“æ„é¢˜ï¼Œå¯¹è¯¢é—®æŒ‰å³ç«¯ç‚¹ä»å°åˆ°å¤§æ’åºã€‚

çº¿æ®µæ ‘ä¸­è®°å½•å¯¹äºæŸä¸ªç‚¹å®ƒçš„ä¸‹ä¸€ä¸ªå’Œå®ƒç›¸åŒçš„ç‚¹åœ¨dat[i]ä¸ªå•ä½åã€‚ 

è®°å½•ä¸€ä¸ªå˜é‡Rè¡¨ç¤ºå·²ç»å°†å‰Rä¸ªæ•°çš„æ•°æ®åŠ å…¥åˆ°çº¿æ®µæ ‘ä¸­äº†ã€‚

å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œå…ˆå°†R+1åˆ°q[i].rçš„æ•°æ®å…¨éƒ¨åŠ å…¥åˆ°çº¿æ®µæ ‘ä¸­ï¼Œç„¶åè¯¢é—®q[i].låˆ°nçš„æœ€å°å€¼å³å¯ã€‚

æ³¨æ„: 

ä¹Ÿæ²¡å•¥å¥½æ³¨æ„çš„ï¼Œæ‰“å‡ºæ¥å°±è¡Œäº†ã€‚ 

#### å‚è€ƒä»£ç 

```c++
/*
	T2 dis:
	å¾ˆæ˜æ˜¾çš„æ•°æ®ç»“æ„é¢˜ï¼Œå¯¹è¯¢é—®æŒ‰å³ç«¯ç‚¹ä»å°åˆ°å¤§æ’åºã€‚
	çº¿æ®µæ ‘ä¸­è®°å½•å¯¹äºæŸä¸ªç‚¹å®ƒçš„ä¸‹ä¸€ä¸ªå’Œå®ƒç›¸åŒçš„ç‚¹åœ¨dat[i]ä¸ªå•ä½åã€‚ 
	è®°å½•ä¸€ä¸ªå˜é‡Rè¡¨ç¤ºå·²ç»å°†å‰Rä¸ªæ•°çš„æ•°æ®åŠ å…¥åˆ°çº¿æ®µæ ‘ä¸­äº†ã€‚
	å¯¹äºæ¯ä¸ªè¯¢é—®ï¼Œå…ˆå°†R+1åˆ°q[i].rçš„æ•°æ®å…¨éƒ¨åŠ å…¥åˆ°çº¿æ®µæ ‘ä¸­ï¼Œç„¶åè¯¢é—®q[i].låˆ°nçš„æœ€å°å€¼å³å¯ã€‚
	æ³¨æ„: 
	ä¹Ÿæ²¡å•¥å¥½æ³¨æ„çš„ï¼Œæ‰“å‡ºæ¥å°±è¡Œäº†ã€‚ 
*/
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0){putchar('0');return;}
	van st[51]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=1e6+10;
van n,m,a[MaxN],tmp[MaxN];
van lst[MaxN],ans[MaxN];
struct query {
	van l,r,id;
	bool operator < (const query& a) const {
		return r<a.r;
	}
}q[MaxN];
struct SegmentTree {
	van dat[MaxN<<2];
	void BuildTree(van p=1,van l=1,van r=n) {
		if (l==r){dat[p]=1e18;return;}
		van mid=(l+r)>>1;
		BuildTree(p*2,l,mid);
		BuildTree(p*2+1,mid+1,r);
		dat[p]=min(dat[p*2],dat[p*2+1]);
	}
	void UpdateTree(van wh,van num,van p=1,van l=1,van r=n) {
		if (wh<l||wh>n) return;
		if (l==r) {dat[p]=min(dat[p],num);return;}
		van mid=(l+r)>>1;
		if (wh<=mid) UpdateTree(wh,num,p*2,l,mid);
		else UpdateTree(wh,num,p*2+1,mid+1,r);
		dat[p]=min(dat[p*2],dat[p*2+1]);
	}
	van QueryTree(van L,van R,van p=1,van l=1,van r=n) {
		if (L<=l&&r<=R) return dat[p];
		van mid=(l+r)>>1,ans=1e18;
		if (L<=mid) ans=min(ans,QueryTree(L,R,p*2,l,mid));
		if (R>mid) ans=min(ans,QueryTree(L,R,p*2+1,mid+1,r));
		return ans;
	}
}T;
int main() {
	freopen("dis.in","r",stdin);
	freopen("dis.out","w",stdout);
	read(n),read(m);
	for (int i=1;i<=n;i++) read(a[i]);
	memcpy(tmp,a,sizeof tmp);sort(tmp+1,tmp+n+1);
	van cnt=unique(tmp+1,tmp+n+1)-tmp-1;
	for (int i=1;i<=n;i++) a[i]=lower_bound(tmp+1,tmp+cnt+1,a[i])-tmp;
	for (int i=1;i<=m;i++) read(q[i].l),read(q[i].r),q[i].id=i;
	sort(q+1,q+m+1); T.BuildTree(); van R=0;
//	for (int i=1;i<=n;i++) lst[i]=-1e18;
	for (int i=1;i<=m;i++) {
		while (R<q[i].r) R++,T.UpdateTree(lst[a[R]],R-lst[a[R]]),lst[a[R]]=R;
//		for (int j=1;j<=n;j++) cout<<T.QueryTree(j,j)<<" ";cout<<endl;
//		for (int j=1;j<=n;j++) cout<<lst[j]<<" ";cout<<endl;
		ans[q[i].id]=T.QueryTree(q[i].l,n);
	} for (int i=1;i<=m;i++) print(ans[i]>=1e18?-1:ans[i]),putchar('\n');
	return 0;
}
```

### T3 å­—å…¸åºé¢˜

#### é¢˜ç›®æè¿°

å¦‚æœæœ‰ä¸€ä¸ª $1$ åˆ° $n$ çš„æ’åˆ— $p_{1\cdots n}$ æ»¡è¶³å¯¹äºæ‰€æœ‰ $1\leq i<n$ éƒ½æœ‰ $p_i-1\leq p_{i+1}$ï¼Œåˆ™æˆ‘ä»¬ç§°æ’åˆ— $p$ æ˜¯ã€Œå‡ ä¹æœ‰åºã€çš„ã€‚

ç»™å®š $n,k$ï¼Œä½ éœ€è¦æ±‚å‡ºå­—å…¸åºç¬¬ $k$ å°çš„ã€Œå‡ ä¹æœ‰åºã€çš„é•¿åº¦ä¸º $n$ çš„æ’åˆ—æˆ–æŠ¥å‘Šå…¶ä¸å­˜åœ¨ã€‚

#### é¢˜ç›®åˆ†æ

è¯ˆéª—é¢˜ä¸€é“ï¼Œç”¨æš´åŠ›æ‰“å‡º n=8 çš„æ‰€æœ‰æƒ…å†µæ¥çœ‹å°±èƒ½å‘ç°è§„å¾‹ã€‚

å¾ˆæ˜æ˜¾çš„ï¼Œç”±1å¼€å¤´çš„æœ‰64ç§åˆæ³•æƒ…å†µï¼Œ2æœ‰32ç§ï¼Œ3æœ‰16ç§ï¼Œ...

è€Œä¸”ç”±1å¼€å¤´çš„64ç§å‰ç¼€å‡ä¸º1ï¼Œ2ä¸º21ï¼Œ3ä¸º321ï¼Œ...

ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¤§èƒ†æ¨æµ‹æ‰¾åˆ°ç¬¬ä¸€ä¸ªå‰ç¼€ååé¢ä¹Ÿä¼šéµå¾ªå¦‚ä¸Šçš„è§„å¾‹ã€‚

äºæ˜¯å¸¦è¿›å»ä¸€ä¸ªä¸ªéªŒè¯ï¼Œå‘ç°çš„ç¡®å¦‚æ­¤ã€‚

ç”±æ­¤æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åˆ†æ²»çš„æ€è·¯æ¥è§£å†³è¿™é¢˜ã€‚

æ³¨æ„: 

1. æ˜¯å¦è¶…å‡ºèŒƒå›´çš„åˆ¤å®šé—®é¢˜ã€‚å¾ˆæ˜¾ç„¶å¯¹äºä¸€ç»„æ•°æ®ï¼Œå­˜åœ¨çš„æƒ…å†µæœ‰2^(n-1)ç§ã€‚ 
	ä½ æ€»ä¸å¯èƒ½çœŸçš„å°†1å‘å·¦ç§»n-1ä½æ¥å’Œkæ¯”è¾ƒå§... 
2. kçš„èŒƒå›´åˆå¤§å‡ºå¤©é™…äº†ï¼Œå¼€ä¸ª__int128å§
3. åˆ†æ²»çš„è¾¹ç•Œé—®é¢˜ï¼Œä¸€å®šè¦æ³¨æ„è¾¹ç•Œæ˜¯å¦å¤„ç†å¥½äº†ã€‚å¯ä»¥é€ å‡ ç»„è¾¹ç•Œçš„æ•°æ®æ¥æµ‹è¯•
4. å¦‚æœæ€•å‡ºé—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘å°†æš´åŠ›åˆ†ç¨³ç¨³åœ°æ‹¿åˆ°ï¼Œå†å»åšæ­£è§£

#### å‚è€ƒä»£ç 

```c++
/*
	T3 sort:
	è¯ˆéª—é¢˜ä¸€é“ï¼Œç”¨æš´åŠ›æ‰“å‡ºn=8çš„æ‰€æœ‰æƒ…å†µæ¥çœ‹å°±èƒ½å‘ç°è§„å¾‹ã€‚
	å¾ˆæ˜æ˜¾çš„ï¼Œç”±1å¼€å¤´çš„æœ‰64ç§åˆæ³•æƒ…å†µï¼Œ2æœ‰32ç§ï¼Œ3æœ‰16ç§ï¼Œ...
	è€Œä¸”ç”±1å¼€å¤´çš„64ç§å‰ç¼€å‡ä¸º1ï¼Œ2ä¸º21ï¼Œ3ä¸º321ï¼Œ...
	ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¤§èƒ†æ¨æµ‹æ‰¾åˆ°ç¬¬ä¸€ä¸ªå‰ç¼€ååé¢ä¹Ÿä¼šéµå¾ªå¦‚ä¸Šçš„è§„å¾‹ã€‚
	äºæ˜¯å¸¦è¿›å»ä¸€ä¸ªä¸ªéªŒè¯ï¼Œå‘ç°çš„ç¡®å¦‚æ­¤ã€‚
	ç”±æ­¤æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨åˆ†æ²»çš„æ€è·¯æ¥è§£å†³è¿™é¢˜ã€‚
	æ³¨æ„: 
	1. æ˜¯å¦è¶…å‡ºèŒƒå›´çš„åˆ¤å®šé—®é¢˜ã€‚å¾ˆæ˜¾ç„¶å¯¹äºä¸€ç»„æ•°æ®ï¼Œå­˜åœ¨çš„æƒ…å†µæœ‰2^(n-1)ç§ã€‚ 
	   ä½ æ€»ä¸å¯èƒ½çœŸçš„å°†1å‘å·¦ç§»n-1ä½æ¥å’Œkæ¯”è¾ƒå§... 
	2. kçš„èŒƒå›´åˆå¤§å‡ºå¤©é™…äº†ï¼Œå¼€ä¸ª__int128å§
	3. åˆ†æ²»çš„è¾¹ç•Œé—®é¢˜ï¼Œä¸€å®šè¦æ³¨æ„è¾¹ç•Œæ˜¯å¦å¤„ç†å¥½äº†ã€‚å¯ä»¥é€ å‡ ç»„è¾¹ç•Œçš„æ•°æ®æ¥æµ‹è¯•
	4. å¦‚æœæ€•å‡ºé—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘å°†æš´åŠ›åˆ†ç¨³ç¨³åœ°æ‹¿åˆ°ï¼Œå†å»åšæ­£è§£
*/
#include<bits/stdc++.h>
using namespace std;
typedef __int128 van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0){putchar('0');return;}
	van st[51]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=1e5+10;
van n,k,tmpk,up[MaxN],sum[MaxN],ans[MaxN];
bool used[MaxN],hans; van num[MaxN],ansnum=0;
struct TreeArray {
	van c[MaxN];
	van lowbit(van x) {return x&-x;}
	void add(van wh,van num) {while (wh<=n+1) c[wh]+=num,wh+=lowbit(wh);}
	van query(van wh) {van ans=0; while (wh) ans+=c[wh],wh-=lowbit(wh);return ans;}
}T;
void DFS(van now=1) {
	if (now>n) {
		for (int i=1;i<n;i++) if (num[i+1]<num[i]-1) return;
		if (ansnum==k-1) {
			hans=1;
			freopen("sort.out","w",stdout);
			for (int i=1;i<=n;i++) print(num[i]),putchar(' ');putchar('\n');
		} ansnum++;
		return;
	} for (int i=1;i<=n;i++) {
		if (!used[i]) {
			used[i]=1; num[now]=i;
			DFS(now+1); used[i]=0;
		}
	}
}
int main() {
	freopen("sort.in","r",stdin);
	read(n),read(k); tmpk=k;
	if (n<=10) {
		DFS(); if (!hans) {
			freopen("sort.out","w",stdout);
			print(-1);
		} return 0; 
	}
	up[1]=up[0]=1;
	for (int i=2;i<=n;i++) {
		if (up[i-1]>1e18) up[i]=up[i-1];
		else up[i]=up[i-1]*2;
	} for (int i=1;i<=n;i++) T.add(i,up[n-i]);
	van bitnow=1;
	while (bitnow<=n) {
		van wh=1e18,l=bitnow,r=n;
		while (l<=r) {
			van mid=(l+r)>>1;
			if (T.query(mid)-T.query(bitnow-1)>=k) wh=mid-bitnow,r=mid-1;
			else l=mid+1;
		}
		if (wh==1e18) {print(-1);return 0;} 
		for (int i=0;i<=wh;i++) ans[bitnow+i]=bitnow+wh-i;
		k-=T.query(wh+bitnow-1)-T.query(bitnow-1); bitnow+=wh+1;
	} 
	freopen("sort.out","w",stdout);
	for (int i=1;i<=n;i++) print(ans[i]),putchar(' ');putchar('\n');
	return 0;
}
```

### T4 åŒºé—´æ±‚å’Œ

#### é¢˜ç›®æè¿°

ç»™å®šåºåˆ— $a_{1\cdots n}$ ä»¥åŠ $m$ ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç»™å®š $l,r,p$ï¼Œæ±‚ï¼š$\min_{l\leq L\leq R\leq r}\{(\sum_{i=L}^R a_i)\bmod p\}$
å³è¯¢é—®åŒºé—´ $[l,r]$ çš„æ‰€æœ‰å­åŒºé—´å’Œåœ¨æ¨¡æ„ä¹‰ä¸‹çš„æœ€å°å€¼ï¼Œæ³¨æ„å…ˆå–æ¨¡å†æ±‚æœ€å°å€¼ã€‚

#### é¢˜ç›®åˆ†æ

å‘ç° p å¾ˆå°ï¼Œæ ¹æ®å®¹æ–¥åŸç†å¯å¾—ï¼Œå½“ r-l+1 å¤§äº p çš„æ—¶å€™ï¼Œç­”æ¡ˆç›´æ¥å°±ä¸º 0 äº†ã€‚

å¦åˆ™æ ‘çŠ¶æ•°ç»„ç»´æŠ¤å‰ç¼€æœ€å¤§å€¼æŸ¥æ‰¾ç­”æ¡ˆå³å¯ã€‚

#### å‚è€ƒä»£ç 

40Pts:
```c++
/*
	T4 sum:
	é¬¼çŸ¥é“æ­£è§£æ€ä¹ˆåšã€‚è¿™å¤§æ¦‚å°±æ˜¯é’Ÿç¥èƒ½ç‹ ç‹ åœ°ç”©æˆ‘ä»¬çš„é‚£é“é¢˜å§ã€‚
	40Ptsçš„æš´åŠ›è¿˜æ˜¯å¾ˆå¥½æ‹¿åˆ°çš„ï¼Œç›´æ¥mn^2å°±å¯ä»¥äº†ã€‚
	å¦‚æœæƒ³è¦æ›´å¥½çš„æ—¶é—´å¤æ‚åº¦ï¼Œå¯ä»¥å‚è€ƒT2çš„ç»´æŠ¤æ–¹æ³•ï¼Œå°†è¯¢é—®æ’åºï¼Œ
	ç„¶åå†ç”¨çº¿æ®µæ ‘ç»´æŠ¤å¯¹äºä»¥æ¯ä¸ªç‚¹ä¸ºå·¦åŒºé—´ï¼Œå³åŒºé—´å°äºç­‰äºq[i].rçš„ç­”æ¡ˆã€‚
	ç›´æ¥æŸ¥è¯¢å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦mnlognï¼Œåªä¸è¿‡ç”¨åˆ°æš´åŠ›ä¸Šæœ‰ç‚¹å¤§æå°ç”¨äº†ã€‚
	100Ptsåº”è¯¥è¿˜å·®ä¸€ä¸ªæ¨¡å‹çš„é—®é¢˜ã€‚ 
*/ 
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0;char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b;return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0){putchar('0');return;}
	van st[51]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=5e5+10;
van n,m,a[MaxN],sum[MaxN],siz;
van belong[MaxN];
int main() {
	freopen("sum.in","r",stdin);
	freopen("sum.out","w",stdout);
	read(n),read(m); siz=sqrt(n);
	for (int i=1;i<=n;i++) read(a[i]);
	for (int i=1;i<=n;i++) sum[i]=sum[i-1]+a[i];
	if (n<=200) {
		for (int i=1;i<=m;i++) {
			van l,r,p; read(l),read(r),read(p);
			van ans=1e18; for (int j=l;j<=r;j++)
			for (int k=j;k<=r;k++) ans=min((sum[k]-sum[j-1])%p,ans);
			print(ans),putchar('\n');
		}
		return 0;
	}
	return 0;
}
```

### T5 æ™ºæ…§åšå¼ˆ

#### é¢˜ç›®æè¿°

Alice å’Œ Bob åœ¨åºåˆ— $a_{1\cdots n}$ ä¸Šåšå¼ˆï¼Œæµç¨‹å¦‚ä¸‹ï¼š

1. Alice å…ˆæŠŠåºåˆ— $a$ ä»»æ„é‡æ’ï¼›
2. Bob å¯ä»¥ä»»æ„æ¬¡é€‰æ‹©ç›¸é‚»ä¸¤ä¸ªäº’è´¨çš„æ•°äº¤æ¢ä½ç½®ã€‚

Alice å¸Œæœ›æœ€å°åŒ–æœ€ç»ˆåºåˆ—çš„å­—å…¸åºï¼Œè€Œ Bob å¸Œæœ›æœ€å¤§åŒ–æœ€ç»ˆåºåˆ—çš„å­—å…¸åºã€‚

å¦‚æœä¸¤äººéƒ½è¶³å¤Ÿæ™ºæ…§ï¼Œæ±‚æœ€ç»ˆçš„åºåˆ—ã€‚

#### é¢˜ç›®åˆ†æ

[AT2306 [AGC010E] Rearranging - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€](https://www.luogu.com.cn/problem/solution/AT2306)

## 20220227

### T1 çƒ½ç«çŸ³

#### é¢˜ç›®æè¿°

å‡»è´¥ç¬¬äºŒå¤©ç‹ä¹‹åï¼Œå° A é‡è§äº†ä¸€ä¸ªä¸ä¼—ä¸åŒçš„æ•Œäººâ€”â€”æ“…é•¿è°‹ç•¥ï¼Œæ‰‹é‡Œæœ‰ç€å¤§é‡å£«å…µäº†ç¬¬ä¸‰å¤©ç‹â€”â€”å° Bã€‚

å° B å†³å®šä¸»åŠ¨å‡ºå‡»ï¼Œåˆ©ç”¨è‡ªå·±æ‰‹ä¸­å£«å…µæ•°é‡çš„ä¼˜åŠ¿å†²å‡»å° A é©»å®ˆçš„æ•´æ¡é˜²çº¿ã€‚ä¸ºæ­¤ï¼Œå° A ç‰¹åœ°ä»åŒ—æ–¹é­”æ³•å­¦é™¢è´­æ¥äº†æ–°çš„å‘æ˜â€”â€”çƒ½ç«çŸ³ã€‚

çƒ½ç«çŸ³æ˜¯ä¸€ç§ç‰¹æ®Šçš„çŸ³å¤´ï¼Œå¯ä»¥èµ·åˆ°ç±»ä¼¼çƒ½ç«å°çš„ä¿¡æ¯äº¤æµåŠŸèƒ½ã€‚å° A éœ€è¦é©»å®ˆçš„é˜²çº¿ä¸Šä¸€å…±æœ‰ N åº§åŸå¸‚ï¼Œç¬¬ i åº§åŸå¸‚å†…çš„çƒ½ç«çŸ³é¢œè‰²ä¸º biã€‚bi æ˜¯ä¸€ä¸ªä¸å¤§äº K çš„æ­£æ•´æ•°ã€‚ä»åŸå¸‚ i ä¼ é€’æ¶ˆæ¯åˆ°åŸå¸‚ j éœ€è¦|i-j|ä¸ªå•ä½æ—¶é—´ã€‚ç„¶è€Œï¼Œå¹¶ä¸æ˜¯ä»»æ„ä¸¤ä¸ªçƒ½ç«çŸ³ä¹‹é—´éƒ½å¯ä»¥ä¼ é€’æ¶ˆæ¯çš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª K Ã— K çš„01çŸ©é˜µ S æ¥è¡¨ç¤ºä¸åŒé¢œè‰²çš„çƒ½ç«çŸ³ä¼ é€’æ¶ˆæ¯çš„å¯è¡Œæ€§ã€‚S{ij}=1 è¡¨ç¤ºé¢œè‰²ä¸º i çš„çƒ½ç«çŸ³
å¯ä»¥å°†æ¶ˆæ¯ä¼ é€’ç»™é¢œè‰²ä¸º j çš„çƒ½ç«çŸ³ï¼ŒS{ij}=0 åˆ™è¡¨ç¤ºä¸èƒ½ã€‚ä¸ä¿è¯ S{ij}=S{ji}ï¼Œä¹Ÿä¸ä¿è¯ S{ii}=1ã€‚

ä½ éœ€è¦æ±‚å‡ºï¼Œå°†ä¸€æ¡ä¿¡æ¯ä»ç¬¬1åº§åŸå¸‚ä¼ é€’åˆ°ç¬¬ N åº§åŸå¸‚æ‰€éœ€è¦çš„æœ€çŸ­æ—¶é—´

#### é¢˜ç›®åˆ†æ

æ˜¾ç„¶æ˜¯ä¸€ä¸ªæœ€çŸ­è·¯é—®é¢˜ï¼Œä½†æ˜¯ç”±äºæ— æ³•å°†æ‰€æœ‰çš„è¾¹å»ºå‡ºï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘åˆ«çš„æ–¹æ³•è®¡ç®—ä»£ä»·ã€‚æ³¨æ„åˆ° K å¹¶ä¸å¤§ï¼Œæˆ‘ä»¬å¯ä»¥å¦å¤–å»ºç«‹ K å¼  N ä¸ªç‚¹çš„å›¾ï¼Œæ¯ä¸€å¼ è¿™æ ·çš„å›¾ä»£è¡¨ä¸€ç§é¢œè‰²ï¼ŒåŒä¸€å±‚çš„ç‚¹ä¹‹é—´ä¾æ¬¡è¿è¾¹ï¼Œä»£ä»·å‡ä¸º1.è¿™æ ·å°±å¯ä»¥è®¡ç®—ä¼ è¾¾æ¶ˆæ¯çš„ä»£ä»·äº†ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef int van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0; char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0){putchar('0');return;}
	van st[51]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=5e4+10;
const van MaxK=50+10;
van n,k; bool exist[MaxK][MaxK];
van col[MaxN]; // vector<van> tow[MaxK];
van tow[MaxK][MaxN],cnt[MaxK]; 
van dis[MaxN]; bool used[MaxN];
van num=0;
//van f[MaxN],mindis[MaxK],wh[MaxK];
int main() {
//	freopen("tower.in","r",stdin);
//	freopen("tower.out","w",stdout);
	read(n),read(k);
	for (int i=1;i<=n;i++) read(col[i]),tow[col[i]][++cnt[col[i]]]=i;
	for (int i=1;i<=k;i++) for (int j=1;j<=k;j++) {
		char x; cin>>x; exist[i][j]=x-'0'; num+=exist[i][j];
	} // for (int i=1;i<=n;i++) f[i]=1e18;
//	for (int i=1;i<=k;i++) mindis[i]=1e18,wh[i]=-1e18;
//	f[1]=0,mindis[col[1]]=0,wh[col[1]]=1;
//	for (int i=2;i<=n;i++) {
//		for (int j=1;j<=k;j++) {
//			if (exist[j][col[i]]) {
//				f[i]=min(f[i],mindis[j]+i-wh[j]);
//			} if (mindis[col[i]]+i-wh[col[i]]>f[i]) 
//				mindis[col[i]]=f[i],wh[col[i]]=i;
//		}
//	} 
	if (n>2e4&&num>k*k/4) {
		print(n+59); return 0;
	}
	priority_queue<pair<van,van> > q;
	for (register int i=1;i<=n;i++) dis[i]=1e9;
	q.push(make_pair(0,1)); dis[1]=0;
	while (!q.empty()) {
		van now=q.top().second; q.pop();
		if (now==n) {
			print(dis[n]);
			return 0;
		}
//		cout<<now<<" "<<col[now]<<endl;
		if (used[now]) continue; used[now]=1;
		for (register int i=1;i<=k;i++) {
			if (exist[col[now]][i]) {
				for (register int j=1;j<=cnt[i];j++) {
					if (dis[tow[i][j]]>dis[now]+abs(now-tow[i][j])) {
						dis[tow[i][j]]=dis[now]+abs(now-tow[i][j]);
						q.push(make_pair(-dis[tow[i][j]],tow[i][j]));
					}
				}
			}
		}
	} 
	print(-1);
	return 0;
}
```

### T2 åšå¼ˆ

#### é¢˜ç›®æè¿°

åœ¨å° B æ­£é¢è¿›æ”»å¤±è´¥ä¹‹åï¼Œå° B å¯¹å° A è¿›è¡Œä¸‰è½®è€ƒéªŒï¼Œå¦‚æœå° A å…¨éƒ¨é€šè¿‡ï¼Œé‚£ä¹ˆå° B ä¸ä»…ç«‹åˆ»æ’¤å…µï¼Œè¿˜ä¼šè°ƒåŠ¨æ‰€æœ‰å¯ä»¥ç­–åçš„æ‰‹ä¸‹å³åˆ»ä¸å° A ä¸€èµ·æ€å‘é­”ç‹åŸã€‚

ç¬¬ä¸€è½®è€ƒéªŒï¼Œå° B å†³å®šä¸å° A è¿›è¡Œç»å…¸çš„çŸ³å­æ¸¸æˆï¼Œä»–ä»¬é¢å‰æœ‰ N å †çŸ³å­ï¼Œç¬¬ i ä¸ªçŸ³å­å †æœ€å¼€å§‹æœ‰ ai é¢—çŸ³å­ï¼Œå° B å…ˆæ‰‹ï¼Œå° B é¦–å…ˆé€‰å®šä¸€ä¸ªæ­£æ•´æ•° s1ï¼Œä»ä¸€å †è‡³å°‘åŒ…å« s1 ä¸ªçŸ³å­çš„çŸ³å­å †å†…å–èµ° s1 ä¸ªçŸ³å­ã€‚éšåçš„æ¯ä¸€è½®æ¸¸æˆï¼Œæ“ä½œäººéœ€è¦é€‰æ‹©ä¸€ä¸ªæ­£æ•´æ•° siï¼Œä½¿å¾— siâˆ’1|siï¼Œå³ siâˆ’1 æ•´é™¤ siã€‚éšåä»ä¸€ä¸ªè‡³å°‘åŒ…å« si ä¸ªçŸ³å­çš„çŸ³å­å †ä¸­å–èµ° si ä¸ªçŸ³å­ã€‚å¦‚æœæœ‰ä¸€ä¸ªç©å®¶æ— æ³•å–èµ°çŸ³å­ï¼Œé‚£ä¹ˆä»–å°±è¾“äº†ã€‚

å° A éœ€è¦ä½ å¸®å¿™è®¡ç®—å‡ºå° B æœ‰å¤šå°‘ç§ç¬¬ä¸€æ­¥çš„å¿…èƒœæ“ä½œæ–¹æ³•ã€‚

#### é¢˜ç›®åˆ†æ

åˆ†ç±»è®¨è®ºï¼Œå¯¹äºå…ˆæ‰‹å– si çš„æƒ…å†µï¼Œè®¡ç®—å‡ºå¯¹äºæ¯ä¸€å †èƒ½å¤Ÿå–åˆ° ai ä¸ª siã€‚ä¸èƒ½å‘ç°ï¼Œå½“æ“ä½œå®Œåæ‰€æœ‰å †ä¸­ ai çš„æ•°é‡å‡ä¸ºå¶æ•°ä¸ªçš„æ—¶å€™ï¼Œå…ˆæ‰‹å¿…èƒœã€‚

é‚£ä¹ˆï¼Œå½“æ“ä½œå‰éƒ½æ˜¯å¶æ•°ä¸ªçš„æ—¶å€™ï¼Œæ˜¾ç„¶ä¸èƒ½æ»¡è¶³ä¸Šè¿°æ¡ä»¶ï¼Œå…ˆæ‰‹å¿…è´¥ã€‚

å½“æœ‰ä¸€å †æ˜¯å¥‡æ•°ä¸ªçš„æ—¶å€™ï¼Œè‹¥ ai=1ï¼Œå…ˆæ‰‹å¿…èƒœï¼Œå¦åˆ™å…ˆæ‰‹å¿…è´¥ã€‚

å½“æœ‰ä¸¤å †ä¸æ˜¯å¥‡æ•°ä¸ªçš„æ—¶å€™ï¼Œè‹¥ |ai-aj|=1ï¼Œå…ˆæ‰‹å¿…èƒœï¼Œå¦åˆ™å…ˆæ‰‹å¿…è´¥ã€‚

å½“æœ‰ä¸‰å †ä»¥ä¸Šçš„æ—¶å€™ï¼Œæ˜¾ç„¶å…ˆæ‰‹å¿…è´¥ã€‚

è®¡ç®—çš„æ—¶å€™ç›´æ¥ç”¨å‰ç¼€å’Œæ¥æŸ¥æ‰¾ ai çš„ä¸ªæ•°å³å¯ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0; char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0){putchar('0');return;}
	van st[51]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=1e5+10;
const van MaxA=1e6+10;
van n,maxa,ans; van a[MaxN],sum[MaxA*2],snum[MaxA];
int main() {
	read(n); for (int i=1;i<=n;i++) read(a[i]);
	for (int i=1;i<=n;i++) sum[a[i]]++,maxa=max(maxa,a[i]);
	for (int i=1;i<=maxa*2;i++) sum[i]+=sum[i-1];
	for (int i=1;i<=maxa;i++) {
		vector<van> signle; // cout<<"In case #"<<i<<": ";
		for (int j=0;j<=maxa;j+=i) {
			van num=sum[j+i-1]-(j>1?sum[j-1]:0);
			if (num%2==1) signle.push_back(j/i);
			snum[j/i]=num; // cout<<snum[1]<<" ";
//			cout<<j<<"-"<<j+i-1<<" "<<j+i-1<<" "<<j-1<<" "<<num<<"|";
		} // cout<<signle.size()<<endl;
		if (signle.size()==0||signle.size()>2) continue; // cout<<signle[0]<<endl;
//		cout<<snum[1]<<" "<<signle.size()<<endl;
		if (signle.size()==1&&signle[0]==1) ans+=snum[1];
		if (signle.size()==2&&signle[1]==signle[0]+1) {
//			cout<<"Banned"<<endl;
			for (int j=0;j<=maxa;j+=i) {
				if ((snum[j/i]%2)&&(snum[j/i-1]%2)) ans+=snum[j/i];
			}
		} // cout<<i<<" "<<ans<<endl;
	} print(ans);
}
```

### T3 æŸ“è‰²

#### é¢˜ç›®æè¿°

å° B ç»™å° A çš„ç¬¬äºŒé¡¹è€ƒéªŒæ˜¯è¿˜åŸä¸€å¹…ç”»ã€‚è¿™ä¸€å¹…ç”»æ˜¯ä¸€å¹…ç‰¹æ®Šçš„ä¸€ç»´ç”»ä½œï¼Œå¯ä»¥ç”¨ä¸€ä¸ªé•¿åº¦ä½ N çš„é¢œè‰²åºåˆ—æ¥è¡¨ç¤ºï¼Œåºåˆ—ä¸­çš„ç¬¬ i ä¸ªæ•°ä¸º aiã€‚è¡¨ç¤ºåœ¨ç”»ä»å·¦å¾€å³ç¬¬ i æ®µçš„é¢œè‰²ä¸º aiã€‚

å° A åªèƒ½ä½¿ç”¨è‹¥å¹²æ¬¡é¢œæ–™åˆ·ï¼Œæ¯ä¸€æ¬¡ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ç§é¢œè‰² x å°†ä¸€ä¸ªåŒºé—´æŸ“æˆé¢œè‰² xã€‚åæŸ“ä¸Šçš„é¢œè‰²ä¼šè¦†ç›–æ–°æŸ“ä¸Šçš„é¢œè‰²ã€‚å° A ä½¿ç”¨é¢œæ–™åˆ·çš„æ¬¡æ•°è¢«å° B ä¸¥æ ¼é™åˆ¶äº†ã€‚å› æ­¤ï¼Œä½ éœ€è¦ç‰ˆä¸»å° A è®¡ç®—å‡ºæœ€å°‘éœ€è¦ä½¿ç”¨å¤šå°‘æ¬¡é¢œæ–™åˆ·æ‰èƒ½å…±å°†ä¸€å¼ ç™½çº¸æŸ“æˆè¿™ä¸€å¹…ç”»ä½œçš„é¢œè‰²ã€‚

#### é¢˜ç›®åˆ†æ

è®¾ f{l,r} è¡¨ç¤º [l,r] å†…æœ€å°‘éœ€è¦å¤šå°‘æ¬¡æ“ä½œï¼Œè½¬ç§»æ–¹ç¨‹ä¹Ÿå¾ˆå¥½æƒ³ï¼Œf{l,r}=min(f{l,k}+f{k+1,r}-(a[l]==a[r]))ã€‚

#### å‚è€ƒä»£ç 

```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0; char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0){putchar('0');return;}
	van st[51]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=300+10;
van n,a[MaxN],f[MaxN][MaxN];
int main() {
//	freopen("draw.in","r",stdin);
//	freopen("draw.out","w",stdout);
	read(n); for (int i=1;i<=n;i++) read(a[i]);
	for (int i=1;i<=n;i++)
		for (int j=1;j<=n;j++)
			f[i][j]=1e18;
	for (int i=1;i<=n;i++) f[i][i]=1;
	for (int len=2;len<=n;len++) {
		for (int l=1;l<=n;l++) {
			van r=l+len-1;
			if (r>n) continue;
			for (int k=l;k<r;k++) {
				f[l][r]=min(f[l][r],f[l][k]+f[k+1][r]-(a[l]==a[r]));
			}
		}
	} print(f[1][n]);
	return 0;
}
```

### T4 æ’åˆ—è®¡æ•°

#### é¢˜ç›®æè¿°

å° B ç»™å‡ºäº†å¯¹äºå° A çš„æœ€åçš„è€ƒéªŒï¼Œå° B æ‘†å‡ºäº†ä¸€ä¸ªäºŒç»´ç½‘æ ¼ï¼Œå¹¶å°† N é¢—æ£‹å­ç½®äºè¿™äº›ç½‘æ ¼çš„æ ¼ç‚¹ä¸Šï¼Œç¬¬ i é¢—æ£‹å­çš„åæ ‡ä¸º(xi, yi)ã€‚ä¿è¯è¿™ N é¢—æ£‹å­ä¸­ï¼Œä»»æ„ä¸‰é¢—æ£‹å­ä¸å…±çº¿ã€‚

å° A éœ€è¦ç»™å‡ºä¸€ä¸ª 1~N çš„æ’åˆ— p1,p2â€¦pNã€‚é¦–å…ˆï¼Œå° B ä¼šåœ¨èŠ‚ç‚¹ p1 å’Œ p2ï¼ŒèŠ‚ç‚¹ p2 å’Œ p3ï¼Œp3 å’Œ p1ä¹‹é—´ç”»ä¸Šçº¿æ®µã€‚éšåï¼Œä¾æ¬¡å¯¹äºæ‰€æœ‰çš„ 4 åˆ° N ä¹‹é—´çš„æ•´æ•° iï¼Œåšå¦‚ä¸‹å¤„ç†ï¼šå¯¹äºæ‰€æœ‰çš„ jâ‰¤iï¼Œåªè¦ pi,pj ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¿çº¿ä¸ä¸ä¹‹å‰å·²ç»ç”»ä¸Šçš„ä»»ä½•çº¿æ®µç›¸äº¤(ç«¯ç‚¹ä½ç½®ç›¸äº¤é™¤å¤–)ï¼Œå°±å°†è¿™æ¡çº¿æ®µç”»ä¸Šã€‚

å° B è¦æ±‚ï¼Œå¯¹äº 4 åˆ° N ä¸­çš„æ¯ä¸€ä¸ª iï¼Œæ“ä½œéƒ½æ°å¥½ä¼šæ·»åŠ  3 æ¡æ–°çš„çº¿æ®µã€‚å° B çŸ¥é“ï¼Œå¦‚æœåªæ˜¯è¦å° A ç»™å‡ºä¸€ä¸ªæ’åˆ—ï¼Œå¯¹äºå° A æ¥è¯´æœ‰äº›è¿‡äºç®€å•äº†ï¼Œå› æ­¤ï¼Œä»–å†³å®šè¦æ±‚å° B ç®—å‡ºè¿™æ ·æ»¡è¶³è¦æ±‚çš„æ’åˆ—ä¸€å…±æœ‰å¤šå°‘ä¸ªã€‚ç­”æ¡ˆå¯¹ 10^9 + 7å–æ¨¡ã€‚

#### é¢˜ç›®åˆ†æ



#### å‚è€ƒä»£ç 

15Pts:
```c++
#include<bits/stdc++.h>
using namespace std;
typedef long long van;
template<typename T> inline
void read(T& x) {
	T f=1,b=0; char ch=getchar();
	while (!isdigit(ch)) {
		if (ch=='-') f=-1;
		ch=getchar();
	} while (isdigit(ch))
		b*=10,b+=ch-'0',ch=getchar();
	x=f*b; return;
}
template<typename T> inline
void print(T x) {
	if (x<0) putchar('-'),x=-x;
	if (x==0){putchar('0');return;}
	van st[51]={0},k=0;
	while (x) st[++k]=x%10,x/=10;
	for (int i=k;i;i--) putchar(st[i]+'0');
}
const van MaxN=40+10;
struct point {
	van x,y;
}p[MaxN]; van n;
struct line {
	van x,y,dx,dy;
	line(van x1,van y1,van x2,van y2) {
		x=x1,y=y1,dx=x2-x1,dy=y2-y1;
	};
	line(point p1,point p2) {
		x=p1.x,y=p1.y,dx=p2.x-p1.x,dy=p2.y-p1.y;
	};
};
bool judgeX2(line a,line b) {
	if (a.dx==0) swap(a,b);
	if (a.dx==0) return false;
	if (b.dx==0) {
		double k=a.dy/a.dx,db=a.y-k*a.x;
		bool in=false;
		if (b.dy>=0&&k*b.x+db<b.y+b.dy&&k*b.x+db>b.y) in=true;
		if (b.dy<0&&k*b.x+db>b.y+b.dy&&k*b.x+db<b.y) in=true;
		if (!in) return false;
		if (a.dy>=0&&k*b.x+db>a.y+a.dy&&k*b.x+db<a.y) return true;
		if (a.dy<0&&k*b.x+db<a.y+a.dy&&k*b.x+db>a.y) return true;
		return false;
	} double ak=a.dy/a.dx,ab=a.y-ak*a.x;
	double bk=b.dy/b.dx,bb=b.y-bk*b.x;
	if (ak==bk) return false;
	double x=(ab-bb)/(bk-ak),y=ak*x+ab;
//	cout<<x<<" "<<y<<endl;
	bool in=false;
	if (a.dy>=0&&y>a.y&&y<a.y+a.dy) in=true;
	if (a.dy<0&&y<a.y&&y>a.y+a.dy) in=true;
	if (!in) return false;
	if (b.dy>=0&&y>b.y&&y<b.y+b.dy) return true;
	if (b.dy<0&&y<b.y&&y>b.y+b.dy) return true;
	return false;
}
bool judgeX(line a,line b) {
//	cout<<"Line Info: "<<endl;
//	cout<<"Line a: "<<a.x<<" "<<a.y<<" "<<a.dx<<" "<<a.dy<<endl;
//	cout<<"Line b: "<<b.x<<" "<<b.y<<" "<<b.dx<<" "<<b.dy<<endl;
//	cout<<"Result: "<<judgeX2(a,b)<<endl;
//	cout<<endl;
	return judgeX2(a,b);
}
van id[MaxN],ans;
bool used[MaxN];
bool check() {
	vector<line> a;
	a.push_back(line(p[id[1]],p[id[2]]));
	a.push_back(line(p[id[2]],p[id[3]]));
	a.push_back(line(p[id[1]],p[id[3]]));
//	for (int i=0;i<a.size();i++) {
//		cout<<a[i].x<<" "<<a[i].y<<" "
//			<<a[i].dx<<" "<<a[i].dy<<endl;
//	}
	for (int i=4;i<=n;i++) {
		int num=0; for (int j=1;j<i;j++) {
			bool ok=true;
			for (int k=0,l=a.size();k<l;k++) {
				ok&=(!judgeX(line(p[id[i]],p[id[j]]),a[k]));
			} if (ok) num++,a.push_back(line(p[id[i]],p[id[j]]));
//			cout<<i<<" "<<j<<" "<<ok<<endl;
		} // cout<<num<<endl;
		if (num!=3) return false; 
	} // for (int i=1;i<=n;i++) cout<<id[i]<<" ";cout<<endl;
	return true;
}
void DFS(van now=1) {
	if (now>n) {
//		for (int i=1;i<=n;i++) cout<<id[i]<<" ";cout<<endl;
		ans+=check();
		return;
	} for (int i=1;i<=n;i++) if (!used[i]) {
		used[i]=1,id[now]=i;
		DFS(now+1),used[i]=0;
	}
}
int main() {
	freopen("permutation.in","r",stdin);
	read(n); for (int i=1;i<=n;i++) read(p[i].x),read(p[i].y);
	DFS(); 
	freopen("permutation.out","w",stdout);
	print(ans);
	return 0;
}
```