cmVxdWlyZSAnb2N0b2tpdC9jbGllbnQnCnJlcXVpcmUgJ29jdG9raXQvZW50\nZXJwcmlzZV9hZG1pbl9jbGllbnQnCnJlcXVpcmUgJ29jdG9raXQvZW50ZXJw\ncmlzZV9tYW5hZ2VtZW50X2NvbnNvbGVfY2xpZW50JwpyZXF1aXJlICdvY3Rv\na2l0L2RlZmF1bHQnCgojIFJ1YnkgdG9vbGtpdCBmb3IgdGhlIEdpdEh1YiBB\nUEkKbW9kdWxlIE9jdG9raXQKCiAgY2xhc3MgPDwgc2VsZgogICAgaW5jbHVk\nZSBPY3Rva2l0OjpDb25maWd1cmFibGUKCiAgICAjIEFQSSBjbGllbnQgYmFz\nZWQgb24gY29uZmlndXJlZCBvcHRpb25zIHtDb25maWd1cmFibGV9CiAgICAj\nCiAgICAjIEByZXR1cm4gW09jdG9raXQ6OkNsaWVudF0gQVBJIHdyYXBwZXIK\nICAgIGRlZiBjbGllbnQKICAgICAgcmV0dXJuIEBjbGllbnQgaWYgZGVmaW5l\nZD8oQGNsaWVudCkgJiYgQGNsaWVudC5zYW1lX29wdGlvbnM/KG9wdGlvbnMp\nCiAgICAgIEBjbGllbnQgPSBPY3Rva2l0OjpDbGllbnQubmV3KG9wdGlvbnMp\nCiAgICBlbmQKCiAgICAjIEVudGVycHJpc2VBZG1pbkNsaWVudCBjbGllbnQg\nYmFzZWQgb24gY29uZmlndXJlZCBvcHRpb25zIHtDb25maWd1cmFibGV9CiAg\nICAjCiAgICAjIEByZXR1cm4gW09jdG9raXQ6OkVudGVycHJpc2VBZG1pbkNs\naWVudF0gQVBJIHdyYXBwZXIKICAgIGRlZiBlbnRlcnByaXNlX2FkbWluX2Ns\naWVudAogICAgICByZXR1cm4gQGVudGVycHJpc2VfYWRtaW5fY2xpZW50IGlm\nIGRlZmluZWQ/KEBlbnRlcnByaXNlX2FkbWluX2NsaWVudCkgJiYgQGVudGVy\ncHJpc2VfYWRtaW5fY2xpZW50LnNhbWVfb3B0aW9ucz8ob3B0aW9ucykKICAg\nICAgQGVudGVycHJpc2VfYWRtaW5fY2xpZW50ID0gT2N0b2tpdDo6RW50ZXJw\ncmlzZUFkbWluQ2xpZW50Lm5ldyhvcHRpb25zKQogICAgZW5kCgogICAgIyBF\nbnRlcnByaXNlTWFuYWdlbWVudENvbnNvbGVDbGllbnQgY2xpZW50IGJhc2Vk\nIG9uIGNvbmZpZ3VyZWQgb3B0aW9ucyB7Q29uZmlndXJhYmxlfQogICAgIwog\nICAgIyBAcmV0dXJuIFtPY3Rva2l0OjpFbnRlcnByaXNlTWFuYWdlbWVudENv\nbnNvbGVDbGllbnRdIEFQSSB3cmFwcGVyCiAgICBkZWYgZW50ZXJwcmlzZV9t\nYW5hZ2VtZW50X2NvbnNvbGVfY2xpZW50CiAgICAgIHJldHVybiBAZW50ZXJw\ncmlzZV9tYW5hZ2VtZW50X2NvbnNvbGVfY2xpZW50IGlmIGRlZmluZWQ/KEBl\nbnRlcnByaXNlX21hbmFnZW1lbnRfY29uc29sZV9jbGllbnQpICYmIEBlbnRl\ncnByaXNlX21hbmFnZW1lbnRfY29uc29sZV9jbGllbnQuc2FtZV9vcHRpb25z\nPyhvcHRpb25zKQogICAgICBAZW50ZXJwcmlzZV9tYW5hZ2VtZW50X2NvbnNv\nbGVfY2xpZW50ID0gT2N0b2tpdDo6RW50ZXJwcmlzZU1hbmFnZW1lbnRDb25z\nb2xlQ2xpZW50Lm5ldyhvcHRpb25zKQogICAgZW5kCgogICAgcHJpdmF0ZQoK\nICAgIGRlZiByZXNwb25kX3RvX21pc3Npbmc/KG1ldGhvZF9uYW1lLCBpbmNs\ndWRlX3ByaXZhdGU9ZmFsc2UpCiAgICAgIGNsaWVudC5yZXNwb25kX3RvPyht\nZXRob2RfbmFtZSwgaW5jbHVkZV9wcml2YXRlKSB8fAogICAgICBlbnRlcnBy\naXNlX2FkbWluX2NsaWVudC5yZXNwb25kX3RvPyhtZXRob2RfbmFtZSwgaW5j\nbHVkZV9wcml2YXRlKSB8fAogICAgICBlbnRlcnByaXNlX21hbmFnZW1lbnRf\nY29uc29sZV9jbGllbnQucmVzcG9uZF90bz8obWV0aG9kX25hbWUsIGluY2x1\nZGVfcHJpdmF0ZSkKICAgIGVuZAoKICAgIGRlZiBtZXRob2RfbWlzc2luZyht\nZXRob2RfbmFtZSwgKmFyZ3MsICZibG9jaykKICAgICAgaWYgY2xpZW50LnJl\nc3BvbmRfdG8/KG1ldGhvZF9uYW1lKQogICAgICAgIHJldHVybiBjbGllbnQu\nc2VuZChtZXRob2RfbmFtZSwgKmFyZ3MsICZibG9jaykKICAgICAgZWxzaWYg\nZW50ZXJwcmlzZV9hZG1pbl9jbGllbnQucmVzcG9uZF90bz8obWV0aG9kX25h\nbWUpCiAgICAgICAgcmV0dXJuIGVudGVycHJpc2VfYWRtaW5fY2xpZW50LnNl\nbmQobWV0aG9kX25hbWUsICphcmdzLCAmYmxvY2spCiAgICAgIGVsc2lmIGVu\ndGVycHJpc2VfbWFuYWdlbWVudF9jb25zb2xlX2NsaWVudC5yZXNwb25kX3Rv\nPyhtZXRob2RfbmFtZSkKICAgICAgICByZXR1cm4gZW50ZXJwcmlzZV9tYW5h\nZ2VtZW50X2NvbnNvbGVfY2xpZW50LnNlbmQobWV0aG9kX25hbWUsICphcmdz\nLCAmYmxvY2spCiAgICAgIGVuZAoKICAgICAgc3VwZXIKICAgIGVuZAoKICBl\nbmQKZW5kCgpPY3Rva2l0LnNldHVwCg==