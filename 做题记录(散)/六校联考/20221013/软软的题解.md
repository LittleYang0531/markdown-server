# T4 软软的(soft)

## 题目描述

有一棵 $n$ 个节点的树，你需要对于 $x = 1, 2, ..., k$，求出将整棵树分为 $x$ 个联通块，且每个连通块内节点编号都是连续的的方案数。

$n\leq 2\times 10^5, k\leq 400$。

## 题目分析

直接一遍 DFS 求出每个点的父节点是哪个。我们发现，如果一个 $[l, r]$ 是在一个连通块上的话，那么 $[l, r]$ 上所有节点的父亲只有一个是不在 $[l, r]$ 范围内的。

可以维护一棵线段树，对于每个点，求出这个点之后的第二个父亲节点 $<i$ 的节点是 $y$，那么以 $i$ 为左区间，右区间的最大值为 $y - 1$。

然后就可以用一个简单的 $\mathcal{O}(n^2k)$ 的时间复杂度的 DP 来求出最终的答案。

使用树状数组优化就可以做到 $\mathcal{O}(nk\log n)$ 的时间复杂度，实测需要 15s 跑完大数据。

使用前缀和优化就可以做到 $\mathcal{O}(nk)$ 的时间复杂度，1s 便可跑完大数据。

## 参考代码

```cpp

```