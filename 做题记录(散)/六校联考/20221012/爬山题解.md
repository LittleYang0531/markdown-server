# T3 爬山 (climb)

## 题目描述

小 L 喜欢爬山，但是小 L 不喜欢正常的爬山，他喜欢用喷气背包爬山。

如果小 L 当前在 $(x, y)$，他可以花费 4 的代价到达 $(x - 1, y + 1), (x, y + 1), (x + 1, y + 1)$，或花费 2 的代价到达 $(x - 1, y), (x + 1, y)$，或花费 1 的代价到达 $(x - 1, y - 1), (x, y - 1), (x + 1, y - 1)$。

山可以用一个高度序列 $\\{h_n\\}$ 表示，由于被山阻挡，小 L 不能到达 $(x, y)$，其中 $(y < h_x)$

小 L 有若干个询问，每个询问形如如果要从 $(i, h_i)$ 到达 $j, h_j$，最少需要多少代价。

$1\leq n, m\leq 2\times 10^5$

## 题目分析

首先我们很容易想到一个策略: 

找到当前区间最高的一个山，分别从起点和终点走到那个区间，计算最后最小代价之和即可。

然后我们又可以发现，我们应该尽量斜着走，这样就可以尽量节省我们的代价。

因此我们最终走的策略就是先斜着走，再向上走，再斜着走，再向上走，...，最后可能会横着走到最高的山。

画个图就是下面的情况: 

![](https://lyindex.vercel.app/raw/LittleYang0531/image/master/blog/2.jpg)

我们发现，如果先走所有向上的操作，再走所有斜上上走的操作，最后再横着走，实际上就是直接走到最远的那个绿色的那根线，然后沿着绿色的那根线走，最后再脱离绿色的线横着走。

因此用线段树维护区间内最远的那根线是啥，然后按照上述方法计算答案即可。

时间复杂度 $\mathcal{O}((n + q)\log n)$

## 参考代码

