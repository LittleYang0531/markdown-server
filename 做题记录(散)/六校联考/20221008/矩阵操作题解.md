# T1 矩阵操作(matrix)

## 题目描述

给定一个 $m\times n$ 的矩阵 $A$。
你要支持以下几个操作：

- `1 i l r c` ：令矩阵 $A$ 中第 $i$ 行、第 $l$ 到 $r$ 列的所有元素增加 $c(|c|\leq 10^4)$。
- `2 i l r c` ：令矩阵 $A$ 中第 $i$ 行、第 $l$ 到 $r$ 列的所有元素变为 $c(|c|\leq 10^8)$。
- `3 l r` ：记 $B_j = \sum\limits_{i=1}^mA_{i,j}$，即第 $j$ 列所有元素的和。求 $\min\limits_{i=l}^rB_j$。

除此以外，你还要支持对这些操作的可持久化，第 $i$ 次操作在第 $v_i$ 个版本的基础上进行，第 $i$ 
次操作后的矩阵 $A$ 记为第 $i$ 个版本。具体见输入输出格式。

$m \leq 4, n\leq 2.5\times 10^5, q\leq 2\times 10^4$

## 题目分析

先考虑如何做无持久化的版本。

建立一棵线段树，每个节点有一个大小为 $16$ 的数组，表示集合为 $S$ 上的数的和为 $f_S$。

由于需要维护两种操作，因此我们需要开两个 tag，一个维护区间赋值操作，一个维护区间加操作。

下传标记的时候先将区间赋值操作的 tag 加到子节点上去，**清空子节点的区间加 tag**，然后再将区间加的 tag 加到子节点上去。

在区间赋值修改的时候修改了区间赋值操作的 tag 后，**要将当前节点的区间加 tag 给清空**。

然后做可持久化的时候，